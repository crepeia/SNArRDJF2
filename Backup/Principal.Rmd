---
title: "SNA Report"
author: "Leonardo Martins"
date: "13 de julho de 2016"
output: 
  html_document: 
    fig_caption: yes
    keep_md: yes
    toc: yes
---

# Final Report - SNA

## 1. Calling Packages
```{r packages, message=TRUE, warning=TRUE}
setwd('~/SNArRDJF/Banco Redes R')
suppressMessages(require(XLConnect)) #packcage to extract xls mutiple sheets
suppressMessages(require(readxl)) #packcage to read xls files
suppressMessages(require(psych)) #return some descriptives stats
suppressMessages(require(igraph)) #load package for social network analysis
suppressMessages(require(networkD3)) #load package for sankey network
suppressMessages(library(rgexf)) #Regular expression to deal with strings
suppressMessages(library(reshape2)) #Used to manipulate matrix into dataframe with diferent shapes
suppressMessages(library(igraph)) # SNA package 
suppressMessages(library(miniCRAN))
suppressMessages(library(magrittr))
suppressMessages(library(keyplayer))
suppressMessages(library(dplyr))
suppressMessages(library(feather))
suppressMessages(library(visNetwork))
suppressMessages(library(knitr))
suppressMessages(library(DT))
suppressMessages(library(stringr))
library(RColorBrewer)
#library(gplots)
#library(sna)
```

##2. Open Excel Data Base
```{r functions, message=FALSE, warning=FALSE, include=FALSE}
# Building read excel allsheets 
read_excel_allsheets <- function(filename) 
{
    sheets <- readxl::excel_sheets(filename)
    x <- lapply(sheets, function(X) readxl::read_excel(filename, sheet = X))
    names(x) <- sheets
    x
}
```

##3. Open each datatable in a different file
```{r, message=FALSE, warning=FALSE, include=FALSE}
setwd('~/SNArRDJF/Base')
#Creating a list with all spreadsheet
mysheets <- read_excel_allsheets("base.xlsx")
```

##4. Creating .csv file for each sheet
```{r pressure, message=FALSE, warning=FALSE, include=FALSE}
setwd('~/SNArRDJF/Banco Redes R/Bancos CSV')
#Creating each .csv file with mysheets names
for (i in names(mysheets)) 
{
    filename = paste(i, ".csv", sep="")
    write.csv2(mysheets[[i]], filename)
}
```

##5. Importing Datasets as R Objects (Basic Functions)
```{r, message=FALSE, warning=FALSE, include=FALSE}
#Importing Dataframe

#Importing Matrix (cleaning invalid cases)
importa_matrix <- function(x)
{
x<-as.matrix(assign(x, read.table(x,sep=";", stringsAsFactors=FALSE, header = T, row.names=2)))[-c(70, 105, 109, 126, 131, 133, 154, 166),-c(1,71, 106, 110, 127, 132, 134, 155, 167)]
}


#Importing Matrix (Auxiliary files)
importa_matrix2 <- function(x)
{
x<-as.matrix(assign(x, read.table(x,sep=";", stringsAsFactors=FALSE, header = T)))[,-c(1)]
}


#Importing Matrix (Importing attributes)
importa_matrix3 <- function(x)
{
x<-as.matrix(assign(x, read.table(x,sep=";", stringsAsFactors=FALSE, header = T, row.names=2)))[-c(70, 105, 109, 126, 131, 133, 154, 166),-c(1)]
}
```

#6. Importing auxiliary data
```{r, message=FALSE, warning=FALSE, include=FALSE}
Casos_Excluidos_Linha_e_Colun.csv<-importa_matrix2("Casos Excluídos - Linha e Colun.csv")
Dicionário_de_dados_choices.csv<-importa_matrix2("Dicionário de dados - choices.csv")
Dicionário_de_dados_survey.csv<-importa_matrix2("Dicionário de dados - survey.csv")
Dicionário_Matrizes.csv<-importa_matrix2("Dicionário Matrizes.csv")
Nó_simplificado_com_GEOCODE.csv<-importa_matrix2("Nó simplificado com GEOCODE.csv")
Nós_Completo.csv<-importa_matrix2("Nós Completo.csv")
Nós_Simplificado.csv<-importa_matrix2("Nós Simplificado.csv")
attributes_dic.csv<-importa_matrix2("Dicionário de dados - atributos.csv")
```

#7. Importing Squared Matrix
```{r, message=FALSE, warning=FALSE, include=FALSE}

#B1 Tipo de Relacionamento	B1.1 No último ano com quais TIPOS de serviço o SEU SERVIÇO teve alguma relação/ativade em conjunto referente à atenção aos USUÁRIOS DE DROGAS
Matriz_x2.csv<-importa_matrix("Matriz x2.csv")

#B1 Tipo de Relacionamento	B1.2 – TIPOS DE RELACIONAMENTO - FORMAL. No que se refere à ATENÇÃO aos USUÁRIOS DE DROGAS, você caracteriza como FORMAL o relacionamento que o seu serviço possui com os #serviços a seguir ? Parceria Formal - Feita através de paceria/fluxo institucional devadmente reconheca, por meio de convênios, contratos, ou acordo entre gesotres/secretarias etc.
Matriz_0.csv<-importa_matrix("Matriz 0.csv")

#B2- ATIVADES EM CONJUNTO	B2.1 – TIPOS DE RELACIONAMENTO - REFERENCIA DE ENVIO  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE ENVIO OU ENCAMINHAMENTO DE USUÁRIO DE DROGAS COM OS SERVIÇOS A SEGUIR: #REFERENCIA DE ENVIO - Usuários de Drogas encaminhados a outros serviços da rede
Matriz_1.csv<-importa_matrix("Matriz 1.csv")

#B2- ATIVADES EM CONJUNTO	B2.2 – TIPOS DE RELACIONAMENTO - REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE RECEBIMENTO OU CONTRAREFERENCIA DE USUÁRIO DE #DROGAS COM: REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA  - USUÁRIOS DE DROGAS RECEBOS OU CONTRAREFERENCIADOS DE OUTROS SERVIÇOS DA REDE
Matriz_2.csv<-importa_matrix("Matriz 2.csv")

#B2- ATIVADES EM CONJUNTO	B2.3 – TIPOS DE RELACIONAMENTO  - COORDENAÇÃO CONJUNTA DE CASOS  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE COORDENAÇÃO CONJUNTA DE CASOS REFERENTE AO USO DE DROGAS COM: COORDENAÇÃO #CONJUNTA DE CASOS - COMPARTILHAMENTO DE DADOS E CONDUTAS A RESPEITO DE UM CASO ESPECÍFICO RELACIONADO AO USO DE DROGAS, RESPONSABILADE COMPARTILHADA DE CASOS, TRATAMENTO DE USUÁRIOS DE DROGAS EM CONJUNTO #COM OUTROS SERVIÇOS
Matriz_3.csv<-importa_matrix("Matriz 3.csv")

#B2- ATIVADES EM CONJUNTO	B2.4 – TIPOS DE RELACIONAMENTO - PROGRAMAS EM CONJUNTO - O SEU SERVIÇO MANTÉM ALGUM TIPO DE PROGRAMA EM CONJUNTO REFERENTE AO USO DE DROGAS COM: PROGRAMAS EM CONJUNTO  - #PROGRAMAS E PROJETOS REFERENTES AO USO DE DROGAS DESENVOLVOS EM CONJUNTO COM OUTROS SERVIÇOS
Matriz_4.csv<-importa_matrix("Matriz 4.csv")

#B2- ATIVADES EM CONJUNTO	B2.5 – TIPOS DE RELACIONAMENTO  - OFERTA DE TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ TREINOU OU CAPACITOU ALGUM DOS SERVIÇOS A SEGUIR:  OFERTA #DE TREINAMENTOS/CAPACITAÇÕES  - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE RELACIONADOS AO USO DE DROGAS OFERECOS PARA OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL
Matriz_5.csv<-importa_matrix("Matriz 5.csv")

#B2- ATIVADES EM CONJUNTO	B2.6 – TIPOS DE RELACIONAMENTO  - RECEBER TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ FOI TREINADO OU CAPACITADO POR ALGUM DOS SERVIÇOS A SEGUIR: #RECEBER TREINAMENTOS/CAPACITAÇÕES - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE REFERENTES AO USO DE DROGAS RECEBOS DE OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL 
Matriz_6.csv<-importa_matrix("Matriz 6.csv")

#ACESSO	A) Este serviço mostra-se disponível para realização de ativades em conjunto.
Matriz_7.csv<-importa_matrix("Matriz 7.csv")

#ACESSO	B) O horário de funcionamento deste serviço possibilita a realização de ações em conjunto.
Matriz_8.csv<-importa_matrix("Matriz 8.csv")

#ACESSO	C) Este serviço disponibiliza informações sobre suas ativades para o seu serviço.
Matriz_9.csv<-importa_matrix("Matriz 9.csv")

#ACESSO	D) O seu serviço consegue acessar facilmente informações deste serviço.
Matriz_10.csv<-importa_matrix("Matriz 10.csv")

#ACESSO	E) Os canais de comunicação com este serviço são suficientes para realização de ações em conjunto.
Matriz_11.csv<-importa_matrix("Matriz 11.csv")

#ACESSO	F) Seu serviço tem facilade de entrar em contato com este serviço para realizar ativades em conjunto.
Matriz_12.csv<-importa_matrix("Matriz 12.csv")

#ACESSO	G) O acesso geográfico a este serviço impede a realização de ativades em conjunto.
Matriz_13.csv<-importa_matrix("Matriz 13.csv")

#ACESSO	H) O custo para acessar este serviço impede a realização de ativades em conjunto.
Matriz_14.csv<-importa_matrix("Matriz 14.csv")

#ACESSO	I) O tempo gasto para acessar este serviço impede a realização ativades em conjunto.
Matriz_15.csv<-importa_matrix("Matriz 15.csv")

#CONFIANÇA A) Seu serviço confia  na qualificação profissional da equipe deste serviço 
Matriz_16.csv<-importa_matrix("Matriz 16.csv")

#CONFIANÇA	B) Seu serviço confia  na capacade técnica da equipe deste serviço.
Matriz_17.csv<-importa_matrix("Matriz 17.csv")

#CONFIANÇA C) Seu serviço confia  nas ações realizadas por este serviço.
Matriz_18.csv<-importa_matrix("Matriz 18.csv")

#CONFIANÇA	D) Seu serviço confia  em compartilhar informações internas com este serviço. 
Matriz_19.csv<-importa_matrix("Matriz 19.csv")

#CONFIANÇA	E) Seu serviço confia nas informações recebas deste serviço.
Matriz_20.csv<-importa_matrix("Matriz 20.csv")

#CONFIANÇA	F) Seu serviço confia  em realizar ações conjuntas com este serviço.
Matriz_21.csv<-importa_matrix("Matriz 21.csv")

#CONFIANÇA	G) Seu serviço está satisfeito  com as ações desempenhadas por este serviço.
Matriz_22.csv<-importa_matrix("Matriz 22.csv")

#CONFIANÇA	H) Seu serviço espera que o relacionamento com este serviço continue nos próximos anos.
Matriz_23.csv<-importa_matrix("Matriz 23.csv")

#CONFIANÇA	I) Seu serviço espera que o relacionamento com este 
Matriz_24.csv<-importa_matrix("Matriz 24.csv")

#SOMATÓRIO ATIVIDADE
atividade= as.matrix(`Matriz_1.csv` + `Matriz_2.csv` + `Matriz_3.csv` + `Matriz_4.csv`+ `Matriz_5.csv`+ `Matriz_6.csv`)

#SOMATÓRIO ACESSO
acesso= as.matrix(`Matriz_7.csv` + `Matriz_8.csv` + `Matriz_9.csv` + `Matriz_10.csv`+ `Matriz_11.csv`+ `Matriz_12.csv` + `Matriz_13.csv` + `Matriz_14.csv` + `Matriz_15.csv` + `Matriz_16.csv`)

#SOMATÓRIO CONFIANÇA
confianca=as.matrix(`Matriz_17.csv` + `Matriz_18.csv` + `Matriz_19.csv` + `Matriz_20.csv` + `Matriz_21.csv` + `Matriz_22.csv` + `Matriz_23.csv` + `Matriz_24.csv`)

#SOMATÓRIO TOTAL
total= as.matrix(atividade + acesso + confianca)
```

#8. Importing Attributes for vertices
```{r, message=FALSE, warning=FALSE, include=FALSE}
attributes.csv<-as.data.frame(importa_matrix3("Atributos.csv"))
attributes.csv$V3_LABEL_ID2=as.character(attributes.csv$V3_LABEL_ID2)
attributes.csv$V3_LABEL_ID2=as.numeric(attributes.csv$V3_LABEL_ID2)
```

#9. Genenating Igraph Objects
```{r, message=FALSE, warning=TRUE, include=FALSE}
gMatriz_x2.csv<-graph_from_adjacency_matrix(Matriz_x2.csv, mode="directed",weighted=T,diag=F)
gMatriz_0.csv<-graph_from_adjacency_matrix(Matriz_0.csv, mode="directed",weighted=T,diag=F)
gMatriz_1.csv<-graph_from_adjacency_matrix(Matriz_1.csv, mode="directed",weighted=T,diag=F)
gMatriz_2.csv<-graph_from_adjacency_matrix(Matriz_2.csv, mode="directed",weighted=T,diag=F)
gMatriz_3.csv<-graph_from_adjacency_matrix(Matriz_3.csv, mode="directed",weighted=T,diag=F)
gMatriz_4.csv<-graph_from_adjacency_matrix(Matriz_4.csv, mode="directed",weighted=T,diag=F)
gMatriz_5.csv<-graph_from_adjacency_matrix(Matriz_5.csv, mode="directed",weighted=T,diag=F)
gMatriz_6.csv<-graph_from_adjacency_matrix(Matriz_6.csv, mode="directed",weighted=T,diag=F)
gMatriz_7.csv<-graph_from_adjacency_matrix(Matriz_7.csv, mode="directed",weighted=T,diag=F)
gMatriz_8.csv<-graph_from_adjacency_matrix(Matriz_8.csv, mode="directed",weighted=T,diag=F)
gMatriz_9.csv<-graph_from_adjacency_matrix(Matriz_9.csv, mode="directed",weighted=T,diag=F)
gMatriz_10.csv<-graph_from_adjacency_matrix(Matriz_10.csv, mode="directed",weighted=T,diag=F)
gMatriz_11.csv<-graph_from_adjacency_matrix(Matriz_11.csv, mode="directed",weighted=T,diag=F)
gMatriz_12.csv<-graph_from_adjacency_matrix(Matriz_12.csv, mode="directed",weighted=T,diag=F)
gMatriz_13.csv<-graph_from_adjacency_matrix(Matriz_13.csv, mode="directed",weighted=T,diag=F)
gMatriz_14.csv<-graph_from_adjacency_matrix(Matriz_14.csv, mode="directed",weighted=T,diag=F)
gMatriz_15.csv<-graph_from_adjacency_matrix(Matriz_15.csv, mode="directed",weighted=T,diag=F)
gMatriz_16.csv<-graph_from_adjacency_matrix(Matriz_16.csv, mode="directed",weighted=T,diag=F)
gMatriz_17.csv<-graph_from_adjacency_matrix(Matriz_17.csv, mode="directed",weighted=T,diag=F)
gMatriz_18.csv<-graph_from_adjacency_matrix(Matriz_18.csv, mode="directed",weighted=T,diag=F)
gMatriz_19.csv<-graph_from_adjacency_matrix(Matriz_19.csv, mode="directed",weighted=T,diag=F)
gMatriz_20.csv<-graph_from_adjacency_matrix(Matriz_20.csv, mode="directed",weighted=T,diag=F)
gMatriz_21.csv<-graph_from_adjacency_matrix(Matriz_21.csv, mode="directed",weighted=T,diag=F)
gMatriz_22.csv<-graph_from_adjacency_matrix(Matriz_22.csv, mode="directed",weighted=T,diag=F)
gMatriz_23.csv<-graph_from_adjacency_matrix(Matriz_23.csv, mode="directed",weighted=T,diag=F)
gMatriz_24.csv<-graph_from_adjacency_matrix(Matriz_24.csv, mode="directed",weighted=T,diag=F)
gMatriz_atividade.csv<-graph_from_adjacency_matrix(atividade, mode="directed",weighted=T,diag=F)
gMatriz_acesso.csv<-graph_from_adjacency_matrix(acesso, mode="directed",weighted=T,diag=F)
gMatriz_confianca.csv<-graph_from_adjacency_matrix(confianca, mode="directed",weighted=T,diag=F)
gMatriz_total.csv<-graph_from_adjacency_matrix(total, mode="directed",weighted=T,diag=F)
```

#10. Melting Squared Matrix to List in order to agreggate all lists in one dataframe
```{r, message=FALSE, warning=FALSE, include=FALSE}
gMatriz_x2.txt<-melt(Matriz_x2.csv)
gMatriz_0.txt<-melt(Matriz_0.csv)
gMatriz_1.txt<-melt(Matriz_1.csv)
gMatriz_2.txt<-melt(Matriz_2.csv)
gMatriz_3.txt<-melt(Matriz_3.csv)
gMatriz_4.txt<-melt(Matriz_4.csv)
gMatriz_5.txt<-melt(Matriz_5.csv)
gMatriz_6.txt<-melt(Matriz_6.csv)
gMatriz_7.txt<-melt(Matriz_7.csv)
gMatriz_8.txt<-melt(Matriz_8.csv)
gMatriz_9.txt<-melt(Matriz_9.csv)
gMatriz_10.txt<-melt(Matriz_10.csv)
gMatriz_11.txt<-melt(Matriz_11.csv)
gMatriz_12.txt<-melt(Matriz_12.csv)
gMatriz_13.txt<-melt(Matriz_13.csv)
gMatriz_14.txt<-melt(Matriz_14.csv)
gMatriz_15.txt<-melt(Matriz_15.csv)
gMatriz_16.txt<-melt(Matriz_16.csv)
gMatriz_17.txt<-melt(Matriz_17.csv)
gMatriz_18.txt<-melt(Matriz_18.csv)
gMatriz_19.txt<-melt(Matriz_19.csv)
gMatriz_20.txt<-melt(Matriz_20.csv)
gMatriz_21.txt<-melt(Matriz_21.csv)
gMatriz_22.txt<-melt(Matriz_22.csv)
gMatriz_23.txt<-melt(Matriz_23.csv)
gMatriz_24.txt<-melt(Matriz_24.csv)
gMatriz_atividade.txt<-melt(atividade)
gMatriz_acesso.txt<-melt(acesso)
gMatriz_confianca.txt<-melt(confianca)
gMatriz_total.txt<-melt(total)
```

#11. Adding colnames
```{r, message=FALSE, warning=FALSE, include=FALSE}
colnames(gMatriz_x2.txt)<-c('from','to','x2')
colnames(gMatriz_0.txt)<-c('from','to','var0')
colnames(gMatriz_1.txt)<-c('from','to','var1')
colnames(gMatriz_2.txt)<-c('from','to','var2')
colnames(gMatriz_3.txt)<-c('from','to','var3')
colnames(gMatriz_4.txt)<-c('from','to','var4')
colnames(gMatriz_5.txt)<-c('from','to','var5')
colnames(gMatriz_6.txt)<-c('from','to','var6')
colnames(gMatriz_7.txt)<-c('from','to','var7')
colnames(gMatriz_8.txt)<-c('from','to','var8')
colnames(gMatriz_9.txt)<-c('from','to','var9')
colnames(gMatriz_10.txt)<-c('from','to','var10')
colnames(gMatriz_11.txt)<-c('from','to','var11')
colnames(gMatriz_12.txt)<-c('from','to','var12')
colnames(gMatriz_13.txt)<-c('from','to','var13')
colnames(gMatriz_14.txt)<-c('from','to','var14')
colnames(gMatriz_15.txt)<-c('from','to','var15')
colnames(gMatriz_16.txt)<-c('from','to','var16')
colnames(gMatriz_17.txt)<-c('from','to','var17')
colnames(gMatriz_18.txt)<-c('from','to','var18')
colnames(gMatriz_19.txt)<-c('from','to','var19')
colnames(gMatriz_20.txt)<-c('from','to','var20')
colnames(gMatriz_21.txt)<-c('from','to','var21')
colnames(gMatriz_22.txt)<-c('from','to','var22')
colnames(gMatriz_23.txt)<-c('from','to','var23')
colnames(gMatriz_24.txt)<-c('from','to','var24')
colnames(gMatriz_atividade.txt)<-c('from','to','atividade')
colnames(gMatriz_acesso.txt)<-c('from','to','acesso')
colnames(gMatriz_confianca.txt)<-c('from','to','confianca')
colnames(gMatriz_total.txt)<-c('from','to','total')
```

#12. All matrixes in one dataframe
```{r, message=FALSE, warning=FALSE, include=FALSE}       
full_data_frame <- cbind(gMatriz_0.txt,
gMatriz_1.txt$var1,
gMatriz_2.txt$var2,
gMatriz_3.txt$var3,
gMatriz_4.txt$var4,
gMatriz_5.txt$var5,
gMatriz_6.txt$var6,
gMatriz_7.txt$var7,
gMatriz_8.txt$var8,
gMatriz_9.txt$var9,
gMatriz_10.txt$var10,
gMatriz_11.txt$var11,
gMatriz_12.txt$var12,
gMatriz_13.txt$var13,
gMatriz_14.txt$var14,
gMatriz_15.txt$var15,
gMatriz_16.txt$var16,
gMatriz_17.txt$var17,
gMatriz_18.txt$var18,
gMatriz_19.txt$var19,
gMatriz_20.txt$var20,
gMatriz_21.txt$var21,
gMatriz_22.txt$var22,
gMatriz_23.txt$var23,
gMatriz_24.txt$var24,
gMatriz_atividade.txt$atividade,
gMatriz_acesso.txt$acesso,
gMatriz_confianca.txt$confianca,
gMatriz_total.txt$total)
head(full_data_frame)
```

#13. Renaming 
```{r, message=FALSE, warning=FALSE, include=FALSE}
names(full_data_frame)[4:31] <- c(
"var1",
"var2",
"var3",
"var4",
"var5",
"var6",
"var7",
"var8",
"var9",
"var10",
"var11",
"var12",
"var13",
"var14",
"var15",
"var16",
"var17",
"var18",
"var19",
"var20",
"var21",
"var22",
"var23",
"var24",
"atividade",
"acesso",
"confianca",
"total")
names(full_data_frame)
```

#14. Changing ID structure using regular expression
```{r, message=FALSE, warning=FALSE, include=FALSE}
#Keeping the full data frame non violated
full_data_frame_id=full_data_frame

#from_q
full_data_frame_id$from=str_extract_all(full_data_frame_id$from, pattern = "[q][0-9]{1,3}", "")
full_data_frame_id$from=str_extract_all(full_data_frame_id$from, pattern = "[0-9]{1,3}", "")
#to_q
full_data_frame_id$to=str_extract_all(full_data_frame_id$to, pattern = "[q][0-9]{1,3}", "")
full_data_frame_id$to=str_extract_all(full_data_frame_id$to, pattern = "[0-9]{1,3}", "")

head(full_data_frame_id)

#Changing ID to number on Excel (ps:I need to improve this code using R)
#full_data_frame_id=read.table("~/Banco Redes R/Bancos CSV/full_data_frame_id.csv", sep=";", #stringsAsFactors=FALSE, header = T)

#Changing types for futher matching
full_data_frame_id$from<-as.character(full_data_frame_id$from)
full_data_frame_id$from<-as.numeric(full_data_frame_id$from)
full_data_frame_id$to<-as.character(full_data_frame_id$to)
full_data_frame_id$to<-as.numeric(full_data_frame_id$to)



#Checking crazing diags different from zero
full_data_frame_id$var0[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var1[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var2[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var3[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var4[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var5[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var6[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var7[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var8[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var9[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var10[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var11[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var12[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var13[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var14[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var15[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var16[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var17[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var18[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var19[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var20[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var21[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var22[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var23[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var24[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$atividade[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$acesso[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$confianca[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$total[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0

#Writing CSV code without diags
write.csv2(full_data_frame_id, "~/SNArRDJF/Banco Redes R/Bancos CSV/full_data_frame_id.csv", fileEncoding = "macintosh")

#Full igrpah object with looping and non zero edges
full_with_zero <- graph_from_data_frame(full_data_frame_id, directed=T) 
V(full_with_zero)$name<-as.character(V(full_with_zero)$name)
V(full_with_zero)$name<-as.numeric(V(full_with_zero)$name)
#full_with_zero<-full_with_zero[order(V(full_with_zero)$name),]
summary(full_with_zero)
```

#15. Adding attributes to each node (full_with_zero) - ***We need to update this code with "for" and after Pedro's updates regarding KML mercartor coordinates***
```{r, message=FALSE, warning=FALSE, include=FALSE}
# Adding attributes to each node (full_with_zero) - Update this code with "for" and after Pedro's updates regarding KML mercartor coordinates 

V(full_with_zero)$ID=as.character(attributes.csv$ID[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$TIPO1=as.character(attributes.csv$TIPO1[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$TIPO2=as.character(attributes.csv$TIPO2[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$LABEL_COR=as.character(attributes.csv$LABEL_COR[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V1_LABEL_TIPO=as.character(attributes.csv$V1_LABEL_TIPO[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V2_LABEL_ID=as.character(attributes.csv$V2_LABEL_ID[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V3_LABEL_ID2=as.character(attributes.csv$V3_LABEL_ID2[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V4_LABEL_ID3=as.character(attributes.csv$V4_LABEL_ID3[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V5_LABEL_LABEL=as.character(attributes.csv$V5_LABEL_LABEL[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação=as.character(attributes.csv$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V7_COMUNICACAO_Telefeno.Fixo=as.character(attributes.csv$V7_COMUNICACAO_Telefeno.Fixo[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V8_COMUNICACAO_Celular.Chamada.de.Voz=as.character(attributes.csv$V8_COMUNICACAO_Celular.Chamada.de.Voz[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V9_COMUNICACAO_Celular.Mensagem.de.Texto=as.character(attributes.csv$V9_COMUNICACAO_Celular.Mensagem.de.Texto[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V10_COMUNICACAO_E.mail=as.character(attributes.csv$V10_COMUNICACAO_E.mail[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V11_COMUNICACAO_Skype.Menssager=as.character(attributes.csv$V11_COMUNICACAO_Skype.Menssager[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V12_COMUNICACAO_Converso.Pessalmente=as.character(attributes.csv$V12_COMUNICACAO_Converso.Pessalmente[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.=as.character(attributes.csv$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V14_COMUNICACAO_Outro=as.character(attributes.csv$V14_COMUNICACAO_Outro[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS=as.character(attributes.csv$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V16_TEMPO_FUNC_Data_Abertura=as.character(attributes.csv$V16_TEMPO_FUNC_Data_Abertura[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V17_TEMPO_FUNC_Data_Pesquisa=as.character(attributes.csv$V17_TEMPO_FUNC_Data_Pesquisa[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V18_TEMPO_FUNC_Idade_Serviço_Dias=as.character(attributes.csv$V18_TEMPO_FUNC_Idade_Serviço_Dias[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V19_TEMPO_FUNC_Idade_em_anos=as.character(attributes.csv$V19_TEMPO_FUNC_Idade_em_anos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V20_FUNCIONAMENTO_Segunda=as.character(attributes.csv$V20_FUNCIONAMENTO_Segunda[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V21_FUNCIONAMENTO_Terça=as.character(attributes.csv$V21_FUNCIONAMENTO_Terça[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V22_FUNCIONAMENTO_Quarta=as.character(attributes.csv$V22_FUNCIONAMENTO_Quarta[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V23_FUNCIONAMENTO_Quinta=as.character(attributes.csv$V23_FUNCIONAMENTO_Quinta[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V24_FUNCIONAMENTO_Sexta=as.character(attributes.csv$V24_FUNCIONAMENTO_Sexta[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V25_FUNCIONAMENTO_Sábado=as.character(attributes.csv$V25_FUNCIONAMENTO_Sábado[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V26_FUNCIONAMENTO_Domingo=as.character(attributes.csv$V26_FUNCIONAMENTO_Domingo[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V27_FUNCIONAMENTO_Feriados=as.character(attributes.csv$V27_FUNCIONAMENTO_Feriados[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V28_FUNCIONAMENTO_Segunda....Manhã=as.character(attributes.csv$V28_FUNCIONAMENTO_Segunda....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V29_FUNCIONAMENTO_Segunda....Tarde=as.character(attributes.csv$V29_FUNCIONAMENTO_Segunda....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V30_FUNCIONAMENTO_Segunda....Noite=as.character(attributes.csv$V30_FUNCIONAMENTO_Segunda....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V31_FUNCIONAMENTO_Segunda....Plantão.24h=as.character(attributes.csv$V31_FUNCIONAMENTO_Segunda....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V32_FUNCIONAMENTO_Terça....Manhã=as.character(attributes.csv$V32_FUNCIONAMENTO_Terça....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V33_FUNCIONAMENTO_Terça....Tarde=as.character(attributes.csv$V33_FUNCIONAMENTO_Terça....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V34_FUNCIONAMENTO_Terça....Noite=as.character(attributes.csv$V34_FUNCIONAMENTO_Terça....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V35_FUNCIONAMENTO_Terça....Plantão.24h=as.character(attributes.csv$V35_FUNCIONAMENTO_Terça....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V36_FUNCIONAMENTO_Quarta....Manhã=as.character(attributes.csv$V36_FUNCIONAMENTO_Quarta....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V37_FUNCIONAMENTO_Quarta....Tarde=as.character(attributes.csv$V37_FUNCIONAMENTO_Quarta....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V38_FUNCIONAMENTO_Quarta....Noite=as.character(attributes.csv$V38_FUNCIONAMENTO_Quarta....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V39_FUNCIONAMENTO_Quarta....Plantão.24h=as.character(attributes.csv$V39_FUNCIONAMENTO_Quarta....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V40_FUNCIONAMENTO_Quinta....Manhã=as.character(attributes.csv$V40_FUNCIONAMENTO_Quinta....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V41_FUNCIONAMENTO_Quinta....Tarde=as.character(attributes.csv$V41_FUNCIONAMENTO_Quinta....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V42_FUNCIONAMENTO_Quinta....Noite=as.character(attributes.csv$V42_FUNCIONAMENTO_Quinta....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V43_FUNCIONAMENTO_Quinta....Plantão.24h=as.character(attributes.csv$V43_FUNCIONAMENTO_Quinta....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V44_FUNCIONAMENTO_Sexta....Manhã=as.character(attributes.csv$V44_FUNCIONAMENTO_Sexta....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V45_FUNCIONAMENTO_Sexta....Tarde=as.character(attributes.csv$V45_FUNCIONAMENTO_Sexta....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V46_FUNCIONAMENTO_Sexta....Noite=as.character(attributes.csv$V46_FUNCIONAMENTO_Sexta....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V47_FUNCIONAMENTO_Sexta....Plantão.24h=as.character(attributes.csv$V47_FUNCIONAMENTO_Sexta....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V48_FUNCIONAMENTO_Sábado....Manhã=as.character(attributes.csv$V48_FUNCIONAMENTO_Sábado....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V49_FUNCIONAMENTO_Sábado....Tarde=as.character(attributes.csv$V49_FUNCIONAMENTO_Sábado....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V50_FUNCIONAMENTO_Sábado....Noite=as.character(attributes.csv$V50_FUNCIONAMENTO_Sábado....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V51_FUNCIONAMENTO_Sábado....Plantão.24h=as.character(attributes.csv$V51_FUNCIONAMENTO_Sábado....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V52_FUNCIONAMENTO_Domingo....Manhã=as.character(attributes.csv$V52_FUNCIONAMENTO_Domingo....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V53_FUNCIONAMENTO_Domingo....Tarde=as.character(attributes.csv$V53_FUNCIONAMENTO_Domingo....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V54_FUNCIONAMENTO_Domingo....Noite=as.character(attributes.csv$V54_FUNCIONAMENTO_Domingo....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V55_FUNCIONAMENTO_Domingo....Plantão.24h=as.character(attributes.csv$V55_FUNCIONAMENTO_Domingo....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V56_FUNCIONAMENTO_Feriado....Manhã=as.character(attributes.csv$V56_FUNCIONAMENTO_Feriado....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V57_FUNCIONAMENTO_Feriado....Tarde=as.character(attributes.csv$V57_FUNCIONAMENTO_Feriado....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V58_FUNCIONAMENTO_Feriado....Noite=as.character(attributes.csv$V58_FUNCIONAMENTO_Feriado....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V59_FUNCIONAMENTO_Feriado....Plantão.24h=as.character(attributes.csv$V59_FUNCIONAMENTO_Feriado....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V61_PROFISSIONAIS_Assistentes.Sociais=as.character(attributes.csv$V61_PROFISSIONAIS_Assistentes.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem=as.character(attributes.csv$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V63_PROFISSIONAIS_Enfermeiros=as.character(attributes.csv$V63_PROFISSIONAIS_Enfermeiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V65_PROFISSIONAIS_Médicos=as.character(attributes.csv$V65_PROFISSIONAIS_Médicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V66_PROFISSIONAIS_Psicólogos=as.character(attributes.csv$V66_PROFISSIONAIS_Psicólogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V67_PROFISSIONAIS_Fisioterapeutas=as.character(attributes.csv$V67_PROFISSIONAIS_Fisioterapeutas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V68_PROFISSIONAIS_Terapeutas.Ocupacionais=as.character(attributes.csv$V68_PROFISSIONAIS_Terapeutas.Ocupacionais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V69_PROFISSIONAIS_Dentistas=as.character(attributes.csv$V69_PROFISSIONAIS_Dentistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V70_PROFISSIONAIS_Farmacêuticos=as.character(attributes.csv$V70_PROFISSIONAIS_Farmacêuticos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V71_PROFISSIONAIS_Administradores=as.character(attributes.csv$V71_PROFISSIONAIS_Administradores[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V73_PROFISSIONAIS_Educadores.Físicos=as.character(attributes.csv$V73_PROFISSIONAIS_Educadores.Físicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado=as.character(attributes.csv$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V76_PROFISSIONAIS_Educadores.Sociais=as.character(attributes.csv$V76_PROFISSIONAIS_Educadores.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V77_PROFISSIONAIS_Pedagogos=as.character(attributes.csv$V77_PROFISSIONAIS_Pedagogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V78_PROFISSIONAIS_Auxiliares.administrativos=as.character(attributes.csv$V78_PROFISSIONAIS_Auxiliares.administrativos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V79_PROFISSIONAIS_Recepcionistas=as.character(attributes.csv$V79_PROFISSIONAIS_Recepcionistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V80_PROFISSIONAIS_Serviços.gerais=as.character(attributes.csv$V80_PROFISSIONAIS_Serviços.gerais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V81_PROFISSIONAIS_Cozinheiros=as.character(attributes.csv$V81_PROFISSIONAIS_Cozinheiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V82_PROFISSIONAIS_Motoristas=as.character(attributes.csv$V82_PROFISSIONAIS_Motoristas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V83_PROFISSIONAIS_Porteiros=as.character(attributes.csv$V83_PROFISSIONAIS_Porteiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V84_PROFISSIONAIS_Outros=as.character(attributes.csv$V84_PROFISSIONAIS_Outros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V85_PROFISSIONAIS_TOTAL_Profissionais=as.character(attributes.csv$V85_PROFISSIONAIS_TOTAL_Profissionais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V87_PROFISSIONAIS_X2...Assistentes.Sociais=as.character(attributes.csv$V87_PROFISSIONAIS_X2...Assistentes.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem=as.character(attributes.csv$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V89_PROFISSIONAIS_X4...Enfermeiros=as.character(attributes.csv$V89_PROFISSIONAIS_X4...Enfermeiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V91_PROFISSIONAIS_X6...Médicos=as.character(attributes.csv$V91_PROFISSIONAIS_X6...Médicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V92_PROFISSIONAIS_X7...Psicólogos=as.character(attributes.csv$V92_PROFISSIONAIS_X7...Psicólogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V93_PROFISSIONAIS_X8...Fisioterapeutas=as.character(attributes.csv$V93_PROFISSIONAIS_X8...Fisioterapeutas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais=as.character(attributes.csv$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V95_PROFISSIONAIS_X10...Dentistas=as.character(attributes.csv$V95_PROFISSIONAIS_X10...Dentistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V96_PROFISSIONAIS_X11...Farmacêuticos=as.character(attributes.csv$V96_PROFISSIONAIS_X11...Farmacêuticos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V97_PROFISSIONAIS_X12...Administradores=as.character(attributes.csv$V97_PROFISSIONAIS_X12...Administradores[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V99_PROFISSIONAIS_X14...Educadores.Físicos=as.character(attributes.csv$V99_PROFISSIONAIS_X14...Educadores.Físicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado=as.character(attributes.csv$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V102_PROFISSIONAIS_X17...Educadores.Sociais=as.character(attributes.csv$V102_PROFISSIONAIS_X17...Educadores.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V103_PROFISSIONAIS_X18...Pedagogos=as.character(attributes.csv$V103_PROFISSIONAIS_X18...Pedagogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V104_PROFISSIONAIS_X19...Auxiliares.administrativos=as.character(attributes.csv$V104_PROFISSIONAIS_X19...Auxiliares.administrativos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V105_PROFISSIONAIS_X20...Recepcionistas=as.character(attributes.csv$V105_PROFISSIONAIS_X20...Recepcionistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V106_PROFISSIONAIS_X21...Serviços.gerais=as.character(attributes.csv$V106_PROFISSIONAIS_X21...Serviços.gerais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V107_PROFISSIONAIS_X22...Cozinheiros=as.character(attributes.csv$V107_PROFISSIONAIS_X22...Cozinheiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V108_PROFISSIONAIS_X23...Motoristas=as.character(attributes.csv$V108_PROFISSIONAIS_X23...Motoristas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V109_PROFISSIONAIS_X24...Porteiros=as.character(attributes.csv$V109_PROFISSIONAIS_X24...Porteiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V110_PACIENTES_Média.atende.dia.típico.=as.character(attributes.csv$V110_PACIENTES_Média.atende.dia.típico.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V111_PACIENTES_Média.capacidade.de.atender.=as.character(attributes.csv$V111_PACIENTES_Média.capacidade.de.atender.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..=as.character(attributes.csv$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..=as.character(attributes.csv$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V114_RELACOES_UAPS.RURAL=as.character(attributes.csv$V114_RELACOES_UAPS.RURAL[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V115_RELACOES_UAPS.URBANA=as.character(attributes.csv$V115_RELACOES_UAPS.URBANA[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V116_RELACOES_Ajuda.Mútua=as.character(attributes.csv$V116_RELACOES_Ajuda.Mútua[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT=as.character(attributes.csv$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V118_RELACOES_Residência.Terapeutica=as.character(attributes.csv$V118_RELACOES_Residência.Terapeutica[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V119_RELACOES_Entidades.Socioassistenciais=as.character(attributes.csv$V119_RELACOES_Entidades.Socioassistenciais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V120_RELACOES_Assistência.Hospitalar=as.character(attributes.csv$V120_RELACOES_Assistência.Hospitalar[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V121_RELACOES_CAPS=as.character(attributes.csv$V121_RELACOES_CAPS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V122_RELACOES_CRAS=as.character(attributes.csv$V122_RELACOES_CRAS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V123_RELACOES_CREAS=as.character(attributes.csv$V123_RELACOES_CREAS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V124_RELACOES_Acolhimento.Institucional=as.character(attributes.csv$V124_RELACOES_Acolhimento.Institucional[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V125_RELACOES_Urgência.Emergência=as.character(attributes.csv$V125_RELACOES_Urgência.Emergência[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V126_RELACOES_Ambulatório.de.Saúde.Mental=as.character(attributes.csv$V126_RELACOES_Ambulatório.de.Saúde.Mental[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V127_RELACOES_Centro.de.Convivência=as.character(attributes.csv$V127_RELACOES_Centro.de.Convivência[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V128_RELACOES_Consultório.na.Rua=as.character(attributes.csv$V128_RELACOES_Consultório.na.Rua[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO=as.character(attributes.csv$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS=as.character(attributes.csv$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V131_GEO_kml_latitude=as.character(attributes.csv$V131_GEO_kml_latitude[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V132_GEO_kml_longitude=as.character(attributes.csv$V132_GEO_kml_longitude[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])
```

#16. Adding pallettes colors to each node based on type of facilitie - *** We need either check the recode strategy***
```{r, message=FALSE, warning=FALSE, include=FALSE}
vertex_col <- brewer.pal(length(unique(V(full_with_zero)$LABEL_COR)), "Set3")
V(full_with_zero)$color <- vertex_col[factor(V(full_with_zero)$LABEL_COR)]
```

#17. Basic Proof - Are ID's and Names sorted right ? 
```{r, message=FALSE, warning=FALSE, include=FALSE}
#The most important test full_with_zero
a=get.vertex.attribute(full_with_zero, 'V2_LABEL_ID')
b=attributes.csv$V3_LABEL_ID2
c=cbind(a,b)
head(c)

#The most important test full_with_zero
d=get.vertex.attribute(full_with_zero, 'V2_LABEL_ID')
b=attributes.csv$V3_LABEL_ID2
e=cbind(d,b)
head(e)
```

#18. Creating non zero dataframe (excluding ties with weight > 0)
```{r, message=FALSE, warning=FALSE, include=FALSE}
full_nonzero_edges <- subset(full_data_frame_id, (var0 > 0 |
var1 > 0 |
var2 > 0 |
var3 > 0 |
var4 > 0 |
var5 > 0 |
var6 > 0 |
var7 > 0 |
var8 > 0 |
var9 > 0 |
var10 > 0 |
var11 > 0 |
var12 > 0 |
var13 > 0 |
var14 > 0 |
var15 > 0 |
var16> 0 |
var17 > 0 |
var18 > 0 |
var19 > 0 |
var20 > 0 |
var21 > 0 |
var22 > 0 |
var23 > 0 |
var24 > 0 |
atividade > 0 |
acesso > 0 |
confianca > 0 |
total > 0))
head(full_nonzero_edges)

#Write DataFrame in order to use with pajek (just in case)
write.csv2(full_nonzero_edges, "~/Banco Redes R/full_nonzero_edges.csv", fileEncoding = "macintosh")

#To be sure - from and to (id's) as numeric
full_nonzero_edges$from<-as.numeric(full_nonzero_edges$from)
full_nonzero_edges$to<-as.numeric(full_nonzero_edges$to)

#Sorting by from - considering previous problems with matching 
#full_nonzero_edges=full_nonzero_edges[order(full_nonzero_edges$from),]
head(full_nonzero_edges)

#Full igraph object without looping or zero edges
full_no_zero <- graph_from_data_frame(full_nonzero_edges, directed=T) 
V(full_no_zero)$name<-as.character(V(full_no_zero)$name)
V(full_no_zero)$name<-as.numeric(V(full_no_zero)$name)
summary(full_no_zero)

#Sorting in order to prevent disasters 
#V(full_no_zero)$name=sort(as.numeric(V(full_no_zero)$name))
V(full_no_zero)$name
```

#19.The coolest part - adding attributes to each node (full_no_zero) - Update this code with "for" and after Pedro's updates regarding KML mercartor coordinates - 
```{r, message=FALSE, warning=FALSE, include=FALSE}
# The coolest part - adding attributes to each node (full_no_zero) - Update this code with "for" and after Pedro's updates regarding KML mercartor coordinates 

V(full_no_zero)$ID=as.character(attributes.csv$ID[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$TIPO1=as.character(attributes.csv$TIPO1[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$TIPO2=as.character(attributes.csv$TIPO2[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$LABEL_COR=as.character(attributes.csv$LABEL_COR[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V1_LABEL_TIPO=as.character(attributes.csv$V1_LABEL_TIPO[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V2_LABEL_ID=as.character(attributes.csv$V2_LABEL_ID[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V3_LABEL_ID2=as.character(attributes.csv$V3_LABEL_ID2[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V4_LABEL_ID3=as.character(attributes.csv$V4_LABEL_ID3[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V5_LABEL_LABEL=as.character(attributes.csv$V5_LABEL_LABEL[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação=as.character(attributes.csv$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V7_COMUNICACAO_Telefeno.Fixo=as.character(attributes.csv$V7_COMUNICACAO_Telefeno.Fixo[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V8_COMUNICACAO_Celular.Chamada.de.Voz=as.character(attributes.csv$V8_COMUNICACAO_Celular.Chamada.de.Voz[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V9_COMUNICACAO_Celular.Mensagem.de.Texto=as.character(attributes.csv$V9_COMUNICACAO_Celular.Mensagem.de.Texto[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V10_COMUNICACAO_E.mail=as.character(attributes.csv$V10_COMUNICACAO_E.mail[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V11_COMUNICACAO_Skype.Menssager=as.character(attributes.csv$V11_COMUNICACAO_Skype.Menssager[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V12_COMUNICACAO_Converso.Pessalmente=as.character(attributes.csv$V12_COMUNICACAO_Converso.Pessalmente[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.=as.character(attributes.csv$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V14_COMUNICACAO_Outro=as.character(attributes.csv$V14_COMUNICACAO_Outro[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS=as.character(attributes.csv$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V16_TEMPO_FUNC_Data_Abertura=as.character(attributes.csv$V16_TEMPO_FUNC_Data_Abertura[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V17_TEMPO_FUNC_Data_Pesquisa=as.character(attributes.csv$V17_TEMPO_FUNC_Data_Pesquisa[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V18_TEMPO_FUNC_Idade_Serviço_Dias=as.character(attributes.csv$V18_TEMPO_FUNC_Idade_Serviço_Dias[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V19_TEMPO_FUNC_Idade_em_anos=as.character(attributes.csv$V19_TEMPO_FUNC_Idade_em_anos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V20_FUNCIONAMENTO_Segunda=as.character(attributes.csv$V20_FUNCIONAMENTO_Segunda[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V21_FUNCIONAMENTO_Terça=as.character(attributes.csv$V21_FUNCIONAMENTO_Terça[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V22_FUNCIONAMENTO_Quarta=as.character(attributes.csv$V22_FUNCIONAMENTO_Quarta[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V23_FUNCIONAMENTO_Quinta=as.character(attributes.csv$V23_FUNCIONAMENTO_Quinta[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V24_FUNCIONAMENTO_Sexta=as.character(attributes.csv$V24_FUNCIONAMENTO_Sexta[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V25_FUNCIONAMENTO_Sábado=as.character(attributes.csv$V25_FUNCIONAMENTO_Sábado[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V26_FUNCIONAMENTO_Domingo=as.character(attributes.csv$V26_FUNCIONAMENTO_Domingo[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V27_FUNCIONAMENTO_Feriados=as.character(attributes.csv$V27_FUNCIONAMENTO_Feriados[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V28_FUNCIONAMENTO_Segunda....Manhã=as.character(attributes.csv$V28_FUNCIONAMENTO_Segunda....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V29_FUNCIONAMENTO_Segunda....Tarde=as.character(attributes.csv$V29_FUNCIONAMENTO_Segunda....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V30_FUNCIONAMENTO_Segunda....Noite=as.character(attributes.csv$V30_FUNCIONAMENTO_Segunda....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V31_FUNCIONAMENTO_Segunda....Plantão.24h=as.character(attributes.csv$V31_FUNCIONAMENTO_Segunda....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V32_FUNCIONAMENTO_Terça....Manhã=as.character(attributes.csv$V32_FUNCIONAMENTO_Terça....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V33_FUNCIONAMENTO_Terça....Tarde=as.character(attributes.csv$V33_FUNCIONAMENTO_Terça....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V34_FUNCIONAMENTO_Terça....Noite=as.character(attributes.csv$V34_FUNCIONAMENTO_Terça....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V35_FUNCIONAMENTO_Terça....Plantão.24h=as.character(attributes.csv$V35_FUNCIONAMENTO_Terça....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V36_FUNCIONAMENTO_Quarta....Manhã=as.character(attributes.csv$V36_FUNCIONAMENTO_Quarta....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V37_FUNCIONAMENTO_Quarta....Tarde=as.character(attributes.csv$V37_FUNCIONAMENTO_Quarta....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V38_FUNCIONAMENTO_Quarta....Noite=as.character(attributes.csv$V38_FUNCIONAMENTO_Quarta....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V39_FUNCIONAMENTO_Quarta....Plantão.24h=as.character(attributes.csv$V39_FUNCIONAMENTO_Quarta....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V40_FUNCIONAMENTO_Quinta....Manhã=as.character(attributes.csv$V40_FUNCIONAMENTO_Quinta....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V41_FUNCIONAMENTO_Quinta....Tarde=as.character(attributes.csv$V41_FUNCIONAMENTO_Quinta....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V42_FUNCIONAMENTO_Quinta....Noite=as.character(attributes.csv$V42_FUNCIONAMENTO_Quinta....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V43_FUNCIONAMENTO_Quinta....Plantão.24h=as.character(attributes.csv$V43_FUNCIONAMENTO_Quinta....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V44_FUNCIONAMENTO_Sexta....Manhã=as.character(attributes.csv$V44_FUNCIONAMENTO_Sexta....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V45_FUNCIONAMENTO_Sexta....Tarde=as.character(attributes.csv$V45_FUNCIONAMENTO_Sexta....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V46_FUNCIONAMENTO_Sexta....Noite=as.character(attributes.csv$V46_FUNCIONAMENTO_Sexta....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V47_FUNCIONAMENTO_Sexta....Plantão.24h=as.character(attributes.csv$V47_FUNCIONAMENTO_Sexta....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V48_FUNCIONAMENTO_Sábado....Manhã=as.character(attributes.csv$V48_FUNCIONAMENTO_Sábado....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V49_FUNCIONAMENTO_Sábado....Tarde=as.character(attributes.csv$V49_FUNCIONAMENTO_Sábado....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V50_FUNCIONAMENTO_Sábado....Noite=as.character(attributes.csv$V50_FUNCIONAMENTO_Sábado....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V51_FUNCIONAMENTO_Sábado....Plantão.24h=as.character(attributes.csv$V51_FUNCIONAMENTO_Sábado....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V52_FUNCIONAMENTO_Domingo....Manhã=as.character(attributes.csv$V52_FUNCIONAMENTO_Domingo....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V53_FUNCIONAMENTO_Domingo....Tarde=as.character(attributes.csv$V53_FUNCIONAMENTO_Domingo....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V54_FUNCIONAMENTO_Domingo....Noite=as.character(attributes.csv$V54_FUNCIONAMENTO_Domingo....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V55_FUNCIONAMENTO_Domingo....Plantão.24h=as.character(attributes.csv$V55_FUNCIONAMENTO_Domingo....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V56_FUNCIONAMENTO_Feriado....Manhã=as.character(attributes.csv$V56_FUNCIONAMENTO_Feriado....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V57_FUNCIONAMENTO_Feriado....Tarde=as.character(attributes.csv$V57_FUNCIONAMENTO_Feriado....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V58_FUNCIONAMENTO_Feriado....Noite=as.character(attributes.csv$V58_FUNCIONAMENTO_Feriado....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V59_FUNCIONAMENTO_Feriado....Plantão.24h=as.character(attributes.csv$V59_FUNCIONAMENTO_Feriado....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V61_PROFISSIONAIS_Assistentes.Sociais=as.character(attributes.csv$V61_PROFISSIONAIS_Assistentes.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem=as.character(attributes.csv$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V63_PROFISSIONAIS_Enfermeiros=as.character(attributes.csv$V63_PROFISSIONAIS_Enfermeiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V65_PROFISSIONAIS_Médicos=as.character(attributes.csv$V65_PROFISSIONAIS_Médicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V66_PROFISSIONAIS_Psicólogos=as.character(attributes.csv$V66_PROFISSIONAIS_Psicólogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V67_PROFISSIONAIS_Fisioterapeutas=as.character(attributes.csv$V67_PROFISSIONAIS_Fisioterapeutas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V68_PROFISSIONAIS_Terapeutas.Ocupacionais=as.character(attributes.csv$V68_PROFISSIONAIS_Terapeutas.Ocupacionais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V69_PROFISSIONAIS_Dentistas=as.character(attributes.csv$V69_PROFISSIONAIS_Dentistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V70_PROFISSIONAIS_Farmacêuticos=as.character(attributes.csv$V70_PROFISSIONAIS_Farmacêuticos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V71_PROFISSIONAIS_Administradores=as.character(attributes.csv$V71_PROFISSIONAIS_Administradores[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V73_PROFISSIONAIS_Educadores.Físicos=as.character(attributes.csv$V73_PROFISSIONAIS_Educadores.Físicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado=as.character(attributes.csv$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V76_PROFISSIONAIS_Educadores.Sociais=as.character(attributes.csv$V76_PROFISSIONAIS_Educadores.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V77_PROFISSIONAIS_Pedagogos=as.character(attributes.csv$V77_PROFISSIONAIS_Pedagogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V78_PROFISSIONAIS_Auxiliares.administrativos=as.character(attributes.csv$V78_PROFISSIONAIS_Auxiliares.administrativos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V79_PROFISSIONAIS_Recepcionistas=as.character(attributes.csv$V79_PROFISSIONAIS_Recepcionistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V80_PROFISSIONAIS_Serviços.gerais=as.character(attributes.csv$V80_PROFISSIONAIS_Serviços.gerais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V81_PROFISSIONAIS_Cozinheiros=as.character(attributes.csv$V81_PROFISSIONAIS_Cozinheiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V82_PROFISSIONAIS_Motoristas=as.character(attributes.csv$V82_PROFISSIONAIS_Motoristas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V83_PROFISSIONAIS_Porteiros=as.character(attributes.csv$V83_PROFISSIONAIS_Porteiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V84_PROFISSIONAIS_Outros=as.character(attributes.csv$V84_PROFISSIONAIS_Outros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V85_PROFISSIONAIS_TOTAL_Profissionais=as.character(attributes.csv$V85_PROFISSIONAIS_TOTAL_Profissionais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V87_PROFISSIONAIS_X2...Assistentes.Sociais=as.character(attributes.csv$V87_PROFISSIONAIS_X2...Assistentes.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem=as.character(attributes.csv$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V89_PROFISSIONAIS_X4...Enfermeiros=as.character(attributes.csv$V89_PROFISSIONAIS_X4...Enfermeiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V91_PROFISSIONAIS_X6...Médicos=as.character(attributes.csv$V91_PROFISSIONAIS_X6...Médicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V92_PROFISSIONAIS_X7...Psicólogos=as.character(attributes.csv$V92_PROFISSIONAIS_X7...Psicólogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V93_PROFISSIONAIS_X8...Fisioterapeutas=as.character(attributes.csv$V93_PROFISSIONAIS_X8...Fisioterapeutas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais=as.character(attributes.csv$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V95_PROFISSIONAIS_X10...Dentistas=as.character(attributes.csv$V95_PROFISSIONAIS_X10...Dentistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V96_PROFISSIONAIS_X11...Farmacêuticos=as.character(attributes.csv$V96_PROFISSIONAIS_X11...Farmacêuticos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V97_PROFISSIONAIS_X12...Administradores=as.character(attributes.csv$V97_PROFISSIONAIS_X12...Administradores[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V99_PROFISSIONAIS_X14...Educadores.Físicos=as.character(attributes.csv$V99_PROFISSIONAIS_X14...Educadores.Físicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado=as.character(attributes.csv$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V102_PROFISSIONAIS_X17...Educadores.Sociais=as.character(attributes.csv$V102_PROFISSIONAIS_X17...Educadores.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V103_PROFISSIONAIS_X18...Pedagogos=as.character(attributes.csv$V103_PROFISSIONAIS_X18...Pedagogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V104_PROFISSIONAIS_X19...Auxiliares.administrativos=as.character(attributes.csv$V104_PROFISSIONAIS_X19...Auxiliares.administrativos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V105_PROFISSIONAIS_X20...Recepcionistas=as.character(attributes.csv$V105_PROFISSIONAIS_X20...Recepcionistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V106_PROFISSIONAIS_X21...Serviços.gerais=as.character(attributes.csv$V106_PROFISSIONAIS_X21...Serviços.gerais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V107_PROFISSIONAIS_X22...Cozinheiros=as.character(attributes.csv$V107_PROFISSIONAIS_X22...Cozinheiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V108_PROFISSIONAIS_X23...Motoristas=as.character(attributes.csv$V108_PROFISSIONAIS_X23...Motoristas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V109_PROFISSIONAIS_X24...Porteiros=as.character(attributes.csv$V109_PROFISSIONAIS_X24...Porteiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V110_PACIENTES_Média.atende.dia.típico.=as.character(attributes.csv$V110_PACIENTES_Média.atende.dia.típico.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V111_PACIENTES_Média.capacidade.de.atender.=as.character(attributes.csv$V111_PACIENTES_Média.capacidade.de.atender.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..=as.character(attributes.csv$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..=as.character(attributes.csv$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V114_RELACOES_UAPS.RURAL=as.character(attributes.csv$V114_RELACOES_UAPS.RURAL[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V115_RELACOES_UAPS.URBANA=as.character(attributes.csv$V115_RELACOES_UAPS.URBANA[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V116_RELACOES_Ajuda.Mútua=as.character(attributes.csv$V116_RELACOES_Ajuda.Mútua[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT=as.character(attributes.csv$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V118_RELACOES_Residência.Terapeutica=as.character(attributes.csv$V118_RELACOES_Residência.Terapeutica[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V119_RELACOES_Entidades.Socioassistenciais=as.character(attributes.csv$V119_RELACOES_Entidades.Socioassistenciais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V120_RELACOES_Assistência.Hospitalar=as.character(attributes.csv$V120_RELACOES_Assistência.Hospitalar[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V121_RELACOES_CAPS=as.character(attributes.csv$V121_RELACOES_CAPS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V122_RELACOES_CRAS=as.character(attributes.csv$V122_RELACOES_CRAS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V123_RELACOES_CREAS=as.character(attributes.csv$V123_RELACOES_CREAS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V124_RELACOES_Acolhimento.Institucional=as.character(attributes.csv$V124_RELACOES_Acolhimento.Institucional[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V125_RELACOES_Urgência.Emergência=as.character(attributes.csv$V125_RELACOES_Urgência.Emergência[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V126_RELACOES_Ambulatório.de.Saúde.Mental=as.character(attributes.csv$V126_RELACOES_Ambulatório.de.Saúde.Mental[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V127_RELACOES_Centro.de.Convivência=as.character(attributes.csv$V127_RELACOES_Centro.de.Convivência[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V128_RELACOES_Consultório.na.Rua=as.character(attributes.csv$V128_RELACOES_Consultório.na.Rua[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO=as.character(attributes.csv$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS=as.character(attributes.csv$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V131_GEO_kml_latitude=as.character(attributes.csv$V131_GEO_kml_latitude[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V132_GEO_kml_longitude=as.character(attributes.csv$V132_GEO_kml_longitude[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])
```

#20. Adding pallettes colors
```{r, message=FALSE, warning=F, include=F}
vertex_col <- brewer.pal(length(unique(V(full_no_zero)$LABEL_COR)), "Set3")
V(full_no_zero)$color <- vertex_col[factor(V(full_no_zero)$LABEL_COR)]
```

#21. Basic Proof full_no_zero
```{r, message=FALSE, warning=FALSE, include=FALSE}
#The most important test full_no_zero
a=get.vertex.attribute(full_no_zero, 'V2_LABEL_ID')
b=attributes.csv$V3_LABEL_ID2
c=cbind(a,b)
head(c)

#The most important test full_no_zero
d=get.vertex.attribute(full_with_zero, 'V2_LABEL_ID')
b=attributes.csv$V3_LABEL_ID2
e=cbind(d,b)
head(e)
```

#22. Creating individual graphs by type after all atributtes are added
```{r, message=FALSE, warning=FALSE, include=FALSE}

#B1 Tipo de Relacionamento	B1.2 – TIPOS DE RELACIONAMENTO - FORMAL. No que se refere à ATENÇÃO aos USUÁRIOS DE DROGAS, você caracteriza como FORMAL o relacionamento que o seu serviço possui com os #serviços a seguir ? Parceria Formal - Feita através de paceria/fluxo institucional devadmente reconheca, por meio de convênios, contratos, ou acordo entre gesotres/secretarias etc.
var0 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero, name = "var0") == 0])

#B2- ATIVADES EM CONJUNTO	B2.1 – TIPOS DE RELACIONAMENTO - REFERENCIA DE ENVIO  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE ENVIO OU ENCAMINHAMENTO DE USUÁRIO DE DROGAS COM OS SERVIÇOS A SEGUIR: #REFERENCIA DE ENVIO - Usuários de Drogas encaminhados a outros serviços da rede
var1 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var1") == 0])

#B2- ATIVADES EM CONJUNTO	B2.2 – TIPOS DE RELACIONAMENTO - REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE RECEBIMENTO OU CONTRAREFERENCIA DE USUÁRIO DE #DROGAS COM: REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA  - USUÁRIOS DE DROGAS RECEBOS OU CONTRAREFERENCIADOS DE OUTROS SERVIÇOS DA REDE
var2 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var2") == 0])

#B2- ATIVADES EM CONJUNTO	B2.3 – TIPOS DE RELACIONAMENTO  - COORDENAÇÃO CONJUNTA DE CASOS  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE COORDENAÇÃO CONJUNTA DE CASOS REFERENTE AO USO DE DROGAS COM: COORDENAÇÃO #CONJUNTA DE CASOS - COMPARTILHAMENTO DE DADOS E CONDUTAS A RESPEITO DE UM CASO ESPECÍFICO RELACIONADO AO USO DE DROGAS, RESPONSABILADE COMPARTILHADA DE CASOS, TRATAMENTO DE USUÁRIOS DE DROGAS EM CONJUNTO #COM OUTROS SERVIÇOS
var3 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var3") == 0])

#B2- ATIVADES EM CONJUNTO	B2.4 – TIPOS DE RELACIONAMENTO - PROGRAMAS EM CONJUNTO - O SEU SERVIÇO MANTÉM ALGUM TIPO DE PROGRAMA EM CONJUNTO REFERENTE AO USO DE DROGAS COM: PROGRAMAS EM CONJUNTO  - #PROGRAMAS E PROJETOS REFERENTES AO USO DE DROGAS DESENVOLVOS EM CONJUNTO COM OUTROS SERVIÇOS
var4 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var4") == 0])

#B2- ATIVADES EM CONJUNTO	B2.5 – TIPOS DE RELACIONAMENTO  - OFERTA DE TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ TREINOU OU CAPACITOU ALGUM DOS SERVIÇOS A SEGUIR:  OFERTA #DE TREINAMENTOS/CAPACITAÇÕES  - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE RELACIONADOS AO USO DE DROGAS OFERECOS PARA OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL
var5 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var5") == 0])

#B2- ATIVADES EM CONJUNTO	B2.6 – TIPOS DE RELACIONAMENTO  - RECEBER TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ FOI TREINADO OU CAPACITADO POR ALGUM DOS SERVIÇOS A SEGUIR: #RECEBER TREINAMENTOS/CAPACITAÇÕES - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE REFERENTES AO USO DE DROGAS RECEBOS DE OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL 
var6 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var6") == 0])

#ACESSO	A) Este serviço mostra-se disponível para realização de ativades em conjunto.
var7 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var7") == 0])

#ACESSO	B) O horário de funcionamento deste serviço possibilita a realização de ações em conjunto.
var8 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var8") == 0])

#ACESSO	C) Este serviço disponibiliza informações sobre suas ativades para o seu serviço.
var9 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var9") == 0])

#ACESSO	D) O seu serviço consegue acessar facilmente informações deste serviço.
var10 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var10") == 0])

#ACESSO	E) Os canais de comunicação com este serviço são suficientes para realização de ações em conjunto.
var11 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var11") == 0])

#ACESSO	F) Seu serviço tem facilade de entrar em contato com este serviço para realizar ativades em conjunto.
var12 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var12") == 0])

#ACESSO	G) O acesso geográfico a este serviço impede a realização de ativades em conjunto.  
var13 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var13") == 0])

#ACESSO	H) O custo para acessar este serviço impede a realização de ativades em conjunto.
var14 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var14") == 0])

#ACESSO	I) O tempo gasto para acessar este serviço impede a realização ativades em conjunto.
var15 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var15") == 0])

#CONFIANÇA	A) Seu serviço confia  na qualificação profissional da equipe deste serviço 
var16 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var16") == 0])

#CONFIANÇA	B) Seu serviço confia  na capacade técnica da equipe deste serviço.
var17 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var17") == 0])

#CONFIANÇA	C) Seu serviço confia  nas ações realizadas por este serviço.
var18 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var18") == 0])

#CONFIANÇA	D) Seu serviço confia  em compartilhar informações internas com este serviço. 
var19 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var19") == 0])

#CONFIANÇA	E) Seu serviço confia nas informações recebas deste serviço.
var20 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var20") == 0])

#CONFIANÇA	F) Seu serviço confia  em realizar ações conjuntas com este serviço.
var21 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var21") == 0])

#CONFIANÇA	G) Seu serviço está satisfeito  com as ações desempenhadas por este serviço.
var22 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var22") == 0])

#CONFIANÇA	H) Seu serviço espera que o relacionamento com este serviço continue nos próximos anos.
var23 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var23") == 0])

#CONFIANÇA	I) Seu serviço espera que o relacionamento com este serviço se fortaleça nos próximos anos.
var24 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var24") == 0])

#SOMATÓRIO ATIVIDADE
atividade = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "atividade") == 0])

#SOMATÓRIO ACESSO
acesso = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "acesso") == 0])

#SOMATÓRIO CONFIANÇA
confianca = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "confianca") == 0])

#SOMATÓRIO TOTAL
total = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "total") == 0])

```

#23. Saving objects to connect with futher scripts
```{r}
save.image("~/SNArRDJF/Principal Objects.RData")
```


#24. Opening 

#Descriptive Analysis for Full No Zero (COMPLETA)
```{r}

#Vertices and Edges Number
vcount(full_no_zero)
ecount(full_no_zero)

#Centrality Degree  
V(full_no_zero)$indegree<-degree(full_no_zero, mode = "in")
V(full_no_zero)$outdegree <- degree(full_no_zero, mode = "out")
V(full_no_zero)$totaldegree <- degree(full_no_zero, mode = "total")


full_no_zero_indegree<-degree(full_no_zero, mode = "in")
full_no_zero_outdegree<-degree(full_no_zero, mode = "out")
full_no_zero_totaldegree<-degree(full_no_zero, mode = "total")

#Histogram full_no_zero degree
hist(degree(full_no_zero))

# Centrality Degree Descriptive Statistics

##in
summary(full_no_zero_indegree)
sd(full_no_zero_indegree)
##out
summary(full_no_zero_outdegree)
sd(full_no_zero_outdegree)
##all
summary(full_no_zero_totaldegree)
sd(full_no_zero_totaldegree)

#Closeness 
V(full_no_zero)$incloseness <- closeness(full_no_zero, mode = "in") #%>% round(6)
V(full_no_zero)$outcloseness <- closeness(full_no_zero, mode = "out") #%>% round(6)
V(full_no_zero)$totalcloseness <- closeness(full_no_zero, mode = "total") #%>% round(6)
full_no_zero_incloseness<- closeness(full_no_zero, mode = "in") #%>% round(6)
full_no_zero_outcloseness<- closeness(full_no_zero, mode = "out") #%>% round(6)
full_no_zero_totalcloseness<- closeness(full_no_zero, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(full_no_zero_incloseness)
sd(full_no_zero_incloseness)
##out
summary(full_no_zero_outcloseness)
sd(full_no_zero_outcloseness)
##all
summary(full_no_zero_totalcloseness)
sd(full_no_zero_totalcloseness)

#Betweenness
V(full_no_zero)$betweenness <- betweenness(full_no_zero) %>% round(1)
full_no_zero_betweenness <- betweenness(full_no_zero) %>% round(1)

#Edge Betweenness
E(full_no_zero)$edge.btweenness<-edge.betweenness(full_no_zero)
full_no_zero_edge.betweenness <-edge.betweenness(full_no_zero)

##all
summary(full_no_zero_betweenness)
sd(full_no_zero_betweenness)

#Eigen_Centrality
V(full_no_zero)$eigenvector <- eigen_centrality(full_no_zero, directed = TRUE) %$% vector %>% round(3)
full_no_zero_eigenvector <- eigen_centrality(full_no_zero, directed = TRUE) %$% vector %>% round(3)

#all
summary(full_no_zero_eigenvector)
sd(full_no_zero_eigenvector)


#PageRank
V(full_no_zero)$page.rank<-page.rank(full_no_zero)$vector
full_no_zero_pr<-page.rank(full_no_zero)$vector
#stats
summary(full_no_zero_pr)
sd(full_no_zero_pr)

#Kleinberg’s authority scores
V(full_no_zero)$authority.score<- authority.score(g)$vector
full_no_zero_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(full_no_zero)$hub <- hub.score(g)$vector
full_no_zero_hub<- hub.score(g)$vector
#stats
summary(full_no_zero_hub)
sd(full_no_zero_hub)


#Community detection (betweenness)
full_no_zero_edge.betweenness.community <- edge.betweenness.community(full_no_zero)
#create communities
V(full_no_zero)$edge.betweenness.community <- membership(full_no_zero_edge.betweenness.community)
full_no_zero_edge.betweenness.community <- membership(full_no_zero_edge.betweenness.community)


#Community detection (Random walk)
full_no_zero_walktrap.community <- walktrap.community(full_no_zero)
#create 10 communities
V(full_no_zero)$walktrap.community <- membership(full_no_zero_walktrap.community)
full_no_zero_walktrap.community <- membership(full_no_zero_walktrap.community)


#Shortest Paths
full_no_zero_sp_in <- shortest.paths(full_no_zero, mode='in')
full_no_zero_sp_out <- shortest.paths(full_no_zero, mode='out')

#in
mean(full_no_zero_sp_in[which(full_no_zero_sp_in != Inf)])
sd(full_no_zero_sp_in[which(full_no_zero_sp_in != Inf)])
#out
mean(full_no_zero_sp_out[which(full_no_zero_sp_out != Inf)])
sd(full_no_zero_sp_out[which(full_no_zero_sp_out != Inf)])

#Reachability
full_no_zero_reach_in <- reachability(full_no_zero, 'in')
full_no_zero_reach_out <- reachability(full_no_zero, 'out')

#in
mean(full_no_zero_reach_in[which(full_no_zero_reach_in != Inf)])
sd(full_no_zero_reach_in[which(full_no_zero_reach_in != Inf)])
#out
mean(full_no_zero_reach_out[which(full_no_zero_reach_out != Inf)])
sd(full_no_zero_reach_out[which(full_no_zero_reach_out != Inf)])

# Density 
graph.density(full_no_zero)

# Reciprocity
reciprocity(full_no_zero)

# Transitivity
transitivity(full_no_zero)

#Diameter
diameter(full_no_zero)
get.diameter(full_no_zero)

#Maximal Independence Vertex Sets
#independence.number(full_no_zero)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_full_no_zero <- triad.census(full_no_zero)
triad_df_full_no_zero <- data.frame(census_labels,tc_full_no_zero)
triad_df_full_no_zero
write.csv(triad_df_full_no_zero, 'full_no_zero_complet_triads.csv')


#Creating Vectors to pass means for each vertex

full_no_zero_sp_in_vec <- vector()
full_no_zero_sp_out_vec <- vector()
full_no_zero_reach_in_vec <- vector()
full_no_zero_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(full_no_zero))
  full_no_zero_reach_in_vec[i] <- mean(full_no_zero_reach_in[i,])
  V(full_no_zero)$full_no_zero_reach_in_vec[i] <- mean(full_no_zero_reach_in[i,]) #adding to igraph object
  
  full_no_zero_reach_out_vec[i] <- mean(full_no_zero_reach_out[i,])
  V(full_no_zero)$full_no_zero_reach_out_vec[i] <- mean(full_no_zero_reach_out[i,]) #adding to igraph object
  
  full_no_zero_shortest.paths.in_vec[i] <- mean(full_no_zero_sp_in[i,])
  V(full_no_zero)$full_no_zero_shortest.paths.in_vec[i] <- mean(full_no_zero_sp_in[i,]) #adding to igraph object
  
  full_no_zero_shortest.paths.out_vec[i] <- mean(full_no_zero_sp_out[i,])
  V(full_no_zero)$full_no_zero_shortest.paths.out_vec[i] <- mean(full_no_zero_sp_out[i,]) #adding to igraph object


full_no_zero_node_stats_df <- cbind(
full_no_zero_indegree,
full_no_zero_outdegree,
full_no_zero_totaldegree,
full_no_zero_incloseness,
full_no_zero_outcloseness,
full_no_zero_totalcloseness,
full_no_zero_betweenness,
full_no_zero_eigenvector,
full_no_zero_reach_in_vec, 
full_no_zero_reach_out_vec, 
full_no_zero_sp_in_vec, 
full_no_zero_sp_out_vec)

write.csv(full_no_zero_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/full_no_zero_node_stats_df.csv")


#Grafo full_no_zero

teste =as.numeric(get.vertex.attribute(full_no_zero,"totaldegree"))


plot(full_no_zero, 
     layout=layout.fruchterman.reingold(full_no_zero), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(full_no_zero,"color"), 
     vertex.label=get.vertex.attribute(full_no_zero,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(full_no_zero)/1000,
     main="Grafo Completo")


legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(full_no_zero,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(full_no_zero,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Find connected components
clusters(full_no_zero)


plot(full_no_zero, 
     layout=layout.fruchterman.reingold(full_no_zero),
     vertex.size=degree(full_no_zero)/70,
     vertex.color=get.vertex.attribute(full_no_zero,"color"), 
     vertex.label=get.vertex.attribute(full_no_zero,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="Grafo Completo")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(full_no_zero,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(full_no_zero,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Decompose Graph - get connected components 
dg <- decompose.graph(full_no_zero)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(full_no_zero)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(full_no_zero)
```

#Descriptive Analysis for VAR0 "RELACIONAMENTO FORMAL"
```{r}
#Vertices and Edges Number
vcount(var0)
ecount(var0)


#Centrality Degree  
V(var0)$indegree<-degree(var0, mode = "in")
V(var0)$outdegree <- degree(var0, mode = "out")
V(var0)$totaldegree <- degree(var0, mode = "total")


var0_indegree<-degree(var0, mode = "in")
var0_outdegree<-degree(var0, mode = "out")
var0_totaldegree<-degree(var0, mode = "total")

#Histogram var0 degree
hist(degree(var0))

# Centrality Degree Descriptive Statistics

##in
summary(var0_indegree)
sd(var0_indegree)
##out
summary(var0_outdegree)
sd(var0_outdegree)
##all
summary(var0_totaldegree)
sd(var0_totaldegree)

#Closeness 
V(var0)$incloseness <- closeness(var0, mode = "in") #%>% round(6)
V(var0)$outcloseness <- closeness(var0, mode = "out") #%>% round(6)
V(var0)$totalcloseness <- closeness(var0, mode = "total") #%>% round(6)
var0_incloseness<- closeness(var0, mode = "in") #%>% round(6)
var0_outcloseness<- closeness(var0, mode = "out") #%>% round(6)
var0_totalcloseness<- closeness(var0, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var0_incloseness)
sd(var0_incloseness)
##out
summary(var0_outcloseness)
sd(var0_outcloseness)
##all
summary(var0_totalcloseness)
sd(var0_totalcloseness)

#Betweenness
V(var0)$betweenness <- betweenness(var0) %>% round(1)
var0_betweenness <- betweenness(var0) %>% round(1)

#Edge Betweenness
E(var0)$edge.btweenness<-edge.betweenness(var0)
var0_edge.betweenness <-edge.betweenness(var0)

##all
summary(var0_betweenness)
sd(var0_betweenness)

#Eigen_Centrality
V(var0)$eigenvector <- eigen_centrality(var0, directed = TRUE) %$% vector %>% round(3)
var0_eigenvector <- eigen_centrality(var0, directed = TRUE) %$% vector %>% round(3)

#all
summary(var0_eigenvector)
sd(var0_eigenvector)


#PageRank
V(var0)$page.rank<-page.rank(var0)$vector
var0_pr<-page.rank(var0)$vector
#stats
summary(var0_pr)
sd(var0_pr)

#Kleinberg’s authority scores
V(var0)$authority.score<- authority.score(g)$vector
var0_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var0)$hub <- hub.score(g)$vector
var0_hub<- hub.score(g)$vector
#stats
summary(var0_hub)
sd(var0_hub)


#Community detection (betweenness)
var0_edge.betweenness.community <- edge.betweenness.community(var0)
#create communities
V(var0)$edge.betweenness.community <- membership(var0_edge.betweenness.community)
var0_edge.betweenness.community <- membership(var0_edge.betweenness.community)


#Community detection (Random walk)
var0_walktrap.community <- walktrap.community(var0)
#create 10 communities
V(var0)$walktrap.community <- membership(var0_walktrap.community)
var0_walktrap.community <- membership(var0_walktrap.community)


#Shortest Paths
var0_sp_in <- shortest.paths(var0, mode='in')
var0_sp_out <- shortest.paths(var0, mode='out')

#in
mean(var0_sp_in[which(var0_sp_in != Inf)])
sd(var0_sp_in[which(var0_sp_in != Inf)])
#out
mean(var0_sp_out[which(var0_sp_out != Inf)])
sd(var0_sp_out[which(var0_sp_out != Inf)])

#Reachability
var0_reach_in <- reachability(var0, 'in')
var0_reach_out <- reachability(var0, 'out')

#in
mean(var0_reach_in[which(var0_reach_in != Inf)])
sd(var0_reach_in[which(var0_reach_in != Inf)])
#out
mean(var0_reach_out[which(var0_reach_out != Inf)])
sd(var0_reach_out[which(var0_reach_out != Inf)])

# Density 
graph.density(var0)

# Reciprocity
reciprocity(var0)

# Transitivity
transitivity(var0)

#Diameter
diameter(var0)
get.diameter(var0)

#Maximal Independence Vertex Sets
#independence.number(var0)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var0 <- triad.census(var0)
triad_df_var0 <- data.frame(census_labels,tc_var0)
triad_df_var0
write.csv(triad_df_var0, 'var0_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var0_sp_in_vec <- vector()
var0_sp_out_vec <- vector()
var0_reach_in_vec <- vector()
var0_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var0))
  var0_reach_in_vec[i] <- mean(var0_reach_in[i,])
  V(var0)$var0_reach_in_vec[i] <- mean(var0_reach_in[i,]) #adding to igraph object
  
  var0_reach_out_vec[i] <- mean(var0_reach_out[i,])
  V(var0)$var0_reach_out_vec[i] <- mean(var0_reach_out[i,]) #adding to igraph object
  
  var0_shortest.paths.in_vec[i] <- mean(var0_sp_in[i,])
  V(var0)$var0_shortest.paths.in_vec[i] <- mean(var0_sp_in[i,]) #adding to igraph object
  
  var0_shortest.paths.out_vec[i] <- mean(var0_sp_out[i,])
  V(var0)$var0_shortest.paths.out_vec[i] <- mean(var0_sp_out[i,]) #adding to igraph object


var0_node_stats_df <- cbind(
var0_indegree,
var0_outdegree,
var0_totaldegree,
var0_incloseness,
var0_outcloseness,
var0_totalcloseness,
var0_betweenness,
var0_eigenvector,
var0_reach_in_vec, 
var0_reach_out_vec, 
var0_sp_in_vec, 
var0_sp_out_vec)

write.csv(var0_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var0_node_stats_df.csv")


#Grafo var0

teste =as.numeric(get.vertex.attribute(var0,"totaldegree"))


plot(var0, 
     layout=layout.fruchterman.reingold(var0), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var0,"color"), 
     vertex.label=get.vertex.attribute(var0,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var0)/1000,
     main="RELACIONAMENTO FORMAL")


#Find connected components
clusters(var0)


plot(var0, 
     layout=layout.fruchterman.reingold(var0),
     vertex.size=degree(var0)/70,
     vertex.color=get.vertex.attribute(var0,"color"), 
     vertex.label=get.vertex.attribute(var0,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="RELACIONAMENTO FORMAL")


#Decompose Graph - get connected components 
dg <- decompose.graph(var0)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var0)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var0)
```

#Descriptive Analysis for VAR1 "REFERENCIA DE ENVIO",
```{r}
#Vertices and Edges Number
vcount(var1)
ecount(var1)

#Centrality Degree  
V(var1)$indegree<-degree(var1, mode = "in")
V(var1)$outdegree <- degree(var1, mode = "out")
V(var1)$totaldegree <- degree(var1, mode = "total")


var1_indegree<-degree(var1, mode = "in")
var1_outdegree<-degree(var1, mode = "out")
var1_totaldegree<-degree(var1, mode = "total")

#Histogram var1 degree
hist(degree(var1))

# Centrality Degree Descriptive Statistics

##in
summary(var1_indegree)
sd(var1_indegree)
##out
summary(var1_outdegree)
sd(var1_outdegree)
##all
summary(var1_totaldegree)
sd(var1_totaldegree)

#Closeness 
V(var1)$incloseness <- closeness(var1, mode = "in") #%>% round(6)
V(var1)$outcloseness <- closeness(var1, mode = "out") #%>% round(6)
V(var1)$totalcloseness <- closeness(var1, mode = "total") #%>% round(6)
var1_incloseness<- closeness(var1, mode = "in") #%>% round(6)
var1_outcloseness<- closeness(var1, mode = "out") #%>% round(6)
var1_totalcloseness<- closeness(var1, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var1_incloseness)
sd(var1_incloseness)
##out
summary(var1_outcloseness)
sd(var1_outcloseness)
##all
summary(var1_totalcloseness)
sd(var1_totalcloseness)

#Betweenness
V(var1)$betweenness <- betweenness(var1) %>% round(1)
var1_betweenness <- betweenness(var1) %>% round(1)

#Edge Betweenness
E(var1)$edge.btweenness<-edge.betweenness(var1)
var1_edge.betweenness <-edge.betweenness(var1)

##all
summary(var1_betweenness)
sd(var1_betweenness)

#Eigen_Centrality
V(var1)$eigenvector <- eigen_centrality(var1, directed = TRUE) %$% vector %>% round(3)
var1_eigenvector <- eigen_centrality(var1, directed = TRUE) %$% vector %>% round(3)

#all
summary(var1_eigenvector)
sd(var1_eigenvector)


#PageRank
V(var1)$page.rank<-page.rank(var1)$vector
var1_pr<-page.rank(var1)$vector
#stats
summary(var1_pr)
sd(var1_pr)

#Kleinberg’s authority scores
V(var1)$authority.score<- authority.score(g)$vector
var1_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var1)$hub <- hub.score(g)$vector
var1_hub<- hub.score(g)$vector
#stats
summary(var1_hub)
sd(var1_hub)


#Community detection (betweenness)
var1_edge.betweenness.community <- edge.betweenness.community(var1)
#create communities
V(var1)$edge.betweenness.community <- membership(var1_edge.betweenness.community)
var1_edge.betweenness.community <- membership(var1_edge.betweenness.community)


#Community detection (Random walk)
var1_walktrap.community <- walktrap.community(var1)
#create 10 communities
V(var1)$walktrap.community <- membership(var1_walktrap.community)
var1_walktrap.community <- membership(var1_walktrap.community)


#Shortest Paths
var1_sp_in <- shortest.paths(var1, mode='in')
var1_sp_out <- shortest.paths(var1, mode='out')

#in
mean(var1_sp_in[which(var1_sp_in != Inf)])
sd(var1_sp_in[which(var1_sp_in != Inf)])
#out
mean(var1_sp_out[which(var1_sp_out != Inf)])
sd(var1_sp_out[which(var1_sp_out != Inf)])

#Reachability
var1_reach_in <- reachability(var1, 'in')
var1_reach_out <- reachability(var1, 'out')

#in
mean(var1_reach_in[which(var1_reach_in != Inf)])
sd(var1_reach_in[which(var1_reach_in != Inf)])
#out
mean(var1_reach_out[which(var1_reach_out != Inf)])
sd(var1_reach_out[which(var1_reach_out != Inf)])

# Density 
graph.density(var1)

# Reciprocity
reciprocity(var1)

# Transitivity
transitivity(var1)

#Diameter
diameter(var1)
get.diameter(var1)

#Maximal Independence Vertex Sets
#independence.number(var1)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var1 <- triad.census(var1)
triad_df_var1 <- data.frame(census_labels,tc_var1)
triad_df_var1
write.csv(triad_df_var1, 'var1_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var1_sp_in_vec <- vector()
var1_sp_out_vec <- vector()
var1_reach_in_vec <- vector()
var1_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var1))
  var1_reach_in_vec[i] <- mean(var1_reach_in[i,])
  V(var1)$var1_reach_in_vec[i] <- mean(var1_reach_in[i,]) #adding to igraph object
  
  var1_reach_out_vec[i] <- mean(var1_reach_out[i,])
  V(var1)$var1_reach_out_vec[i] <- mean(var1_reach_out[i,]) #adding to igraph object
  
  var1_shortest.paths.in_vec[i] <- mean(var1_sp_in[i,])
  V(var1)$var1_shortest.paths.in_vec[i] <- mean(var1_sp_in[i,]) #adding to igraph object
  
  var1_shortest.paths.out_vec[i] <- mean(var1_sp_out[i,])
  V(var1)$var1_shortest.paths.out_vec[i] <- mean(var1_sp_out[i,]) #adding to igraph object


var1_node_stats_df <- cbind(
var1_indegree,
var1_outdegree,
var1_totaldegree,
var1_incloseness,
var1_outcloseness,
var1_totalcloseness,
var1_betweenness,
var1_eigenvector,
var1_reach_in_vec, 
var1_reach_out_vec, 
var1_sp_in_vec, 
var1_sp_out_vec)

write.csv(var1_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var1_node_stats_df.csv")


#Grafo var1

teste =as.numeric(get.vertex.attribute(var1,"totaldegree"))


plot(var1, 
     layout=layout.fruchterman.reingold(var1), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var1,"color"), 
     vertex.label=get.vertex.attribute(var1,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var1)/1000,
     main="REFERENCIA DE ENVIO")


legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var1,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var1,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(var1)


plot(var1, 
     layout=layout.fruchterman.reingold(var1),
     vertex.size=degree(var1)/70,
     vertex.color=get.vertex.attribute(var1,"color"), 
     vertex.label=get.vertex.attribute(var1,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="REFERENCIA DE ENVIO")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var1,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var1,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Decompose Graph - get connected components 
dg <- decompose.graph(var1)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var1)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var1)
```

#Descriptive Analysis for var2 "REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA",
```{r}
#Vertices and Edges Number
vcount(var2)
ecount(var2)

#Centrality Degree  
V(var2)$indegree<-degree(var2, mode = "in")
V(var2)$outdegree <- degree(var2, mode = "out")
V(var2)$totaldegree <- degree(var2, mode = "total")


var2_indegree<-degree(var2, mode = "in")
var2_outdegree<-degree(var2, mode = "out")
var2_totaldegree<-degree(var2, mode = "total")

#Histogram var2 degree
hist(degree(var2))

# Centrality Degree Descriptive Statistics

##in
summary(var2_indegree)
sd(var2_indegree)
##out
summary(var2_outdegree)
sd(var2_outdegree)
##all
summary(var2_totaldegree)
sd(var2_totaldegree)

#Closeness 
V(var2)$incloseness <- closeness(var2, mode = "in") #%>% round(6)
V(var2)$outcloseness <- closeness(var2, mode = "out") #%>% round(6)
V(var2)$totalcloseness <- closeness(var2, mode = "total") #%>% round(6)
var2_incloseness<- closeness(var2, mode = "in") #%>% round(6)
var2_outcloseness<- closeness(var2, mode = "out") #%>% round(6)
var2_totalcloseness<- closeness(var2, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var2_incloseness)
sd(var2_incloseness)
##out
summary(var2_outcloseness)
sd(var2_outcloseness)
##all
summary(var2_totalcloseness)
sd(var2_totalcloseness)

#Betweenness
V(var2)$betweenness <- betweenness(var2) %>% round(1)
var2_betweenness <- betweenness(var2) %>% round(1)

#Edge Betweenness
E(var2)$edge.btweenness<-edge.betweenness(var2)
var2_edge.betweenness <-edge.betweenness(var2)

##all
summary(var2_betweenness)
sd(var2_betweenness)

#Eigen_Centrality
V(var2)$eigenvector <- eigen_centrality(var2, directed = TRUE) %$% vector %>% round(3)
var2_eigenvector <- eigen_centrality(var2, directed = TRUE) %$% vector %>% round(3)

#all
summary(var2_eigenvector)
sd(var2_eigenvector)


#PageRank
V(var2)$page.rank<-page.rank(var2)$vector
var2_pr<-page.rank(var2)$vector
#stats
summary(var2_pr)
sd(var2_pr)

#Kleinberg’s authority scores
V(var2)$authority.score<- authority.score(g)$vector
var2_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var2)$hub <- hub.score(g)$vector
var2_hub<- hub.score(g)$vector
#stats
summary(var2_hub)
sd(var2_hub)


#Community detection (betweenness)
var2_edge.betweenness.community <- edge.betweenness.community(var2)
#create communities
V(var2)$edge.betweenness.community <- membership(var2_edge.betweenness.community)
var2_edge.betweenness.community <- membership(var2_edge.betweenness.community)


#Community detection (Random walk)
var2_walktrap.community <- walktrap.community(var2)
#create 10 communities
V(var2)$walktrap.community <- membership(var2_walktrap.community)
var2_walktrap.community <- membership(var2_walktrap.community)


#Shortest Paths
var2_sp_in <- shortest.paths(var2, mode='in')
var2_sp_out <- shortest.paths(var2, mode='out')

#in
mean(var2_sp_in[which(var2_sp_in != Inf)])
sd(var2_sp_in[which(var2_sp_in != Inf)])
#out
mean(var2_sp_out[which(var2_sp_out != Inf)])
sd(var2_sp_out[which(var2_sp_out != Inf)])

#Reachability
var2_reach_in <- reachability(var2, 'in')
var2_reach_out <- reachability(var2, 'out')

#in
mean(var2_reach_in[which(var2_reach_in != Inf)])
sd(var2_reach_in[which(var2_reach_in != Inf)])
#out
mean(var2_reach_out[which(var2_reach_out != Inf)])
sd(var2_reach_out[which(var2_reach_out != Inf)])

# Density 
graph.density(var2)

# Reciprocity
reciprocity(var2)

# Transitivity
transitivity(var2)

#Diameter
diameter(var2)
get.diameter(var2)

#Maximal Independence Vertex Sets
#independence.number(var2)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var2 <- triad.census(var2)
triad_df_var2 <- data.frame(census_labels,tc_var2)
triad_df_var2
write.csv(triad_df_var2, 'var2_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var2_sp_in_vec <- vector()
var2_sp_out_vec <- vector()
var2_reach_in_vec <- vector()
var2_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var2))
  var2_reach_in_vec[i] <- mean(var2_reach_in[i,])
  V(var2)$var2_reach_in_vec[i] <- mean(var2_reach_in[i,]) #adding to igraph object
  
  var2_reach_out_vec[i] <- mean(var2_reach_out[i,])
  V(var2)$var2_reach_out_vec[i] <- mean(var2_reach_out[i,]) #adding to igraph object
  
  var2_shortest.paths.in_vec[i] <- mean(var2_sp_in[i,])
  V(var2)$var2_shortest.paths.in_vec[i] <- mean(var2_sp_in[i,]) #adding to igraph object
  
  var2_shortest.paths.out_vec[i] <- mean(var2_sp_out[i,])
  V(var2)$var2_shortest.paths.out_vec[i] <- mean(var2_sp_out[i,]) #adding to igraph object


var2_node_stats_df <- cbind(
var2_indegree,
var2_outdegree,
var2_totaldegree,
var2_incloseness,
var2_outcloseness,
var2_totalcloseness,
var2_betweenness,
var2_eigenvector,
var2_reach_in_vec, 
var2_reach_out_vec, 
var2_sp_in_vec, 
var2_sp_out_vec)

write.csv(var2_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var2_node_stats_df.csv")


#Grafo var2

teste =as.numeric(get.vertex.attribute(var2,"totaldegree"))


plot(var2, 
     layout=layout.fruchterman.reingold(var2), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var2,"color"), 
     vertex.label=get.vertex.attribute(var2,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var2)/1000,
     main="REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var2,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var2,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(var2)


plot(var2, 
     layout=layout.fruchterman.reingold(var2),
     vertex.size=degree(var2)/70,
     vertex.color=get.vertex.attribute(var2,"color"), 
     vertex.label=get.vertex.attribute(var2,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var2,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var2,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Decompose Graph - get connected components 
dg <- decompose.graph(var2)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var2)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var2)
```

#Descriptive Analysis for var3 "COORDENAÇÃO CONJUNTA DE CASOS",
```{r}
#Vertices and Edges Number
vcount(var3)
ecount(var3)

#Centrality Degree  
V(var3)$indegree<-degree(var3, mode = "in")
V(var3)$outdegree <- degree(var3, mode = "out")
V(var3)$totaldegree <- degree(var3, mode = "total")


var3_indegree<-degree(var3, mode = "in")
var3_outdegree<-degree(var3, mode = "out")
var3_totaldegree<-degree(var3, mode = "total")

#Histogram var3 degree
hist(degree(var3))

# Centrality Degree Descriptive Statistics

##in
summary(var3_indegree)
sd(var3_indegree)
##out
summary(var3_outdegree)
sd(var3_outdegree)
##all
summary(var3_totaldegree)
sd(var3_totaldegree)

#Closeness 
V(var3)$incloseness <- closeness(var3, mode = "in") #%>% round(6)
V(var3)$outcloseness <- closeness(var3, mode = "out") #%>% round(6)
V(var3)$totalcloseness <- closeness(var3, mode = "total") #%>% round(6)
var3_incloseness<- closeness(var3, mode = "in") #%>% round(6)
var3_outcloseness<- closeness(var3, mode = "out") #%>% round(6)
var3_totalcloseness<- closeness(var3, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var3_incloseness)
sd(var3_incloseness)
##out
summary(var3_outcloseness)
sd(var3_outcloseness)
##all
summary(var3_totalcloseness)
sd(var3_totalcloseness)

#Betweenness
V(var3)$betweenness <- betweenness(var3) %>% round(1)
var3_betweenness <- betweenness(var3) %>% round(1)

#Edge Betweenness
E(var3)$edge.btweenness<-edge.betweenness(var3)
var3_edge.betweenness <-edge.betweenness(var3)

##all
summary(var3_betweenness)
sd(var3_betweenness)

#Eigen_Centrality
V(var3)$eigenvector <- eigen_centrality(var3, directed = TRUE) %$% vector %>% round(3)
var3_eigenvector <- eigen_centrality(var3, directed = TRUE) %$% vector %>% round(3)

#all
summary(var3_eigenvector)
sd(var3_eigenvector)


#PageRank
V(var3)$page.rank<-page.rank(var3)$vector
var3_pr<-page.rank(var3)$vector
#stats
summary(var3_pr)
sd(var3_pr)

#Kleinberg’s authority scores
V(var3)$authority.score<- authority.score(g)$vector
var3_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var3)$hub <- hub.score(g)$vector
var3_hub<- hub.score(g)$vector
#stats
summary(var3_hub)
sd(var3_hub)


#Community detection (betweenness)
var3_edge.betweenness.community <- edge.betweenness.community(var3)
#create communities
V(var3)$edge.betweenness.community <- membership(var3_edge.betweenness.community)
var3_edge.betweenness.community <- membership(var3_edge.betweenness.community)


#Community detection (Random walk)
var3_walktrap.community <- walktrap.community(var3)
#create 10 communities
V(var3)$walktrap.community <- membership(var3_walktrap.community)
var3_walktrap.community <- membership(var3_walktrap.community)


#Shortest Paths
var3_sp_in <- shortest.paths(var3, mode='in')
var3_sp_out <- shortest.paths(var3, mode='out')

#in
mean(var3_sp_in[which(var3_sp_in != Inf)])
sd(var3_sp_in[which(var3_sp_in != Inf)])
#out
mean(var3_sp_out[which(var3_sp_out != Inf)])
sd(var3_sp_out[which(var3_sp_out != Inf)])

#Reachability
var3_reach_in <- reachability(var3, 'in')
var3_reach_out <- reachability(var3, 'out')

#in
mean(var3_reach_in[which(var3_reach_in != Inf)])
sd(var3_reach_in[which(var3_reach_in != Inf)])
#out
mean(var3_reach_out[which(var3_reach_out != Inf)])
sd(var3_reach_out[which(var3_reach_out != Inf)])

# Density 
graph.density(var3)

# Reciprocity
reciprocity(var3)

# Transitivity
transitivity(var3)

#Diameter
diameter(var3)
get.diameter(var3)

#Maximal Independence Vertex Sets
#independence.number(var3)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var3 <- triad.census(var3)
triad_df_var3 <- data.frame(census_labels,tc_var3)
triad_df_var3
write.csv(triad_df_var3, 'var3_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var3_sp_in_vec <- vector()
var3_sp_out_vec <- vector()
var3_reach_in_vec <- vector()
var3_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var3))
  var3_reach_in_vec[i] <- mean(var3_reach_in[i,])
  V(var3)$var3_reach_in_vec[i] <- mean(var3_reach_in[i,]) #adding to igraph object
  
  var3_reach_out_vec[i] <- mean(var3_reach_out[i,])
  V(var3)$var3_reach_out_vec[i] <- mean(var3_reach_out[i,]) #adding to igraph object
  
  var3_shortest.paths.in_vec[i] <- mean(var3_sp_in[i,])
  V(var3)$var3_shortest.paths.in_vec[i] <- mean(var3_sp_in[i,]) #adding to igraph object
  
  var3_shortest.paths.out_vec[i] <- mean(var3_sp_out[i,])
  V(var3)$var3_shortest.paths.out_vec[i] <- mean(var3_sp_out[i,]) #adding to igraph object


var3_node_stats_df <- cbind(
var3_indegree,
var3_outdegree,
var3_totaldegree,
var3_incloseness,
var3_outcloseness,
var3_totalcloseness,
var3_betweenness,
var3_eigenvector,
var3_reach_in_vec, 
var3_reach_out_vec, 
var3_sp_in_vec, 
var3_sp_out_vec)

write.csv(var3_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var3_node_stats_df.csv")


#Grafo var3

teste =as.numeric(get.vertex.attribute(var3,"totaldegree"))


plot(var3, 
     layout=layout.fruchterman.reingold(var3), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var3,"color"), 
     vertex.label=get.vertex.attribute(var3,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var3)/1000,
     main="COORDENAÇÃO CONJUNTA DE CASOS")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var3,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var3,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(var3)


plot(var3, 
     layout=layout.fruchterman.reingold(var3),
     vertex.size=degree(var3)/70,
     vertex.color=get.vertex.attribute(var3,"color"), 
     vertex.label=get.vertex.attribute(var3,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="COORDENAÇÃO CONJUNTA DE CASOS")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var3,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var3,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Decompose Graph - get connected components 
dg <- decompose.graph(var3)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var3)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var3)
```

#Descriptive Analysis for var4 "PROGRAMAS EM CONJUNTO",
```{r}
#Vertices and Edges Number
vcount(var4)
ecount(var4)

#Centrality Degree  
V(var4)$indegree<-degree(var4, mode = "in")
V(var4)$outdegree <- degree(var4, mode = "out")
V(var4)$totaldegree <- degree(var4, mode = "total")


var4_indegree<-degree(var4, mode = "in")
var4_outdegree<-degree(var4, mode = "out")
var4_totaldegree<-degree(var4, mode = "total")

#Histogram var4 degree
hist(degree(var4))

# Centrality Degree Descriptive Statistics

##in
summary(var4_indegree)
sd(var4_indegree)
##out
summary(var4_outdegree)
sd(var4_outdegree)
##all
summary(var4_totaldegree)
sd(var4_totaldegree)

#Closeness 
V(var4)$incloseness <- closeness(var4, mode = "in") #%>% round(6)
V(var4)$outcloseness <- closeness(var4, mode = "out") #%>% round(6)
V(var4)$totalcloseness <- closeness(var4, mode = "total") #%>% round(6)
var4_incloseness<- closeness(var4, mode = "in") #%>% round(6)
var4_outcloseness<- closeness(var4, mode = "out") #%>% round(6)
var4_totalcloseness<- closeness(var4, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var4_incloseness)
sd(var4_incloseness)
##out
summary(var4_outcloseness)
sd(var4_outcloseness)
##all
summary(var4_totalcloseness)
sd(var4_totalcloseness)

#Betweenness
V(var4)$betweenness <- betweenness(var4) %>% round(1)
var4_betweenness <- betweenness(var4) %>% round(1)

#Edge Betweenness
E(var4)$edge.btweenness<-edge.betweenness(var4)
var4_edge.betweenness <-edge.betweenness(var4)

##all
summary(var4_betweenness)
sd(var4_betweenness)

#Eigen_Centrality
V(var4)$eigenvector <- eigen_centrality(var4, directed = TRUE) %$% vector %>% round(3)
var4_eigenvector <- eigen_centrality(var4, directed = TRUE) %$% vector %>% round(3)

#all
summary(var4_eigenvector)
sd(var4_eigenvector)


#PageRank
V(var4)$page.rank<-page.rank(var4)$vector
var4_pr<-page.rank(var4)$vector
#stats
summary(var4_pr)
sd(var4_pr)

#Kleinberg’s authority scores
V(var4)$authority.score<- authority.score(g)$vector
var4_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var4)$hub <- hub.score(g)$vector
var4_hub<- hub.score(g)$vector
#stats
summary(var4_hub)
sd(var4_hub)


#Community detection (betweenness)
var4_edge.betweenness.community <- edge.betweenness.community(var4)
#create communities
V(var4)$edge.betweenness.community <- membership(var4_edge.betweenness.community)
var4_edge.betweenness.community <- membership(var4_edge.betweenness.community)


#Community detection (Random walk)
var4_walktrap.community <- walktrap.community(var4)
#create 10 communities
V(var4)$walktrap.community <- membership(var4_walktrap.community)
var4_walktrap.community <- membership(var4_walktrap.community)


#Shortest Paths
var4_sp_in <- shortest.paths(var4, mode='in')
var4_sp_out <- shortest.paths(var4, mode='out')

#in
mean(var4_sp_in[which(var4_sp_in != Inf)])
sd(var4_sp_in[which(var4_sp_in != Inf)])
#out
mean(var4_sp_out[which(var4_sp_out != Inf)])
sd(var4_sp_out[which(var4_sp_out != Inf)])

#Reachability
var4_reach_in <- reachability(var4, 'in')
var4_reach_out <- reachability(var4, 'out')

#in
mean(var4_reach_in[which(var4_reach_in != Inf)])
sd(var4_reach_in[which(var4_reach_in != Inf)])
#out
mean(var4_reach_out[which(var4_reach_out != Inf)])
sd(var4_reach_out[which(var4_reach_out != Inf)])

# Density 
graph.density(var4)

# Reciprocity
reciprocity(var4)

# Transitivity
transitivity(var4)

#Diameter
diameter(var4)
get.diameter(var4)

#Maximal Independence Vertex Sets
#independence.number(var4)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var4 <- triad.census(var4)
triad_df_var4 <- data.frame(census_labels,tc_var4)
triad_df_var4
write.csv(triad_df_var4, 'var4_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var4_sp_in_vec <- vector()
var4_sp_out_vec <- vector()
var4_reach_in_vec <- vector()
var4_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var4))
  var4_reach_in_vec[i] <- mean(var4_reach_in[i,])
  V(var4)$var4_reach_in_vec[i] <- mean(var4_reach_in[i,]) #adding to igraph object
  
  var4_reach_out_vec[i] <- mean(var4_reach_out[i,])
  V(var4)$var4_reach_out_vec[i] <- mean(var4_reach_out[i,]) #adding to igraph object
  
  var4_shortest.paths.in_vec[i] <- mean(var4_sp_in[i,])
  V(var4)$var4_shortest.paths.in_vec[i] <- mean(var4_sp_in[i,]) #adding to igraph object
  
  var4_shortest.paths.out_vec[i] <- mean(var4_sp_out[i,])
  V(var4)$var4_shortest.paths.out_vec[i] <- mean(var4_sp_out[i,]) #adding to igraph object


var4_node_stats_df <- cbind(
var4_indegree,
var4_outdegree,
var4_totaldegree,
var4_incloseness,
var4_outcloseness,
var4_totalcloseness,
var4_betweenness,
var4_eigenvector,
var4_reach_in_vec, 
var4_reach_out_vec, 
var4_sp_in_vec, 
var4_sp_out_vec)

write.csv(var4_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var4_node_stats_df.csv")


#Grafo var4

teste =as.numeric(get.vertex.attribute(var4,"totaldegree"))


plot(var4, 
     layout=layout.fruchterman.reingold(var4), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var4,"color"), 
     vertex.label=get.vertex.attribute(var4,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var4)/1000,
     main="PROGRAMAS EM CONJUNTO")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var4,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var4,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(var4)


plot(var4, 
     layout=layout.fruchterman.reingold(var4),
     vertex.size=degree(var4)/70,
     vertex.color=get.vertex.attribute(var4,"color"), 
     vertex.label=get.vertex.attribute(var4,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="PROGRAMAS EM CONJUNTO")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var4,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var4,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Decompose Graph - get connected components 
dg <- decompose.graph(var4)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var4)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var4)
```

#Descriptive Analysis for var5 "OFERTA DE TREINAMENTOS/CAPACITAÇÕES",
```{r}
#Vertices and Edges Number
vcount(var5)
ecount(var5)

#Centrality Degree  
V(var5)$indegree<-degree(var5, mode = "in")
V(var5)$outdegree <- degree(var5, mode = "out")
V(var5)$totaldegree <- degree(var5, mode = "total")


var5_indegree<-degree(var5, mode = "in")
var5_outdegree<-degree(var5, mode = "out")
var5_totaldegree<-degree(var5, mode = "total")

#Histogram var5 degree
hist(degree(var5))

# Centrality Degree Descriptive Statistics

##in
summary(var5_indegree)
sd(var5_indegree)
##out
summary(var5_outdegree)
sd(var5_outdegree)
##all
summary(var5_totaldegree)
sd(var5_totaldegree)

#Closeness 
V(var5)$incloseness <- closeness(var5, mode = "in") #%>% round(6)
V(var5)$outcloseness <- closeness(var5, mode = "out") #%>% round(6)
V(var5)$totalcloseness <- closeness(var5, mode = "total") #%>% round(6)
var5_incloseness<- closeness(var5, mode = "in") #%>% round(6)
var5_outcloseness<- closeness(var5, mode = "out") #%>% round(6)
var5_totalcloseness<- closeness(var5, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var5_incloseness)
sd(var5_incloseness)
##out
summary(var5_outcloseness)
sd(var5_outcloseness)
##all
summary(var5_totalcloseness)
sd(var5_totalcloseness)

#Betweenness
V(var5)$betweenness <- betweenness(var5) %>% round(1)
var5_betweenness <- betweenness(var5) %>% round(1)

#Edge Betweenness
E(var5)$edge.btweenness<-edge.betweenness(var5)
var5_edge.betweenness <-edge.betweenness(var5)

##all
summary(var5_betweenness)
sd(var5_betweenness)

#Eigen_Centrality
V(var5)$eigenvector <- eigen_centrality(var5, directed = TRUE) %$% vector %>% round(3)
var5_eigenvector <- eigen_centrality(var5, directed = TRUE) %$% vector %>% round(3)

#all
summary(var5_eigenvector)
sd(var5_eigenvector)


#PageRank
V(var5)$page.rank<-page.rank(var5)$vector
var5_pr<-page.rank(var5)$vector
#stats
summary(var5_pr)
sd(var5_pr)

#Kleinberg’s authority scores
V(var5)$authority.score<- authority.score(g)$vector
var5_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var5)$hub <- hub.score(g)$vector
var5_hub<- hub.score(g)$vector
#stats
summary(var5_hub)
sd(var5_hub)


#Community detection (betweenness)
var5_edge.betweenness.community <- edge.betweenness.community(var5)
#create communities
V(var5)$edge.betweenness.community <- membership(var5_edge.betweenness.community)
var5_edge.betweenness.community <- membership(var5_edge.betweenness.community)


#Community detection (Random walk)
var5_walktrap.community <- walktrap.community(var5)
#create 10 communities
V(var5)$walktrap.community <- membership(var5_walktrap.community)
var5_walktrap.community <- membership(var5_walktrap.community)


#Shortest Paths
var5_sp_in <- shortest.paths(var5, mode='in')
var5_sp_out <- shortest.paths(var5, mode='out')

#in
mean(var5_sp_in[which(var5_sp_in != Inf)])
sd(var5_sp_in[which(var5_sp_in != Inf)])
#out
mean(var5_sp_out[which(var5_sp_out != Inf)])
sd(var5_sp_out[which(var5_sp_out != Inf)])

#Reachability
var5_reach_in <- reachability(var5, 'in')
var5_reach_out <- reachability(var5, 'out')

#in
mean(var5_reach_in[which(var5_reach_in != Inf)])
sd(var5_reach_in[which(var5_reach_in != Inf)])
#out
mean(var5_reach_out[which(var5_reach_out != Inf)])
sd(var5_reach_out[which(var5_reach_out != Inf)])

# Density 
graph.density(var5)

# Reciprocity
reciprocity(var5)

# Transitivity
transitivity(var5)

#Diameter
diameter(var5)
get.diameter(var5)

#Maximal Independence Vertex Sets
#independence.number(var5)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var5 <- triad.census(var5)
triad_df_var5 <- data.frame(census_labels,tc_var5)
triad_df_var5
write.csv(triad_df_var5, 'var5_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var5_sp_in_vec <- vector()
var5_sp_out_vec <- vector()
var5_reach_in_vec <- vector()
var5_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var5))
  var5_reach_in_vec[i] <- mean(var5_reach_in[i,])
  V(var5)$var5_reach_in_vec[i] <- mean(var5_reach_in[i,]) #adding to igraph object
  
  var5_reach_out_vec[i] <- mean(var5_reach_out[i,])
  V(var5)$var5_reach_out_vec[i] <- mean(var5_reach_out[i,]) #adding to igraph object
  
  var5_shortest.paths.in_vec[i] <- mean(var5_sp_in[i,])
  V(var5)$var5_shortest.paths.in_vec[i] <- mean(var5_sp_in[i,]) #adding to igraph object
  
  var5_shortest.paths.out_vec[i] <- mean(var5_sp_out[i,])
  V(var5)$var5_shortest.paths.out_vec[i] <- mean(var5_sp_out[i,]) #adding to igraph object


var5_node_stats_df <- cbind(
var5_indegree,
var5_outdegree,
var5_totaldegree,
var5_incloseness,
var5_outcloseness,
var5_totalcloseness,
var5_betweenness,
var5_eigenvector,
var5_reach_in_vec, 
var5_reach_out_vec, 
var5_sp_in_vec, 
var5_sp_out_vec)

write.csv(var5_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var5_node_stats_df.csv")


#Grafo var5

teste =as.numeric(get.vertex.attribute(var5,"totaldegree"))


plot(var5, 
     layout=layout.fruchterman.reingold(var5), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var5,"color"), 
     vertex.label=get.vertex.attribute(var5,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var5)/1000,
     main="OFERTA DE TREINAMENTOS/CAPACITAÇÕES")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var5,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var5,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(var5)


plot(var5, 
     layout=layout.fruchterman.reingold(var5),
     vertex.size=degree(var5)/70,
     vertex.color=get.vertex.attribute(var5,"color"), 
     vertex.label=get.vertex.attribute(var5,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="OFERTA DE TREINAMENTOS/CAPACITAÇÕES")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var5,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var5,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Decompose Graph - get connected components 
dg <- decompose.graph(var5)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var5)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var5)
```

#Descriptive Analysis for var6 "RECEBER TREINAMENTOS/CAPACITAÇÕES",
```{r}
#Vertices and Edges Number
vcount(var6)
ecount(var6)

#Centrality Degree  
V(var6)$indegree<-degree(var6, mode = "in")
V(var6)$outdegree <- degree(var6, mode = "out")
V(var6)$totaldegree <- degree(var6, mode = "total")


var6_indegree<-degree(var6, mode = "in")
var6_outdegree<-degree(var6, mode = "out")
var6_totaldegree<-degree(var6, mode = "total")

#Histogram var6 degree
hist(degree(var6))

# Centrality Degree Descriptive Statistics

##in
summary(var6_indegree)
sd(var6_indegree)
##out
summary(var6_outdegree)
sd(var6_outdegree)
##all
summary(var6_totaldegree)
sd(var6_totaldegree)

#Closeness 
V(var6)$incloseness <- closeness(var6, mode = "in") #%>% round(6)
V(var6)$outcloseness <- closeness(var6, mode = "out") #%>% round(6)
V(var6)$totalcloseness <- closeness(var6, mode = "total") #%>% round(6)
var6_incloseness<- closeness(var6, mode = "in") #%>% round(6)
var6_outcloseness<- closeness(var6, mode = "out") #%>% round(6)
var6_totalcloseness<- closeness(var6, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var6_incloseness)
sd(var6_incloseness)
##out
summary(var6_outcloseness)
sd(var6_outcloseness)
##all
summary(var6_totalcloseness)
sd(var6_totalcloseness)

#Betweenness
V(var6)$betweenness <- betweenness(var6) %>% round(1)
var6_betweenness <- betweenness(var6) %>% round(1)

#Edge Betweenness
E(var6)$edge.btweenness<-edge.betweenness(var6)
var6_edge.betweenness <-edge.betweenness(var6)

##all
summary(var6_betweenness)
sd(var6_betweenness)

#Eigen_Centrality
V(var6)$eigenvector <- eigen_centrality(var6, directed = TRUE) %$% vector %>% round(3)
var6_eigenvector <- eigen_centrality(var6, directed = TRUE) %$% vector %>% round(3)

#all
summary(var6_eigenvector)
sd(var6_eigenvector)


#PageRank
V(var6)$page.rank<-page.rank(var6)$vector
var6_pr<-page.rank(var6)$vector
#stats
summary(var6_pr)
sd(var6_pr)

#Kleinberg’s authority scores
V(var6)$authority.score<- authority.score(g)$vector
var6_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(var6)$hub <- hub.score(g)$vector
var6_hub<- hub.score(g)$vector
#stats
summary(var6_hub)
sd(var6_hub)


#Community detection (betweenness)
var6_edge.betweenness.community <- edge.betweenness.community(var6)
#create communities
V(var6)$edge.betweenness.community <- membership(var6_edge.betweenness.community)
var6_edge.betweenness.community <- membership(var6_edge.betweenness.community)


#Community detection (Random walk)
var6_walktrap.community <- walktrap.community(var6)
#create 10 communities
V(var6)$walktrap.community <- membership(var6_walktrap.community)
var6_walktrap.community <- membership(var6_walktrap.community)


#Shortest Paths
var6_sp_in <- shortest.paths(var6, mode='in')
var6_sp_out <- shortest.paths(var6, mode='out')

#in
mean(var6_sp_in[which(var6_sp_in != Inf)])
sd(var6_sp_in[which(var6_sp_in != Inf)])
#out
mean(var6_sp_out[which(var6_sp_out != Inf)])
sd(var6_sp_out[which(var6_sp_out != Inf)])

#Reachability
var6_reach_in <- reachability(var6, 'in')
var6_reach_out <- reachability(var6, 'out')

#in
mean(var6_reach_in[which(var6_reach_in != Inf)])
sd(var6_reach_in[which(var6_reach_in != Inf)])
#out
mean(var6_reach_out[which(var6_reach_out != Inf)])
sd(var6_reach_out[which(var6_reach_out != Inf)])

# Density 
graph.density(var6)

# Reciprocity
reciprocity(var6)

# Transitivity
transitivity(var6)

#Diameter
diameter(var6)
get.diameter(var6)

#Maximal Independence Vertex Sets
#independence.number(var6)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var6 <- triad.census(var6)
triad_df_var6 <- data.frame(census_labels,tc_var6)
triad_df_var6
write.csv(triad_df_var6, 'var6_complet_triads.csv')


#Creating Vectors to pass means for each vertex

var6_sp_in_vec <- vector()
var6_sp_out_vec <- vector()
var6_reach_in_vec <- vector()
var6_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var6))
  var6_reach_in_vec[i] <- mean(var6_reach_in[i,])
  V(var6)$var6_reach_in_vec[i] <- mean(var6_reach_in[i,]) #adding to igraph object
  
  var6_reach_out_vec[i] <- mean(var6_reach_out[i,])
  V(var6)$var6_reach_out_vec[i] <- mean(var6_reach_out[i,]) #adding to igraph object
  
  var6_shortest.paths.in_vec[i] <- mean(var6_sp_in[i,])
  V(var6)$var6_shortest.paths.in_vec[i] <- mean(var6_sp_in[i,]) #adding to igraph object
  
  var6_shortest.paths.out_vec[i] <- mean(var6_sp_out[i,])
  V(var6)$var6_shortest.paths.out_vec[i] <- mean(var6_sp_out[i,]) #adding to igraph object


var6_node_stats_df <- cbind(
var6_indegree,
var6_outdegree,
var6_totaldegree,
var6_incloseness,
var6_outcloseness,
var6_totalcloseness,
var6_betweenness,
var6_eigenvector,
var6_reach_in_vec, 
var6_reach_out_vec, 
var6_sp_in_vec, 
var6_sp_out_vec)

write.csv(var6_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var6_node_stats_df.csv")


#Grafo var6

teste =as.numeric(get.vertex.attribute(var6,"totaldegree"))


plot(var6, 
     layout=layout.fruchterman.reingold(var6), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(var6,"color"), 
     vertex.label=get.vertex.attribute(var6,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(var6)/1000,
     main="RECEBER TREINAMENTOS/CAPACITAÇÕES")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var6,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var6,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(var6)


plot(var6, 
     layout=layout.fruchterman.reingold(var6),
     vertex.size=degree(var6)/70,
     vertex.color=get.vertex.attribute(var6,"color"), 
     vertex.label=get.vertex.attribute(var6,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="RECEBER TREINAMENTOS/CAPACITAÇÕES")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(var6,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(var6,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Decompose Graph - get connected components 
dg <- decompose.graph(var6)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(var6)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(var6)
```

#Descriptive Analysis for atividade "Atividades",
```{r}
#Vertices and Edges Number
vcount(atividade)
ecount(atividade)

#Centrality Degree  
V(atividade)$indegree<-degree(atividade, mode = "in")
V(atividade)$outdegree <- degree(atividade, mode = "out")
V(atividade)$totaldegree <- degree(atividade, mode = "total")


atividade_indegree<-degree(atividade, mode = "in")
atividade_outdegree<-degree(atividade, mode = "out")
atividade_totaldegree<-degree(atividade, mode = "total")

#Histogram atividade degree
hist(degree(atividade))

# Centrality Degree Descriptive Statistics

##in
summary(atividade_indegree)
sd(atividade_indegree)
##out
summary(atividade_outdegree)
sd(atividade_outdegree)
##all
summary(atividade_totaldegree)
sd(atividade_totaldegree)

#Closeness 
V(atividade)$incloseness <- closeness(atividade, mode = "in") #%>% round(6)
V(atividade)$outcloseness <- closeness(atividade, mode = "out") #%>% round(6)
V(atividade)$totalcloseness <- closeness(atividade, mode = "total") #%>% round(6)
atividade_incloseness<- closeness(atividade, mode = "in") #%>% round(6)
atividade_outcloseness<- closeness(atividade, mode = "out") #%>% round(6)
atividade_totalcloseness<- closeness(atividade, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(atividade_incloseness)
sd(atividade_incloseness)
##out
summary(atividade_outcloseness)
sd(atividade_outcloseness)
##all
summary(atividade_totalcloseness)
sd(atividade_totalcloseness)

#Betweenness
V(atividade)$betweenness <- betweenness(atividade) %>% round(1)
atividade_betweenness <- betweenness(atividade) %>% round(1)

#Edge Betweenness
E(atividade)$edge.btweenness<-edge.betweenness(atividade)
atividade_edge.betweenness <-edge.betweenness(atividade)

##all
summary(atividade_betweenness)
sd(atividade_betweenness)

#Eigen_Centrality
V(atividade)$eigenvector <- eigen_centrality(atividade, directed = TRUE) %$% vector %>% round(3)
atividade_eigenvector <- eigen_centrality(atividade, directed = TRUE) %$% vector %>% round(3)

#all
summary(atividade_eigenvector)
sd(atividade_eigenvector)


#PageRank
V(atividade)$page.rank<-page.rank(atividade)$vector
atividade_pr<-page.rank(atividade)$vector
#stats
summary(atividade_pr)
sd(atividade_pr)

#Kleinberg’s authority scores
V(atividade)$authority.score<- authority.score(g)$vector
atividade_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(atividade)$hub <- hub.score(g)$vector
atividade_hub<- hub.score(g)$vector
#stats
summary(atividade_hub)
sd(atividade_hub)


#Community detection (betweenness)
atividade_edge.betweenness.community <- edge.betweenness.community(atividade)
#create communities
V(atividade)$edge.betweenness.community <- membership(atividade_edge.betweenness.community)
atividade_edge.betweenness.community <- membership(atividade_edge.betweenness.community)


#Community detection (Random walk)
atividade_walktrap.community <- walktrap.community(atividade)
#create 10 communities
V(atividade)$walktrap.community <- membership(atividade_walktrap.community)
atividade_walktrap.community <- membership(atividade_walktrap.community)


#Shortest Paths
atividade_sp_in <- shortest.paths(atividade, mode='in')
atividade_sp_out <- shortest.paths(atividade, mode='out')

#in
mean(atividade_sp_in[which(atividade_sp_in != Inf)])
sd(atividade_sp_in[which(atividade_sp_in != Inf)])
#out
mean(atividade_sp_out[which(atividade_sp_out != Inf)])
sd(atividade_sp_out[which(atividade_sp_out != Inf)])

#Reachability
atividade_reach_in <- reachability(atividade, 'in')
atividade_reach_out <- reachability(atividade, 'out')

#in
mean(atividade_reach_in[which(atividade_reach_in != Inf)])
sd(atividade_reach_in[which(atividade_reach_in != Inf)])
#out
mean(atividade_reach_out[which(atividade_reach_out != Inf)])
sd(atividade_reach_out[which(atividade_reach_out != Inf)])

# Density 
graph.density(atividade)

# Reciprocity
reciprocity(atividade)

# Transitivity
transitivity(atividade)

#Diameter
diameter(atividade)
get.diameter(atividade)

#Maximal Independence Vertex Sets
#independence.number(atividade)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_atividade <- triad.census(atividade)
triad_df_atividade <- data.frame(census_labels,tc_atividade)
triad_df_atividade
write.csv(triad_df_atividade, 'atividade_complet_triads.csv')


#Creating Vectors to pass means for each vertex

atividade_sp_in_vec <- vector()
atividade_sp_out_vec <- vector()
atividade_reach_in_vec <- vector()
atividade_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(atividade))
  atividade_reach_in_vec[i] <- mean(atividade_reach_in[i,])
  V(atividade)$atividade_reach_in_vec[i] <- mean(atividade_reach_in[i,]) #adding to igraph object
  
  atividade_reach_out_vec[i] <- mean(atividade_reach_out[i,])
  V(atividade)$atividade_reach_out_vec[i] <- mean(atividade_reach_out[i,]) #adding to igraph object
  
  atividade_shortest.paths.in_vec[i] <- mean(atividade_sp_in[i,])
  V(atividade)$atividade_shortest.paths.in_vec[i] <- mean(atividade_sp_in[i,]) #adding to igraph object
  
  atividade_shortest.paths.out_vec[i] <- mean(atividade_sp_out[i,])
  V(atividade)$atividade_shortest.paths.out_vec[i] <- mean(atividade_sp_out[i,]) #adding to igraph object


atividade_node_stats_df <- cbind(
atividade_indegree,
atividade_outdegree,
atividade_totaldegree,
atividade_incloseness,
atividade_outcloseness,
atividade_totalcloseness,
atividade_betweenness,
atividade_eigenvector,
atividade_reach_in_vec, 
atividade_reach_out_vec, 
atividade_sp_in_vec, 
atividade_sp_out_vec)

write.csv(atividade_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/atividade_node_stats_df.csv")


#Grafo atividade

teste =as.numeric(get.vertex.attribute(atividade,"totaldegree"))


plot(atividade, 
     layout=layout.fruchterman.reingold(atividade), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(atividade,"color"), 
     vertex.label=get.vertex.attribute(atividade,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(atividade)/1000,
     main="Atividade")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(atividade,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(atividade,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(atividade)


plot(atividade, 
     layout=layout.fruchterman.reingold(atividade),
     vertex.size=degree(atividade)/70,
     vertex.color=get.vertex.attribute(atividade,"color"), 
     vertex.label=get.vertex.attribute(atividade,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="Atividade")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(atividade,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(atividade,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Decompose Graph - get connected components 
dg <- decompose.graph(atividade)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(atividade)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(atividade)
```

#Descriptive Analysis for acesso "Acesso",
```{r}
#Vertices and Edges Number
vcount(acesso)
ecount(acesso)

#Centrality Degree  
V(acesso)$indegree<-degree(acesso, mode = "in")
V(acesso)$outdegree <- degree(acesso, mode = "out")
V(acesso)$totaldegree <- degree(acesso, mode = "total")


acesso_indegree<-degree(acesso, mode = "in")
acesso_outdegree<-degree(acesso, mode = "out")
acesso_totaldegree<-degree(acesso, mode = "total")

#Histogram acesso degree
hist(degree(acesso))

# Centrality Degree Descriptive Statistics

##in
summary(acesso_indegree)
sd(acesso_indegree)
##out
summary(acesso_outdegree)
sd(acesso_outdegree)
##all
summary(acesso_totaldegree)
sd(acesso_totaldegree)

#Closeness 
V(acesso)$incloseness <- closeness(acesso, mode = "in") #%>% round(6)
V(acesso)$outcloseness <- closeness(acesso, mode = "out") #%>% round(6)
V(acesso)$totalcloseness <- closeness(acesso, mode = "total") #%>% round(6)
acesso_incloseness<- closeness(acesso, mode = "in") #%>% round(6)
acesso_outcloseness<- closeness(acesso, mode = "out") #%>% round(6)
acesso_totalcloseness<- closeness(acesso, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(acesso_incloseness)
sd(acesso_incloseness)
##out
summary(acesso_outcloseness)
sd(acesso_outcloseness)
##all
summary(acesso_totalcloseness)
sd(acesso_totalcloseness)

#Betweenness
V(acesso)$betweenness <- betweenness(acesso) %>% round(1)
acesso_betweenness <- betweenness(acesso) %>% round(1)

#Edge Betweenness
E(acesso)$edge.btweenness<-edge.betweenness(acesso)
acesso_edge.betweenness <-edge.betweenness(acesso)

##all
summary(acesso_betweenness)
sd(acesso_betweenness)

#Eigen_Centrality
V(acesso)$eigenvector <- eigen_centrality(acesso, directed = TRUE) %$% vector %>% round(3)
acesso_eigenvector <- eigen_centrality(acesso, directed = TRUE) %$% vector %>% round(3)

#all
summary(acesso_eigenvector)
sd(acesso_eigenvector)


#PageRank
V(acesso)$page.rank<-page.rank(acesso)$vector
acesso_pr<-page.rank(acesso)$vector
#stats
summary(acesso_pr)
sd(acesso_pr)

#Kleinberg’s authority scores
V(acesso)$authority.score<- authority.score(g)$vector
acesso_auth <- authority.score(g)$vector

#Kleinberg’s hub scores
V(acesso)$hub <- hub.score(g)$vector
acesso_hub<- hub.score(g)$vector
#stats
summary(acesso_hub)
sd(acesso_hub)


#Community detection (betweenness)
acesso_edge.betweenness.community <- edge.betweenness.community(acesso)
#create communities
V(acesso)$edge.betweenness.community <- membership(acesso_edge.betweenness.community)
acesso_edge.betweenness.community <- membership(acesso_edge.betweenness.community)


#Community detection (Random walk)
acesso_walktrap.community <- walktrap.community(acesso)
#create 10 communities
V(acesso)$walktrap.community <- membership(acesso_walktrap.community)
acesso_walktrap.community <- membership(acesso_walktrap.community)


#Shortest Paths
acesso_sp_in <- shortest.paths(acesso, mode='in')
acesso_sp_out <- shortest.paths(acesso, mode='out')

#in
mean(acesso_sp_in[which(acesso_sp_in != Inf)])
sd(acesso_sp_in[which(acesso_sp_in != Inf)])
#out
mean(acesso_sp_out[which(acesso_sp_out != Inf)])
sd(acesso_sp_out[which(acesso_sp_out != Inf)])

#Reachability
acesso_reach_in <- reachability(acesso, 'in')
acesso_reach_out <- reachability(acesso, 'out')

#in
mean(acesso_reach_in[which(acesso_reach_in != Inf)])
sd(acesso_reach_in[which(acesso_reach_in != Inf)])
#out
mean(acesso_reach_out[which(acesso_reach_out != Inf)])
sd(acesso_reach_out[which(acesso_reach_out != Inf)])

# Density 
graph.density(acesso)

# Reciprocity
reciprocity(acesso)

# Transitivity
transitivity(acesso)

#Diameter
diameter(acesso)
get.diameter(acesso)

#Maximal Independence Vertex Sets
#independence.number(acesso)


#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_acesso <- triad.census(acesso)
triad_df_acesso <- data.frame(census_labels,tc_acesso)
triad_df_acesso
write.csv(triad_df_acesso, 'acesso_complet_triads.csv')


#Creating Vectors to pass means for each vertex

acesso_sp_in_vec <- vector()
acesso_sp_out_vec <- vector()
acesso_reach_in_vec <- vector()
acesso_reach_out_vec <- vector()

#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(acesso))
  acesso_reach_in_vec[i] <- mean(acesso_reach_in[i,])
  V(acesso)$acesso_reach_in_vec[i] <- mean(acesso_reach_in[i,]) #adding to igraph object
  
  acesso_reach_out_vec[i] <- mean(acesso_reach_out[i,])
  V(acesso)$acesso_reach_out_vec[i] <- mean(acesso_reach_out[i,]) #adding to igraph object
  
  acesso_shortest.paths.in_vec[i] <- mean(acesso_sp_in[i,])
  V(acesso)$acesso_shortest.paths.in_vec[i] <- mean(acesso_sp_in[i,]) #adding to igraph object
  
  acesso_shortest.paths.out_vec[i] <- mean(acesso_sp_out[i,])
  V(acesso)$acesso_shortest.paths.out_vec[i] <- mean(acesso_sp_out[i,]) #adding to igraph object


acesso_node_stats_df <- cbind(
acesso_indegree,
acesso_outdegree,
acesso_totaldegree,
acesso_incloseness,
acesso_outcloseness,
acesso_totalcloseness,
acesso_betweenness,
acesso_eigenvector,
acesso_reach_in_vec, 
acesso_reach_out_vec, 
acesso_sp_in_vec, 
acesso_sp_out_vec)

write.csv(acesso_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/acesso_node_stats_df.csv")


#Grafo acesso

teste =as.numeric(get.vertex.attribute(acesso,"totaldegree"))


plot(acesso, 
     layout=layout.fruchterman.reingold(acesso), 
     vertex.size=(teste)/10,
     vertex.color=get.vertex.attribute(acesso,"color"), 
     vertex.label=get.vertex.attribute(acesso,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     vertex.frame.color=F,
     edge.arrow.size=0.01,
     rescale=TRUE,
     edge.width=edge.betweenness(acesso)/1000,
     main="Acesso")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(acesso,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(acesso,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores

#Find connected components
clusters(acesso)


plot(acesso, 
     layout=layout.fruchterman.reingold(acesso),
     vertex.size=degree(acesso)/70,
     vertex.color=get.vertex.attribute(acesso,"color"), 
     vertex.label=get.vertex.attribute(acesso,"LABEL_COR"),
     vertex.label.color ="black",
     vertex.label.cex=(teste)/500,
     edge.arrow.size=0.01,
     edge.width=0.1,
     main="Acesso")

legend(1, 
       1.25,
       legend =levels(as.factor(get.vertex.attribute(acesso,"LABEL_COR"))), 
       col = levels(as.factor(get.vertex.attribute(acesso,"color"))), 
       lty=1,
       cex = .3) #falta acertar cores


#Decompose Graph - get connected components 
dg <- decompose.graph(acesso)
length(dg)

plot(dg[[1]])
plot(dg[[2]])

#Find Cliques
mc <- maximal.cliques(acesso)
length(mc)

#clique size
sapply(mc, length)
col <- rep("blue", length(V(g)))
#plot the largest (last) click
col[mc[[length(mc)]]] <- "red"
plot(g, layout=layout, vertex.color=col)

#Total 
cliques<-cliques(acesso)
```

#Exporting to Photoshop...Ops Gephi
```{r}
print(igraph.to.gexf(full_no_zero), "~/SNArRDJF/Banco Redes R/Bancos GEXF/full_no_zero.gexf")
print(igraph.to.gexf(var0), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var0.gexf")
print(igraph.to.gexf(var1), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var1.gexf")
print(igraph.to.gexf(var2), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var2.gexf")
print(igraph.to.gexf(var3), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var3.gexf")
print(igraph.to.gexf(var4), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var4.gexf")
print(igraph.to.gexf(var5), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var5.gexf")
print(igraph.to.gexf(var6), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var6.gexf")
print(igraph.to.gexf(var7), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var7.gexf")
print(igraph.to.gexf(var8), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var8.gexf")
print(igraph.to.gexf(var9), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var9.gexf")
print(igraph.to.gexf(var10), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var10.gexf")
print(igraph.to.gexf(var11), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var11.gexf")
print(igraph.to.gexf(var12), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var12.gexf")
print(igraph.to.gexf(var13), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var13.gexf")
print(igraph.to.gexf(var14), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var14.gexf")
print(igraph.to.gexf(var15), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var15.gexf")
print(igraph.to.gexf(var16), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var16.gexf")
print(igraph.to.gexf(var17), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var17.gexf")
print(igraph.to.gexf(var18), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var18.gexf")
print(igraph.to.gexf(var19), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var19.gexf")
print(igraph.to.gexf(var20), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var20.gexf")
print(igraph.to.gexf(var21), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var21.gexf")
print(igraph.to.gexf(var22), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var22.gexf")
print(igraph.to.gexf(var23), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var23.gexf")
print(igraph.to.gexf(var24), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var24.gexf")
print(igraph.to.gexf(atividade), "~/SNArRDJF/Banco Redes R/Bancos GEXF/atividade.gexf")
print(igraph.to.gexf(confianca), "~/SNArRDJF/Banco Redes R/Bancos GEXF/confianca.gexf")
print(igraph.to.gexf(acesso), "~/SNArRDJF/Banco Redes R/Bancos GEXF/acesso.gexf")
print(igraph.to.gexf(total), "~/SNArRDJF/Banco Redes R/Bancos GEXF/total.gexf")
```


#CACHE
```{r}
netze <- c(
"full_no_zero",
"var0",
"var1",
"var2",
"var3",
"var4",
"var5",
"var6",
"var7",
"var8",
"var9",
"var10",
"var11",
"var12",
"var13",
"var14",
"var15",
"var16",
"var17",
"var18",
"var19",
"var20",
"var21",
"var22",
"var23",
"var24",
"atividade",
"acesso",
"confianca",
"total")

main <- c("REDE COMPLETA - Sem Zeros",
"RELACIONAMENTO FORMAL",
"REFERENCIA DE ENVIO",
"REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA",
"COORDENAÇÃO CONJUNTA DE CASOS",
"PROGRAMAS EM CONJUNTO",
"OFERTA DE TREINAMENTOS/CAPACITAÇÕES",
"RECEBER TREINAMENTOS/CAPACITAÇÕES",
"ACESSO A) Este serviço mostra-se disponível para realização de ativades em conjunto.",
"ACESSO B) O horário de funcionamento deste serviço possibilita a realização de ações em conjunto.",
"ACESSO C) Este serviço disponibiliza informações sobre suas ativades para o seu serviço.",
"ACESSO D) O seu serviço consegue acessar facilmente informações deste serviço.",
"ACESSO E) Os canais de comunicação com este serviço são suficientes para realização de ações em conjunto.",
"ACESSO F) Seu serviço tem facilade de entrar em contato com este serviço para realizar ativades em conjunto.",
"ACESSO G) O acesso geográfico a este serviço impede a realização de ativades em conjunto.  ",
"ACESSO H) O custo para acessar este serviço impede a realização de ativades em conjunto.",
"ACESSO I) O tempo gasto para acessar este serviço impede a realização ativades em conjunto.",
"CONFIANÇA A) Confia  na qualificação profissional da equipe deste serviço ",
"CONFIANÇA B) Confia  na capacade técnica da equipe deste serviço.",
"CONFIANÇA C) Confia  nas ações realizadas por este serviço.",
"CONFIANÇA D) Confia  em compartilhar informações internas com este serviço. ",
"CONFIANÇA E) Confia nas informações recebas deste serviço.",
"CONFIANÇA F) Confia  em realizar ações conjuntas com este serviço.",
"CONFIANÇA G) Está satisfeito  com as ações desempenhadas por este serviço.",
"CONFIANÇA H) Espera que o relacionamento com este serviço continue nos próximos anos.",
"CONFIANÇA I) Espera que o relacionamento com este serviço se fortaleça nos próximos anos.",
"ATIVIDADE",
"ACESSO",
"CONFIANÇA",
"TOTAL")

```


