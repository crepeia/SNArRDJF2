---
title: "SNA Report"
author: "Leonardo Martins"
date: "13 de julho de 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Final Report - SNA

## 1. Calling Packages
```{r packages, message=TRUE, warning=TRUE}
setwd('~/SNArRDJF/Banco Redes R')
suppressMessages(require(XLConnect))
suppressMessages(require(readxl))
suppressMessages(require(psych))
suppressMessages(require(igraph)) #load package for social network analysis
suppressMessages(require(networkD3)) #load package for sankey network
suppressMessages(library(rgexf))
suppressMessages(library(reshape2))
suppressMessages(library(igraph))
suppressMessages(library(miniCRAN))
suppressMessages(library(magrittr))
suppressMessages(library(keyplayer))
suppressMessages(library(dplyr))
suppressMessages(library(feather))
suppressMessages(library(visNetwork))
suppressMessages(library(knitr))
suppressMessages(library(DT))
suppressMessages(library(stringr))
library(RColorBrewer)
#library(gplots)
#library(sna)
```


##2. Open Excel Data Base
```{r functions, message=FALSE, warning=FALSE, include=FALSE}
# Building read excel allsheets 
read_excel_allsheets <- function(filename) 
{
    sheets <- readxl::excel_sheets(filename)
    x <- lapply(sheets, function(X) readxl::read_excel(filename, sheet = X))
    names(x) <- sheets
    x
}
```

##3. Open each datatable in a different file
```{r, message=FALSE, warning=FALSE, include=FALSE}
setwd('~/SNArRDJF/Base')
#Creating a list with all spreadsheet
mysheets <- read_excel_allsheets("base.xlsx")
```

##4. Creating .csv file for each sheet
```{r pressure, message=FALSE, warning=FALSE, include=FALSE}
setwd('~/SNArRDJF/Banco Redes R/Bancos CSV')
#Creating each .csv file with mysheets names
for (i in names(mysheets)) 
{
    filename = paste(i, ".csv", sep="")
    write.csv2(mysheets[[i]], filename)
}
```

##5. Importing Datasets as R Objects (Basic Functions)
```{r, message=FALSE, warning=FALSE, include=FALSE}
#Importing Dataframe

#Importing Matrix (cleaning invalid cases)
importa_matrix <- function(x)
{
x<-as.matrix(assign(x, read.table(x,sep=";", stringsAsFactors=FALSE, header = T, row.names=2)))[-c(70, 105, 109, 126, 131, 133, 154, 166),-c(1,71, 106, 110, 127, 132, 134, 155, 167)]
}


#Importing Matrix (Auxiliary files)
importa_matrix2 <- function(x)
{
x<-as.matrix(assign(x, read.table(x,sep=";", stringsAsFactors=FALSE, header = T)))[,-c(1)]
}


#Importing Matrix (Importing attributes)
importa_matrix3 <- function(x)
{
x<-as.matrix(assign(x, read.table(x,sep=";", stringsAsFactors=FALSE, header = T, row.names=2)))[-c(70, 105, 109, 126, 131, 133, 154, 166),-c(1)]
}

```
#Importing auxiliary data
```{r, message=FALSE, warning=FALSE, include=FALSE}
Casos_Excluidos_Linha_e_Colun.csv<-importa_matrix2("Casos Excluídos - Linha e Colun.csv")
Dicionário_de_dados_choices.csv<-importa_matrix2("Dicionário de dados - choices.csv")
Dicionário_de_dados_survey.csv<-importa_matrix2("Dicionário de dados - survey.csv")
Dicionário_Matrizes.csv<-importa_matrix2("Dicionário Matrizes.csv")
Nó_simplificado_com_GEOCODE.csv<-importa_matrix2("Nó simplificado com GEOCODE.csv")
Nós_Completo.csv<-importa_matrix2("Nós Completo.csv")
Nós_Simplificado.csv<-importa_matrix2("Nós Simplificado.csv")
attributes_dic.csv<-importa_matrix2("Dicionário de dados - atributos.csv")
```

#Importing Squared Matrix
```{r, message=FALSE, warning=FALSE, include=FALSE}

#B1 Tipo de Relacionamento	B1.1 No último ano com quais TIPOS de serviço o SEU SERVIÇO teve alguma relação/ativade em conjunto referente à atenção aos USUÁRIOS DE DROGAS
Matriz_x2.csv<-importa_matrix("Matriz x2.csv")

#B1 Tipo de Relacionamento	B1.2 – TIPOS DE RELACIONAMENTO - FORMAL. No que se refere à ATENÇÃO aos USUÁRIOS DE DROGAS, você caracteriza como FORMAL o relacionamento que o seu serviço possui com os #serviços a seguir ? Parceria Formal - Feita através de paceria/fluxo institucional devadmente reconheca, por meio de convênios, contratos, ou acordo entre gesotres/secretarias etc.
Matriz_0.csv<-importa_matrix("Matriz 0.csv")

#B2- ATIVADES EM CONJUNTO	B2.1 – TIPOS DE RELACIONAMENTO - REFERENCIA DE ENVIO  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE ENVIO OU ENCAMINHAMENTO DE USUÁRIO DE DROGAS COM OS SERVIÇOS A SEGUIR: #REFERENCIA DE ENVIO - Usuários de Drogas encaminhados a outros serviços da rede
Matriz_1.csv<-importa_matrix("Matriz 1.csv")

#B2- ATIVADES EM CONJUNTO	B2.2 – TIPOS DE RELACIONAMENTO - REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE RECEBIMENTO OU CONTRAREFERENCIA DE USUÁRIO DE #DROGAS COM: REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA  - USUÁRIOS DE DROGAS RECEBOS OU CONTRAREFERENCIADOS DE OUTROS SERVIÇOS DA REDE
Matriz_2.csv<-importa_matrix("Matriz 2.csv")

#B2- ATIVADES EM CONJUNTO	B2.3 – TIPOS DE RELACIONAMENTO  - COORDENAÇÃO CONJUNTA DE CASOS  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE COORDENAÇÃO CONJUNTA DE CASOS REFERENTE AO USO DE DROGAS COM: COORDENAÇÃO #CONJUNTA DE CASOS - COMPARTILHAMENTO DE DADOS E CONDUTAS A RESPEITO DE UM CASO ESPECÍFICO RELACIONADO AO USO DE DROGAS, RESPONSABILADE COMPARTILHADA DE CASOS, TRATAMENTO DE USUÁRIOS DE DROGAS EM CONJUNTO #COM OUTROS SERVIÇOS
Matriz_3.csv<-importa_matrix("Matriz 3.csv")

#B2- ATIVADES EM CONJUNTO	B2.4 – TIPOS DE RELACIONAMENTO - PROGRAMAS EM CONJUNTO - O SEU SERVIÇO MANTÉM ALGUM TIPO DE PROGRAMA EM CONJUNTO REFERENTE AO USO DE DROGAS COM: PROGRAMAS EM CONJUNTO  - #PROGRAMAS E PROJETOS REFERENTES AO USO DE DROGAS DESENVOLVOS EM CONJUNTO COM OUTROS SERVIÇOS
Matriz_4.csv<-importa_matrix("Matriz 4.csv")

#B2- ATIVADES EM CONJUNTO	B2.5 – TIPOS DE RELACIONAMENTO  - OFERTA DE TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ TREINOU OU CAPACITOU ALGUM DOS SERVIÇOS A SEGUIR:  OFERTA #DE TREINAMENTOS/CAPACITAÇÕES  - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE RELACIONADOS AO USO DE DROGAS OFERECOS PARA OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL
Matriz_5.csv<-importa_matrix("Matriz 5.csv")

#B2- ATIVADES EM CONJUNTO	B2.6 – TIPOS DE RELACIONAMENTO  - RECEBER TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ FOI TREINADO OU CAPACITADO POR ALGUM DOS SERVIÇOS A SEGUIR: #RECEBER TREINAMENTOS/CAPACITAÇÕES - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE REFERENTES AO USO DE DROGAS RECEBOS DE OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL 
Matriz_6.csv<-importa_matrix("Matriz 6.csv")

#ACESSO	A) Este serviço mostra-se disponível para realização de ativades em conjunto.
Matriz_7.csv<-importa_matrix("Matriz 7.csv")

#ACESSO	B) O horário de funcionamento deste serviço possibilita a realização de ações em conjunto.
Matriz_8.csv<-importa_matrix("Matriz 8.csv")

#ACESSO	C) Este serviço disponibiliza informações sobre suas ativades para o seu serviço.
Matriz_9.csv<-importa_matrix("Matriz 9.csv")

#ACESSO	D) O seu serviço consegue acessar facilmente informações deste serviço.
Matriz_10.csv<-importa_matrix("Matriz 10.csv")

#ACESSO	E) Os canais de comunicação com este serviço são suficientes para realização de ações em conjunto.
Matriz_11.csv<-importa_matrix("Matriz 11.csv")

#ACESSO	F) Seu serviço tem facilade de entrar em contato com este serviço para realizar ativades em conjunto.
Matriz_12.csv<-importa_matrix("Matriz 12.csv")

#ACESSO	G) O acesso geográfico a este serviço impede a realização de ativades em conjunto.
Matriz_13.csv<-importa_matrix("Matriz 13.csv")

#ACESSO	H) O custo para acessar este serviço impede a realização de ativades em conjunto.
Matriz_14.csv<-importa_matrix("Matriz 14.csv")

#ACESSO	I) O tempo gasto para acessar este serviço impede a realização ativades em conjunto.
Matriz_15.csv<-importa_matrix("Matriz 15.csv")

#CONFIANÇA A) Seu serviço confia  na qualificação profissional da equipe deste serviço 
Matriz_16.csv<-importa_matrix("Matriz 16.csv")

#CONFIANÇA	B) Seu serviço confia  na capacade técnica da equipe deste serviço.
Matriz_17.csv<-importa_matrix("Matriz 17.csv")

#CONFIANÇA C) Seu serviço confia  nas ações realizadas por este serviço.
Matriz_18.csv<-importa_matrix("Matriz 18.csv")

#CONFIANÇA	D) Seu serviço confia  em compartilhar informações internas com este serviço. 
Matriz_19.csv<-importa_matrix("Matriz 19.csv")

#CONFIANÇA	E) Seu serviço confia nas informações recebas deste serviço.
Matriz_20.csv<-importa_matrix("Matriz 20.csv")

#CONFIANÇA	F) Seu serviço confia  em realizar ações conjuntas com este serviço.
Matriz_21.csv<-importa_matrix("Matriz 21.csv")

#CONFIANÇA	G) Seu serviço está satisfeito  com as ações desempenhadas por este serviço.
Matriz_22.csv<-importa_matrix("Matriz 22.csv")

#CONFIANÇA	H) Seu serviço espera que o relacionamento com este serviço continue nos próximos anos.
Matriz_23.csv<-importa_matrix("Matriz 23.csv")

#CONFIANÇA	I) Seu serviço espera que o relacionamento com este 
Matriz_24.csv<-importa_matrix("Matriz 24.csv")

#SOMATÓRIO ATIVIDADE
atividade= as.matrix(`Matriz_1.csv` + `Matriz_2.csv` + `Matriz_3.csv` + `Matriz_4.csv`+ `Matriz_5.csv`+ `Matriz_6.csv`)

#SOMATÓRIO ACESSO
acesso= as.matrix(`Matriz_7.csv` + `Matriz_8.csv` + `Matriz_9.csv` + `Matriz_10.csv`+ `Matriz_11.csv`+ `Matriz_12.csv` + `Matriz_13.csv` + `Matriz_14.csv` + `Matriz_15.csv` + `Matriz_16.csv`)

#SOMATÓRIO CONFIANÇA
confianca=as.matrix(`Matriz_17.csv` + `Matriz_18.csv` + `Matriz_19.csv` + `Matriz_20.csv` + `Matriz_21.csv` + `Matriz_22.csv` + `Matriz_23.csv` + `Matriz_24.csv`)

#SOMATÓRIO TOTAL
total= as.matrix(atividade + acesso + confianca)
```


#Importing Attributes for vertices
```{r, message=FALSE, warning=FALSE, include=FALSE}
attributes.csv<-as.data.frame(importa_matrix3("Atributos.csv"))
attributes.csv$V3_LABEL_ID2=as.character(attributes.csv$V3_LABEL_ID2)
attributes.csv$V3_LABEL_ID2=as.numeric(attributes.csv$V3_LABEL_ID2)
```

#Genenating Igraph Objects
```{r, message=FALSE, warning=FALSE, include=FALSE}
gMatriz_x2.csv<-graph_from_adjacency_matrix(Matriz_x2.csv, mode="directed",weighted=T,diag=F)
gMatriz_0.csv<-graph_from_adjacency_matrix(Matriz_0.csv, mode="directed",weighted=T,diag=F)
gMatriz_1.csv<-graph_from_adjacency_matrix(Matriz_1.csv, mode="directed",weighted=T,diag=F)
gMatriz_2.csv<-graph_from_adjacency_matrix(Matriz_2.csv, mode="directed",weighted=T,diag=F)
gMatriz_3.csv<-graph_from_adjacency_matrix(Matriz_3.csv, mode="directed",weighted=T,diag=F)
gMatriz_4.csv<-graph_from_adjacency_matrix(Matriz_4.csv, mode="directed",weighted=T,diag=F)
gMatriz_5.csv<-graph_from_adjacency_matrix(Matriz_5.csv, mode="directed",weighted=T,diag=F)
gMatriz_6.csv<-graph_from_adjacency_matrix(Matriz_6.csv, mode="directed",weighted=T,diag=F)
gMatriz_7.csv<-graph_from_adjacency_matrix(Matriz_7.csv, mode="directed",weighted=T,diag=F)
gMatriz_8.csv<-graph_from_adjacency_matrix(Matriz_8.csv, mode="directed",weighted=T,diag=F)
gMatriz_9.csv<-graph_from_adjacency_matrix(Matriz_9.csv, mode="directed",weighted=T,diag=F)
gMatriz_10.csv<-graph_from_adjacency_matrix(Matriz_10.csv, mode="directed",weighted=T,diag=F)
gMatriz_11.csv<-graph_from_adjacency_matrix(Matriz_11.csv, mode="directed",weighted=T,diag=F)
gMatriz_12.csv<-graph_from_adjacency_matrix(Matriz_12.csv, mode="directed",weighted=T,diag=F)
gMatriz_13.csv<-graph_from_adjacency_matrix(Matriz_13.csv, mode="directed",weighted=T,diag=F)
gMatriz_14.csv<-graph_from_adjacency_matrix(Matriz_14.csv, mode="directed",weighted=T,diag=F)
gMatriz_15.csv<-graph_from_adjacency_matrix(Matriz_15.csv, mode="directed",weighted=T,diag=F)
gMatriz_16.csv<-graph_from_adjacency_matrix(Matriz_16.csv, mode="directed",weighted=T,diag=F)
gMatriz_17.csv<-graph_from_adjacency_matrix(Matriz_17.csv, mode="directed",weighted=T,diag=F)
gMatriz_18.csv<-graph_from_adjacency_matrix(Matriz_18.csv, mode="directed",weighted=T,diag=F)
gMatriz_19.csv<-graph_from_adjacency_matrix(Matriz_19.csv, mode="directed",weighted=T,diag=F)
gMatriz_20.csv<-graph_from_adjacency_matrix(Matriz_20.csv, mode="directed",weighted=T,diag=F)
gMatriz_21.csv<-graph_from_adjacency_matrix(Matriz_21.csv, mode="directed",weighted=T,diag=F)
gMatriz_22.csv<-graph_from_adjacency_matrix(Matriz_22.csv, mode="directed",weighted=T,diag=F)
gMatriz_23.csv<-graph_from_adjacency_matrix(Matriz_23.csv, mode="directed",weighted=T,diag=F)
gMatriz_24.csv<-graph_from_adjacency_matrix(Matriz_24.csv, mode="directed",weighted=T,diag=F)
gMatriz_atividade.csv<-graph_from_adjacency_matrix(atividade, mode="directed",weighted=T,diag=F)
gMatriz_acesso.csv<-graph_from_adjacency_matrix(acesso, mode="directed",weighted=T,diag=F)
gMatriz_confianca.csv<-graph_from_adjacency_matrix(confianca, mode="directed",weighted=T,diag=F)
gMatriz_total.csv<-graph_from_adjacency_matrix(total, mode="directed",weighted=T,diag=F)
```

#Melting Squared Matrix to List in order to agreggate all lists in one dataframe
```{r, message=FALSE, warning=FALSE, include=FALSE}
gMatriz_x2.txt<-melt(Matriz_x2.csv)
gMatriz_0.txt<-melt(Matriz_0.csv)
gMatriz_1.txt<-melt(Matriz_1.csv)
gMatriz_2.txt<-melt(Matriz_2.csv)
gMatriz_3.txt<-melt(Matriz_3.csv)
gMatriz_4.txt<-melt(Matriz_4.csv)
gMatriz_5.txt<-melt(Matriz_5.csv)
gMatriz_6.txt<-melt(Matriz_6.csv)
gMatriz_7.txt<-melt(Matriz_7.csv)
gMatriz_8.txt<-melt(Matriz_8.csv)
gMatriz_9.txt<-melt(Matriz_9.csv)
gMatriz_10.txt<-melt(Matriz_10.csv)
gMatriz_11.txt<-melt(Matriz_11.csv)
gMatriz_12.txt<-melt(Matriz_12.csv)
gMatriz_13.txt<-melt(Matriz_13.csv)
gMatriz_14.txt<-melt(Matriz_14.csv)
gMatriz_15.txt<-melt(Matriz_15.csv)
gMatriz_16.txt<-melt(Matriz_16.csv)
gMatriz_17.txt<-melt(Matriz_17.csv)
gMatriz_18.txt<-melt(Matriz_18.csv)
gMatriz_19.txt<-melt(Matriz_19.csv)
gMatriz_20.txt<-melt(Matriz_20.csv)
gMatriz_21.txt<-melt(Matriz_21.csv)
gMatriz_22.txt<-melt(Matriz_22.csv)
gMatriz_23.txt<-melt(Matriz_23.csv)
gMatriz_24.txt<-melt(Matriz_24.csv)
gMatriz_atividade.txt<-melt(atividade)
gMatriz_acesso.txt<-melt(acesso)
gMatriz_confianca.txt<-melt(confianca)
gMatriz_total.txt<-melt(total)
```

#Adding colnames
```{r, message=FALSE, warning=FALSE, include=FALSE}
colnames(gMatriz_x2.txt)<-c('from','to','x2')
colnames(gMatriz_0.txt)<-c('from','to','var0')
colnames(gMatriz_1.txt)<-c('from','to','var1')
colnames(gMatriz_2.txt)<-c('from','to','var2')
colnames(gMatriz_3.txt)<-c('from','to','var3')
colnames(gMatriz_4.txt)<-c('from','to','var4')
colnames(gMatriz_5.txt)<-c('from','to','var5')
colnames(gMatriz_6.txt)<-c('from','to','var6')
colnames(gMatriz_7.txt)<-c('from','to','var7')
colnames(gMatriz_8.txt)<-c('from','to','var8')
colnames(gMatriz_9.txt)<-c('from','to','var9')
colnames(gMatriz_10.txt)<-c('from','to','var10')
colnames(gMatriz_11.txt)<-c('from','to','var11')
colnames(gMatriz_12.txt)<-c('from','to','var12')
colnames(gMatriz_13.txt)<-c('from','to','var13')
colnames(gMatriz_14.txt)<-c('from','to','var14')
colnames(gMatriz_15.txt)<-c('from','to','var15')
colnames(gMatriz_16.txt)<-c('from','to','var16')
colnames(gMatriz_17.txt)<-c('from','to','var17')
colnames(gMatriz_18.txt)<-c('from','to','var18')
colnames(gMatriz_19.txt)<-c('from','to','var19')
colnames(gMatriz_20.txt)<-c('from','to','var20')
colnames(gMatriz_21.txt)<-c('from','to','var21')
colnames(gMatriz_22.txt)<-c('from','to','var22')
colnames(gMatriz_23.txt)<-c('from','to','var23')
colnames(gMatriz_24.txt)<-c('from','to','var24')
colnames(gMatriz_atividade.txt)<-c('from','to','atividade')
colnames(gMatriz_acesso.txt)<-c('from','to','acesso')
colnames(gMatriz_confianca.txt)<-c('from','to','confianca')
colnames(gMatriz_total.txt)<-c('from','to','total')
```

#All matrixes in one dataframe
```{r, message=FALSE, warning=FALSE, include=FALSE}       
full_data_frame <- cbind(gMatriz_0.txt,
gMatriz_1.txt$var1,
gMatriz_2.txt$var2,
gMatriz_3.txt$var3,
gMatriz_4.txt$var4,
gMatriz_5.txt$var5,
gMatriz_6.txt$var6,
gMatriz_7.txt$var7,
gMatriz_8.txt$var8,
gMatriz_9.txt$var9,
gMatriz_10.txt$var10,
gMatriz_11.txt$var11,
gMatriz_12.txt$var12,
gMatriz_13.txt$var13,
gMatriz_14.txt$var14,
gMatriz_15.txt$var15,
gMatriz_16.txt$var16,
gMatriz_17.txt$var17,
gMatriz_18.txt$var18,
gMatriz_19.txt$var19,
gMatriz_20.txt$var20,
gMatriz_21.txt$var21,
gMatriz_22.txt$var22,
gMatriz_23.txt$var23,
gMatriz_24.txt$var24,
gMatriz_atividade.txt$atividade,
gMatriz_acesso.txt$acesso,
gMatriz_confianca.txt$confianca,
gMatriz_total.txt$total)
head(full_data_frame)
```

#Renaming 
```{r, message=FALSE, warning=FALSE, include=FALSE}
names(full_data_frame)[4:31] <- c(
"var1",
"var2",
"var3",
"var4",
"var5",
"var6",
"var7",
"var8",
"var9",
"var10",
"var11",
"var12",
"var13",
"var14",
"var15",
"var16",
"var17",
"var18",
"var19",
"var20",
"var21",
"var22",
"var23",
"var24",
"atividade",
"acesso",
"confianca",
"total")
names(full_data_frame)
```

```{r, message=FALSE, warning=FALSE, include=FALSE}
#Changing ID structure using regular expression

full_data_frame_id=full_data_frame

#from_q
full_data_frame_id$from=str_extract_all(full_data_frame_id$from, pattern = "[q][0-9]{1,3}", "")
full_data_frame_id$from=str_extract_all(full_data_frame_id$from, pattern = "[0-9]{1,3}", "")
#to_q
full_data_frame_id$to=str_extract_all(full_data_frame_id$to, pattern = "[q][0-9]{1,3}", "")
full_data_frame_id$to=str_extract_all(full_data_frame_id$to, pattern = "[0-9]{1,3}", "")

head(full_data_frame_id)



#Changing ID to number on Excel (ps:I need to improve this code using R)
#full_data_frame_id=read.table("~/Banco Redes R/Bancos CSV/full_data_frame_id.csv", sep=";", #stringsAsFactors=FALSE, header = T)

#Changing types for futher matching
full_data_frame_id$from<-as.character(full_data_frame_id$from)
full_data_frame_id$from<-as.numeric(full_data_frame_id$from)
full_data_frame_id$to<-as.character(full_data_frame_id$to)
full_data_frame_id$to<-as.numeric(full_data_frame_id$to)

full_data_frame_id$var0[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0

#Checking crazing diags different from zero
full_data_frame_id$var0[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var1[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var2[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var3[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var4[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var5[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var6[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var7[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var8[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var9[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var10[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var11[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var12[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var13[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var14[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var15[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var16[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var17[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var18[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var19[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var20[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var21[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var22[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var23[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$var24[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$atividade[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$acesso[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$confianca[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0
full_data_frame_id$total[(full_data_frame_id$from==full_data_frame_id$to)!=0]<-0

#Writing CSV code without diags
write.csv2(full_data_frame_id, "~/SNArRDJF/Banco Redes R/Bancos CSV/full_data_frame_id.csv", fileEncoding = "macintosh")

#Full igrpah object with looping and non zero edges
full_with_zero <- graph_from_data_frame(full_data_frame_id, directed=T) 
V(full_with_zero)$name<-as.character(V(full_with_zero)$name)
V(full_with_zero)$name<-as.numeric(V(full_with_zero)$name)
#full_with_zero<-full_with_zero[order(V(full_with_zero)$name),]
summary(full_with_zero)
```


#Creating non zero dataframe (excluding ties with weight > 0)
```{r, message=FALSE, warning=FALSE, include=FALSE}
full_nonzero_edges <- subset(full_data_frame_id, (var0 > 0 |
var1 > 0 |
var2 > 0 |
var3 > 0 |
var4 > 0 |
var5 > 0 |
var6 > 0 |
var7 > 0 |
var8 > 0 |
var9 > 0 |
var10 > 0 |
var11 > 0 |
var12 > 0 |
var13 > 0 |
var14 > 0 |
var15 > 0 |
var16> 0 |
var17 > 0 |
var18 > 0 |
var19 > 0 |
var20 > 0 |
var21 > 0 |
var22 > 0 |
var23 > 0 |
var24 > 0 |
atividade > 0 |
acesso > 0 |
confianca > 0 |
total > 0))
head(full_nonzero_edges)

#Write DataFrame in order to use with pajek (just in case)
write.csv2(full_nonzero_edges, "~/Banco Redes R/full_nonzero_edges.csv", fileEncoding = "macintosh")

#To be sure - from and to (id's) as numeric
full_nonzero_edges$from<-as.numeric(full_nonzero_edges$from)
full_nonzero_edges$to<-as.numeric(full_nonzero_edges$to)

#Sorting by from - considering previous problems with matching 
full_nonzero_edges=full_nonzero_edges[order(full_nonzero_edges$from),]
head(full_nonzero_edges)

#Full igraph object without looping or zero edges
full_no_zero <- graph_from_data_frame(full_nonzero_edges, directed=T) 
V(full_no_zero)$name<-as.character(V(full_no_zero)$name)
V(full_no_zero)$name<-as.numeric(V(full_no_zero)$name)
summary(full_no_zero)

#Sorting in order to prevent disasters 
V(full_no_zero)$name=sort(as.numeric(V(full_no_zero)$name))
V(full_no_zero)$name
```

```{r, message=FALSE, warning=FALSE, include=FALSE}
# Adding attributes to each node (full_with_zero) - Update this code with "for" and after Pedro's updates regarding KML mercartor coordinates 

V(full_with_zero)$ID=as.character(attributes.csv$ID[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$TIPO1=as.character(attributes.csv$TIPO1[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$TIPO2=as.character(attributes.csv$TIPO2[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$LABEL_COR=as.character(attributes.csv$LABEL_COR[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V1_LABEL_TIPO=as.character(attributes.csv$V1_LABEL_TIPO[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V2_LABEL_ID=as.character(attributes.csv$V2_LABEL_ID[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V3_LABEL_ID2=as.character(attributes.csv$V3_LABEL_ID2[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V4_LABEL_ID3=as.character(attributes.csv$V4_LABEL_ID3[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V5_LABEL_LABEL=as.character(attributes.csv$V5_LABEL_LABEL[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação=as.character(attributes.csv$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V7_COMUNICACAO_Telefeno.Fixo=as.character(attributes.csv$V7_COMUNICACAO_Telefeno.Fixo[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V8_COMUNICACAO_Celular.Chamada.de.Voz=as.character(attributes.csv$V8_COMUNICACAO_Celular.Chamada.de.Voz[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V9_COMUNICACAO_Celular.Mensagem.de.Texto=as.character(attributes.csv$V9_COMUNICACAO_Celular.Mensagem.de.Texto[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V10_COMUNICACAO_E.mail=as.character(attributes.csv$V10_COMUNICACAO_E.mail[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V11_COMUNICACAO_Skype.Menssager=as.character(attributes.csv$V11_COMUNICACAO_Skype.Menssager[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V12_COMUNICACAO_Converso.Pessalmente=as.character(attributes.csv$V12_COMUNICACAO_Converso.Pessalmente[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.=as.character(attributes.csv$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V14_COMUNICACAO_Outro=as.character(attributes.csv$V14_COMUNICACAO_Outro[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS=as.character(attributes.csv$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V16_TEMPO_FUNC_Data_Abertura=as.character(attributes.csv$V16_TEMPO_FUNC_Data_Abertura[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V17_TEMPO_FUNC_Data_Pesquisa=as.character(attributes.csv$V17_TEMPO_FUNC_Data_Pesquisa[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V18_TEMPO_FUNC_Idade_Serviço_Dias=as.character(attributes.csv$V18_TEMPO_FUNC_Idade_Serviço_Dias[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V19_TEMPO_FUNC_Idade_em_anos=as.character(attributes.csv$V19_TEMPO_FUNC_Idade_em_anos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V20_FUNCIONAMENTO_Segunda=as.character(attributes.csv$V20_FUNCIONAMENTO_Segunda[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V21_FUNCIONAMENTO_Terça=as.character(attributes.csv$V21_FUNCIONAMENTO_Terça[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V22_FUNCIONAMENTO_Quarta=as.character(attributes.csv$V22_FUNCIONAMENTO_Quarta[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V23_FUNCIONAMENTO_Quinta=as.character(attributes.csv$V23_FUNCIONAMENTO_Quinta[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V24_FUNCIONAMENTO_Sexta=as.character(attributes.csv$V24_FUNCIONAMENTO_Sexta[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V25_FUNCIONAMENTO_Sábado=as.character(attributes.csv$V25_FUNCIONAMENTO_Sábado[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V26_FUNCIONAMENTO_Domingo=as.character(attributes.csv$V26_FUNCIONAMENTO_Domingo[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V27_FUNCIONAMENTO_Feriados=as.character(attributes.csv$V27_FUNCIONAMENTO_Feriados[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V28_FUNCIONAMENTO_Segunda....Manhã=as.character(attributes.csv$V28_FUNCIONAMENTO_Segunda....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V29_FUNCIONAMENTO_Segunda....Tarde=as.character(attributes.csv$V29_FUNCIONAMENTO_Segunda....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V30_FUNCIONAMENTO_Segunda....Noite=as.character(attributes.csv$V30_FUNCIONAMENTO_Segunda....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V31_FUNCIONAMENTO_Segunda....Plantão.24h=as.character(attributes.csv$V31_FUNCIONAMENTO_Segunda....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V32_FUNCIONAMENTO_Terça....Manhã=as.character(attributes.csv$V32_FUNCIONAMENTO_Terça....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V33_FUNCIONAMENTO_Terça....Tarde=as.character(attributes.csv$V33_FUNCIONAMENTO_Terça....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V34_FUNCIONAMENTO_Terça....Noite=as.character(attributes.csv$V34_FUNCIONAMENTO_Terça....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V35_FUNCIONAMENTO_Terça....Plantão.24h=as.character(attributes.csv$V35_FUNCIONAMENTO_Terça....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V36_FUNCIONAMENTO_Quarta....Manhã=as.character(attributes.csv$V36_FUNCIONAMENTO_Quarta....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V37_FUNCIONAMENTO_Quarta....Tarde=as.character(attributes.csv$V37_FUNCIONAMENTO_Quarta....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V38_FUNCIONAMENTO_Quarta....Noite=as.character(attributes.csv$V38_FUNCIONAMENTO_Quarta....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V39_FUNCIONAMENTO_Quarta....Plantão.24h=as.character(attributes.csv$V39_FUNCIONAMENTO_Quarta....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V40_FUNCIONAMENTO_Quinta....Manhã=as.character(attributes.csv$V40_FUNCIONAMENTO_Quinta....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V41_FUNCIONAMENTO_Quinta....Tarde=as.character(attributes.csv$V41_FUNCIONAMENTO_Quinta....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V42_FUNCIONAMENTO_Quinta....Noite=as.character(attributes.csv$V42_FUNCIONAMENTO_Quinta....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V43_FUNCIONAMENTO_Quinta....Plantão.24h=as.character(attributes.csv$V43_FUNCIONAMENTO_Quinta....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V44_FUNCIONAMENTO_Sexta....Manhã=as.character(attributes.csv$V44_FUNCIONAMENTO_Sexta....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V45_FUNCIONAMENTO_Sexta....Tarde=as.character(attributes.csv$V45_FUNCIONAMENTO_Sexta....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V46_FUNCIONAMENTO_Sexta....Noite=as.character(attributes.csv$V46_FUNCIONAMENTO_Sexta....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V47_FUNCIONAMENTO_Sexta....Plantão.24h=as.character(attributes.csv$V47_FUNCIONAMENTO_Sexta....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V48_FUNCIONAMENTO_Sábado....Manhã=as.character(attributes.csv$V48_FUNCIONAMENTO_Sábado....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V49_FUNCIONAMENTO_Sábado....Tarde=as.character(attributes.csv$V49_FUNCIONAMENTO_Sábado....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V50_FUNCIONAMENTO_Sábado....Noite=as.character(attributes.csv$V50_FUNCIONAMENTO_Sábado....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V51_FUNCIONAMENTO_Sábado....Plantão.24h=as.character(attributes.csv$V51_FUNCIONAMENTO_Sábado....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V52_FUNCIONAMENTO_Domingo....Manhã=as.character(attributes.csv$V52_FUNCIONAMENTO_Domingo....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V53_FUNCIONAMENTO_Domingo....Tarde=as.character(attributes.csv$V53_FUNCIONAMENTO_Domingo....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V54_FUNCIONAMENTO_Domingo....Noite=as.character(attributes.csv$V54_FUNCIONAMENTO_Domingo....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V55_FUNCIONAMENTO_Domingo....Plantão.24h=as.character(attributes.csv$V55_FUNCIONAMENTO_Domingo....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V56_FUNCIONAMENTO_Feriado....Manhã=as.character(attributes.csv$V56_FUNCIONAMENTO_Feriado....Manhã[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V57_FUNCIONAMENTO_Feriado....Tarde=as.character(attributes.csv$V57_FUNCIONAMENTO_Feriado....Tarde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V58_FUNCIONAMENTO_Feriado....Noite=as.character(attributes.csv$V58_FUNCIONAMENTO_Feriado....Noite[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V59_FUNCIONAMENTO_Feriado....Plantão.24h=as.character(attributes.csv$V59_FUNCIONAMENTO_Feriado....Plantão.24h[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V61_PROFISSIONAIS_Assistentes.Sociais=as.character(attributes.csv$V61_PROFISSIONAIS_Assistentes.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem=as.character(attributes.csv$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V63_PROFISSIONAIS_Enfermeiros=as.character(attributes.csv$V63_PROFISSIONAIS_Enfermeiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V65_PROFISSIONAIS_Médicos=as.character(attributes.csv$V65_PROFISSIONAIS_Médicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V66_PROFISSIONAIS_Psicólogos=as.character(attributes.csv$V66_PROFISSIONAIS_Psicólogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V67_PROFISSIONAIS_Fisioterapeutas=as.character(attributes.csv$V67_PROFISSIONAIS_Fisioterapeutas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V68_PROFISSIONAIS_Terapeutas.Ocupacionais=as.character(attributes.csv$V68_PROFISSIONAIS_Terapeutas.Ocupacionais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V69_PROFISSIONAIS_Dentistas=as.character(attributes.csv$V69_PROFISSIONAIS_Dentistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V70_PROFISSIONAIS_Farmacêuticos=as.character(attributes.csv$V70_PROFISSIONAIS_Farmacêuticos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V71_PROFISSIONAIS_Administradores=as.character(attributes.csv$V71_PROFISSIONAIS_Administradores[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V73_PROFISSIONAIS_Educadores.Físicos=as.character(attributes.csv$V73_PROFISSIONAIS_Educadores.Físicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado=as.character(attributes.csv$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V76_PROFISSIONAIS_Educadores.Sociais=as.character(attributes.csv$V76_PROFISSIONAIS_Educadores.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V77_PROFISSIONAIS_Pedagogos=as.character(attributes.csv$V77_PROFISSIONAIS_Pedagogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V78_PROFISSIONAIS_Auxiliares.administrativos=as.character(attributes.csv$V78_PROFISSIONAIS_Auxiliares.administrativos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V79_PROFISSIONAIS_Recepcionistas=as.character(attributes.csv$V79_PROFISSIONAIS_Recepcionistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V80_PROFISSIONAIS_Serviços.gerais=as.character(attributes.csv$V80_PROFISSIONAIS_Serviços.gerais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V81_PROFISSIONAIS_Cozinheiros=as.character(attributes.csv$V81_PROFISSIONAIS_Cozinheiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V82_PROFISSIONAIS_Motoristas=as.character(attributes.csv$V82_PROFISSIONAIS_Motoristas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V83_PROFISSIONAIS_Porteiros=as.character(attributes.csv$V83_PROFISSIONAIS_Porteiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V84_PROFISSIONAIS_Outros=as.character(attributes.csv$V84_PROFISSIONAIS_Outros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V85_PROFISSIONAIS_TOTAL_Profissionais=as.character(attributes.csv$V85_PROFISSIONAIS_TOTAL_Profissionais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V87_PROFISSIONAIS_X2...Assistentes.Sociais=as.character(attributes.csv$V87_PROFISSIONAIS_X2...Assistentes.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem=as.character(attributes.csv$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V89_PROFISSIONAIS_X4...Enfermeiros=as.character(attributes.csv$V89_PROFISSIONAIS_X4...Enfermeiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V91_PROFISSIONAIS_X6...Médicos=as.character(attributes.csv$V91_PROFISSIONAIS_X6...Médicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V92_PROFISSIONAIS_X7...Psicólogos=as.character(attributes.csv$V92_PROFISSIONAIS_X7...Psicólogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V93_PROFISSIONAIS_X8...Fisioterapeutas=as.character(attributes.csv$V93_PROFISSIONAIS_X8...Fisioterapeutas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais=as.character(attributes.csv$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V95_PROFISSIONAIS_X10...Dentistas=as.character(attributes.csv$V95_PROFISSIONAIS_X10...Dentistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V96_PROFISSIONAIS_X11...Farmacêuticos=as.character(attributes.csv$V96_PROFISSIONAIS_X11...Farmacêuticos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V97_PROFISSIONAIS_X12...Administradores=as.character(attributes.csv$V97_PROFISSIONAIS_X12...Administradores[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V99_PROFISSIONAIS_X14...Educadores.Físicos=as.character(attributes.csv$V99_PROFISSIONAIS_X14...Educadores.Físicos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado=as.character(attributes.csv$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V102_PROFISSIONAIS_X17...Educadores.Sociais=as.character(attributes.csv$V102_PROFISSIONAIS_X17...Educadores.Sociais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V103_PROFISSIONAIS_X18...Pedagogos=as.character(attributes.csv$V103_PROFISSIONAIS_X18...Pedagogos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V104_PROFISSIONAIS_X19...Auxiliares.administrativos=as.character(attributes.csv$V104_PROFISSIONAIS_X19...Auxiliares.administrativos[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V105_PROFISSIONAIS_X20...Recepcionistas=as.character(attributes.csv$V105_PROFISSIONAIS_X20...Recepcionistas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V106_PROFISSIONAIS_X21...Serviços.gerais=as.character(attributes.csv$V106_PROFISSIONAIS_X21...Serviços.gerais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V107_PROFISSIONAIS_X22...Cozinheiros=as.character(attributes.csv$V107_PROFISSIONAIS_X22...Cozinheiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V108_PROFISSIONAIS_X23...Motoristas=as.character(attributes.csv$V108_PROFISSIONAIS_X23...Motoristas[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V109_PROFISSIONAIS_X24...Porteiros=as.character(attributes.csv$V109_PROFISSIONAIS_X24...Porteiros[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V110_PACIENTES_Média.atende.dia.típico.=as.character(attributes.csv$V110_PACIENTES_Média.atende.dia.típico.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V111_PACIENTES_Média.capacidade.de.atender.=as.character(attributes.csv$V111_PACIENTES_Média.capacidade.de.atender.[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..=as.character(attributes.csv$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..=as.character(attributes.csv$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V114_RELACOES_UAPS.RURAL=as.character(attributes.csv$V114_RELACOES_UAPS.RURAL[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V115_RELACOES_UAPS.URBANA=as.character(attributes.csv$V115_RELACOES_UAPS.URBANA[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V116_RELACOES_Ajuda.Mútua=as.character(attributes.csv$V116_RELACOES_Ajuda.Mútua[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT=as.character(attributes.csv$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V118_RELACOES_Residência.Terapeutica=as.character(attributes.csv$V118_RELACOES_Residência.Terapeutica[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V119_RELACOES_Entidades.Socioassistenciais=as.character(attributes.csv$V119_RELACOES_Entidades.Socioassistenciais[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V120_RELACOES_Assistência.Hospitalar=as.character(attributes.csv$V120_RELACOES_Assistência.Hospitalar[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V121_RELACOES_CAPS=as.character(attributes.csv$V121_RELACOES_CAPS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V122_RELACOES_CRAS=as.character(attributes.csv$V122_RELACOES_CRAS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V123_RELACOES_CREAS=as.character(attributes.csv$V123_RELACOES_CREAS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V124_RELACOES_Acolhimento.Institucional=as.character(attributes.csv$V124_RELACOES_Acolhimento.Institucional[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V125_RELACOES_Urgência.Emergência=as.character(attributes.csv$V125_RELACOES_Urgência.Emergência[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V126_RELACOES_Ambulatório.de.Saúde.Mental=as.character(attributes.csv$V126_RELACOES_Ambulatório.de.Saúde.Mental[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V127_RELACOES_Centro.de.Convivência=as.character(attributes.csv$V127_RELACOES_Centro.de.Convivência[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V128_RELACOES_Consultório.na.Rua=as.character(attributes.csv$V128_RELACOES_Consultório.na.Rua[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO=as.character(attributes.csv$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS=as.character(attributes.csv$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V131_GEO_kml_latitude=as.character(attributes.csv$V131_GEO_kml_latitude[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_with_zero)$V132_GEO_kml_longitude=as.character(attributes.csv$V132_GEO_kml_longitude[match(V(full_with_zero)$name, attributes.csv$V3_LABEL_ID2)])
```

#Adding pallettes colors
```{r}
vertex_col <- brewer.pal(length(unique(V(full_with_zero)$LABEL_COR)), "Set3")
V(full_no_zero)$color <- vertex_col[factor(V(full_with_zero)$LABEL_COR)]
```


```{r, message=FALSE, warning=FALSE, include=FALSE}
# The coolest part - adding attributes to each node (full_no_zero) - Update this code with "for" and after Pedro's updates regarding KML mercartor coordinates 

V(full_no_zero)$ID=as.character(attributes.csv$ID[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$TIPO1=as.character(attributes.csv$TIPO1[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$TIPO2=as.character(attributes.csv$TIPO2[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$LABEL_COR=as.character(attributes.csv$LABEL_COR[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V1_LABEL_TIPO=as.character(attributes.csv$V1_LABEL_TIPO[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V2_LABEL_ID=as.character(attributes.csv$V2_LABEL_ID[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V3_LABEL_ID2=as.character(attributes.csv$V3_LABEL_ID2[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V4_LABEL_ID3=as.character(attributes.csv$V4_LABEL_ID3[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V5_LABEL_LABEL=as.character(attributes.csv$V5_LABEL_LABEL[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação=as.character(attributes.csv$V6_COMUNICACAO_Dispõe.de.meios.de.comunicação[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V7_COMUNICACAO_Telefeno.Fixo=as.character(attributes.csv$V7_COMUNICACAO_Telefeno.Fixo[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V8_COMUNICACAO_Celular.Chamada.de.Voz=as.character(attributes.csv$V8_COMUNICACAO_Celular.Chamada.de.Voz[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V9_COMUNICACAO_Celular.Mensagem.de.Texto=as.character(attributes.csv$V9_COMUNICACAO_Celular.Mensagem.de.Texto[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V10_COMUNICACAO_E.mail=as.character(attributes.csv$V10_COMUNICACAO_E.mail[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V11_COMUNICACAO_Skype.Menssager=as.character(attributes.csv$V11_COMUNICACAO_Skype.Menssager[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V12_COMUNICACAO_Converso.Pessalmente=as.character(attributes.csv$V12_COMUNICACAO_Converso.Pessalmente[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.=as.character(attributes.csv$V13_COMUNICACAO_Comunicação.Institucional..Ofício..Memorando.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V14_COMUNICACAO_Outro=as.character(attributes.csv$V14_COMUNICACAO_Outro[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS=as.character(attributes.csv$V15_COMUNICACAO_FACEBOOK.REDES.SOCAIS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V16_TEMPO_FUNC_Data_Abertura=as.character(attributes.csv$V16_TEMPO_FUNC_Data_Abertura[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V17_TEMPO_FUNC_Data_Pesquisa=as.character(attributes.csv$V17_TEMPO_FUNC_Data_Pesquisa[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V18_TEMPO_FUNC_Idade_Serviço_Dias=as.character(attributes.csv$V18_TEMPO_FUNC_Idade_Serviço_Dias[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V19_TEMPO_FUNC_Idade_em_anos=as.character(attributes.csv$V19_TEMPO_FUNC_Idade_em_anos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V20_FUNCIONAMENTO_Segunda=as.character(attributes.csv$V20_FUNCIONAMENTO_Segunda[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V21_FUNCIONAMENTO_Terça=as.character(attributes.csv$V21_FUNCIONAMENTO_Terça[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V22_FUNCIONAMENTO_Quarta=as.character(attributes.csv$V22_FUNCIONAMENTO_Quarta[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V23_FUNCIONAMENTO_Quinta=as.character(attributes.csv$V23_FUNCIONAMENTO_Quinta[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V24_FUNCIONAMENTO_Sexta=as.character(attributes.csv$V24_FUNCIONAMENTO_Sexta[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V25_FUNCIONAMENTO_Sábado=as.character(attributes.csv$V25_FUNCIONAMENTO_Sábado[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V26_FUNCIONAMENTO_Domingo=as.character(attributes.csv$V26_FUNCIONAMENTO_Domingo[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V27_FUNCIONAMENTO_Feriados=as.character(attributes.csv$V27_FUNCIONAMENTO_Feriados[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V28_FUNCIONAMENTO_Segunda....Manhã=as.character(attributes.csv$V28_FUNCIONAMENTO_Segunda....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V29_FUNCIONAMENTO_Segunda....Tarde=as.character(attributes.csv$V29_FUNCIONAMENTO_Segunda....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V30_FUNCIONAMENTO_Segunda....Noite=as.character(attributes.csv$V30_FUNCIONAMENTO_Segunda....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V31_FUNCIONAMENTO_Segunda....Plantão.24h=as.character(attributes.csv$V31_FUNCIONAMENTO_Segunda....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V32_FUNCIONAMENTO_Terça....Manhã=as.character(attributes.csv$V32_FUNCIONAMENTO_Terça....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V33_FUNCIONAMENTO_Terça....Tarde=as.character(attributes.csv$V33_FUNCIONAMENTO_Terça....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V34_FUNCIONAMENTO_Terça....Noite=as.character(attributes.csv$V34_FUNCIONAMENTO_Terça....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V35_FUNCIONAMENTO_Terça....Plantão.24h=as.character(attributes.csv$V35_FUNCIONAMENTO_Terça....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V36_FUNCIONAMENTO_Quarta....Manhã=as.character(attributes.csv$V36_FUNCIONAMENTO_Quarta....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V37_FUNCIONAMENTO_Quarta....Tarde=as.character(attributes.csv$V37_FUNCIONAMENTO_Quarta....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V38_FUNCIONAMENTO_Quarta....Noite=as.character(attributes.csv$V38_FUNCIONAMENTO_Quarta....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V39_FUNCIONAMENTO_Quarta....Plantão.24h=as.character(attributes.csv$V39_FUNCIONAMENTO_Quarta....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V40_FUNCIONAMENTO_Quinta....Manhã=as.character(attributes.csv$V40_FUNCIONAMENTO_Quinta....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V41_FUNCIONAMENTO_Quinta....Tarde=as.character(attributes.csv$V41_FUNCIONAMENTO_Quinta....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V42_FUNCIONAMENTO_Quinta....Noite=as.character(attributes.csv$V42_FUNCIONAMENTO_Quinta....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V43_FUNCIONAMENTO_Quinta....Plantão.24h=as.character(attributes.csv$V43_FUNCIONAMENTO_Quinta....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V44_FUNCIONAMENTO_Sexta....Manhã=as.character(attributes.csv$V44_FUNCIONAMENTO_Sexta....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V45_FUNCIONAMENTO_Sexta....Tarde=as.character(attributes.csv$V45_FUNCIONAMENTO_Sexta....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V46_FUNCIONAMENTO_Sexta....Noite=as.character(attributes.csv$V46_FUNCIONAMENTO_Sexta....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V47_FUNCIONAMENTO_Sexta....Plantão.24h=as.character(attributes.csv$V47_FUNCIONAMENTO_Sexta....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V48_FUNCIONAMENTO_Sábado....Manhã=as.character(attributes.csv$V48_FUNCIONAMENTO_Sábado....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V49_FUNCIONAMENTO_Sábado....Tarde=as.character(attributes.csv$V49_FUNCIONAMENTO_Sábado....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V50_FUNCIONAMENTO_Sábado....Noite=as.character(attributes.csv$V50_FUNCIONAMENTO_Sábado....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V51_FUNCIONAMENTO_Sábado....Plantão.24h=as.character(attributes.csv$V51_FUNCIONAMENTO_Sábado....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V52_FUNCIONAMENTO_Domingo....Manhã=as.character(attributes.csv$V52_FUNCIONAMENTO_Domingo....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V53_FUNCIONAMENTO_Domingo....Tarde=as.character(attributes.csv$V53_FUNCIONAMENTO_Domingo....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V54_FUNCIONAMENTO_Domingo....Noite=as.character(attributes.csv$V54_FUNCIONAMENTO_Domingo....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V55_FUNCIONAMENTO_Domingo....Plantão.24h=as.character(attributes.csv$V55_FUNCIONAMENTO_Domingo....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V56_FUNCIONAMENTO_Feriado....Manhã=as.character(attributes.csv$V56_FUNCIONAMENTO_Feriado....Manhã[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V57_FUNCIONAMENTO_Feriado....Tarde=as.character(attributes.csv$V57_FUNCIONAMENTO_Feriado....Tarde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V58_FUNCIONAMENTO_Feriado....Noite=as.character(attributes.csv$V58_FUNCIONAMENTO_Feriado....Noite[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V59_FUNCIONAMENTO_Feriado....Plantão.24h=as.character(attributes.csv$V59_FUNCIONAMENTO_Feriado....Plantão.24h[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V60_PROFISSIONAIS_Agentes.Comunitários.de.Saúde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V61_PROFISSIONAIS_Assistentes.Sociais=as.character(attributes.csv$V61_PROFISSIONAIS_Assistentes.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem=as.character(attributes.csv$V62_PROFISSIONAIS_Auxiliares.de.Enfermagem[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V63_PROFISSIONAIS_Enfermeiros=as.character(attributes.csv$V63_PROFISSIONAIS_Enfermeiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V64_PROFISSIONAIS_Auxiliares.de.Consultório.Bucal[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V65_PROFISSIONAIS_Médicos=as.character(attributes.csv$V65_PROFISSIONAIS_Médicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V66_PROFISSIONAIS_Psicólogos=as.character(attributes.csv$V66_PROFISSIONAIS_Psicólogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V67_PROFISSIONAIS_Fisioterapeutas=as.character(attributes.csv$V67_PROFISSIONAIS_Fisioterapeutas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V68_PROFISSIONAIS_Terapeutas.Ocupacionais=as.character(attributes.csv$V68_PROFISSIONAIS_Terapeutas.Ocupacionais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V69_PROFISSIONAIS_Dentistas=as.character(attributes.csv$V69_PROFISSIONAIS_Dentistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V70_PROFISSIONAIS_Farmacêuticos=as.character(attributes.csv$V70_PROFISSIONAIS_Farmacêuticos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V71_PROFISSIONAIS_Administradores=as.character(attributes.csv$V71_PROFISSIONAIS_Administradores[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V72_PROFISSIONAIS_Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V73_PROFISSIONAIS_Educadores.Físicos=as.character(attributes.csv$V73_PROFISSIONAIS_Educadores.Físicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V74_PROFISSIONAIS_Assistentes.de.Recursos.Comunitários[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado=as.character(attributes.csv$V75_PROFISSIONAIS_Auxiliares.de.almoxarifado[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V76_PROFISSIONAIS_Educadores.Sociais=as.character(attributes.csv$V76_PROFISSIONAIS_Educadores.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V77_PROFISSIONAIS_Pedagogos=as.character(attributes.csv$V77_PROFISSIONAIS_Pedagogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V78_PROFISSIONAIS_Auxiliares.administrativos=as.character(attributes.csv$V78_PROFISSIONAIS_Auxiliares.administrativos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V79_PROFISSIONAIS_Recepcionistas=as.character(attributes.csv$V79_PROFISSIONAIS_Recepcionistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V80_PROFISSIONAIS_Serviços.gerais=as.character(attributes.csv$V80_PROFISSIONAIS_Serviços.gerais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V81_PROFISSIONAIS_Cozinheiros=as.character(attributes.csv$V81_PROFISSIONAIS_Cozinheiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V82_PROFISSIONAIS_Motoristas=as.character(attributes.csv$V82_PROFISSIONAIS_Motoristas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V83_PROFISSIONAIS_Porteiros=as.character(attributes.csv$V83_PROFISSIONAIS_Porteiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V84_PROFISSIONAIS_Outros=as.character(attributes.csv$V84_PROFISSIONAIS_Outros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V85_PROFISSIONAIS_TOTAL_Profissionais=as.character(attributes.csv$V85_PROFISSIONAIS_TOTAL_Profissionais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde=as.character(attributes.csv$V86_PROFISSIONAIS_X1...Agentes.Comunitários.de.Saúde[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V87_PROFISSIONAIS_X2...Assistentes.Sociais=as.character(attributes.csv$V87_PROFISSIONAIS_X2...Assistentes.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem=as.character(attributes.csv$V88_PROFISSIONAIS_X3...Auxiliares.de.Enfermagem[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V89_PROFISSIONAIS_X4...Enfermeiros=as.character(attributes.csv$V89_PROFISSIONAIS_X4...Enfermeiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal=as.character(attributes.csv$V90_PROFISSIONAIS_X5...Auxiliares.de.Consultório.Bucal[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V91_PROFISSIONAIS_X6...Médicos=as.character(attributes.csv$V91_PROFISSIONAIS_X6...Médicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V92_PROFISSIONAIS_X7...Psicólogos=as.character(attributes.csv$V92_PROFISSIONAIS_X7...Psicólogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V93_PROFISSIONAIS_X8...Fisioterapeutas=as.character(attributes.csv$V93_PROFISSIONAIS_X8...Fisioterapeutas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais=as.character(attributes.csv$V94_PROFISSIONAIS_X9...Terapeutas.Ocupacionais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V95_PROFISSIONAIS_X10...Dentistas=as.character(attributes.csv$V95_PROFISSIONAIS_X10...Dentistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V96_PROFISSIONAIS_X11...Farmacêuticos=as.character(attributes.csv$V96_PROFISSIONAIS_X11...Farmacêuticos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V97_PROFISSIONAIS_X12...Administradores=as.character(attributes.csv$V97_PROFISSIONAIS_X12...Administradores[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.=as.character(attributes.csv$V98_PROFISSIONAIS_X13...Agentes.de.segurança..guardas..rondas.vigilantes.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V99_PROFISSIONAIS_X14...Educadores.Físicos=as.character(attributes.csv$V99_PROFISSIONAIS_X14...Educadores.Físicos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários=as.character(attributes.csv$V100_PROFISSIONAIS_X15...Assistentes.de.Recursos.Comunitários[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado=as.character(attributes.csv$V101_PROFISSIONAIS_X16...Auxiliares.de.almoxarifado[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V102_PROFISSIONAIS_X17...Educadores.Sociais=as.character(attributes.csv$V102_PROFISSIONAIS_X17...Educadores.Sociais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V103_PROFISSIONAIS_X18...Pedagogos=as.character(attributes.csv$V103_PROFISSIONAIS_X18...Pedagogos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V104_PROFISSIONAIS_X19...Auxiliares.administrativos=as.character(attributes.csv$V104_PROFISSIONAIS_X19...Auxiliares.administrativos[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V105_PROFISSIONAIS_X20...Recepcionistas=as.character(attributes.csv$V105_PROFISSIONAIS_X20...Recepcionistas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V106_PROFISSIONAIS_X21...Serviços.gerais=as.character(attributes.csv$V106_PROFISSIONAIS_X21...Serviços.gerais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V107_PROFISSIONAIS_X22...Cozinheiros=as.character(attributes.csv$V107_PROFISSIONAIS_X22...Cozinheiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V108_PROFISSIONAIS_X23...Motoristas=as.character(attributes.csv$V108_PROFISSIONAIS_X23...Motoristas[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V109_PROFISSIONAIS_X24...Porteiros=as.character(attributes.csv$V109_PROFISSIONAIS_X24...Porteiros[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V110_PACIENTES_Média.atende.dia.típico.=as.character(attributes.csv$V110_PACIENTES_Média.atende.dia.típico.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V111_PACIENTES_Média.capacidade.de.atender.=as.character(attributes.csv$V111_PACIENTES_Média.capacidade.de.atender.[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..=as.character(attributes.csv$V112_PACIENTES_Porcentagem.tem.problemas.com.drogas..[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..=as.character(attributes.csv$V113_PACIENTES_Porcentagem.tem.outros.problemas.de.saúde.mental..[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V114_RELACOES_UAPS.RURAL=as.character(attributes.csv$V114_RELACOES_UAPS.RURAL[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V115_RELACOES_UAPS.URBANA=as.character(attributes.csv$V115_RELACOES_UAPS.URBANA[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V116_RELACOES_Ajuda.Mútua=as.character(attributes.csv$V116_RELACOES_Ajuda.Mútua[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT=as.character(attributes.csv$V117_RELACOES_Entidades.Assistênciais.e.Dependencia.Química.e.CT[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V118_RELACOES_Residência.Terapeutica=as.character(attributes.csv$V118_RELACOES_Residência.Terapeutica[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V119_RELACOES_Entidades.Socioassistenciais=as.character(attributes.csv$V119_RELACOES_Entidades.Socioassistenciais[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V120_RELACOES_Assistência.Hospitalar=as.character(attributes.csv$V120_RELACOES_Assistência.Hospitalar[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V121_RELACOES_CAPS=as.character(attributes.csv$V121_RELACOES_CAPS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V122_RELACOES_CRAS=as.character(attributes.csv$V122_RELACOES_CRAS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V123_RELACOES_CREAS=as.character(attributes.csv$V123_RELACOES_CREAS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V124_RELACOES_Acolhimento.Institucional=as.character(attributes.csv$V124_RELACOES_Acolhimento.Institucional[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V125_RELACOES_Urgência.Emergência=as.character(attributes.csv$V125_RELACOES_Urgência.Emergência[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V126_RELACOES_Ambulatório.de.Saúde.Mental=as.character(attributes.csv$V126_RELACOES_Ambulatório.de.Saúde.Mental[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V127_RELACOES_Centro.de.Convivência=as.character(attributes.csv$V127_RELACOES_Centro.de.Convivência[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V128_RELACOES_Consultório.na.Rua=as.character(attributes.csv$V128_RELACOES_Consultório.na.Rua[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO=as.character(attributes.csv$V129_RELACOES_OUTRO.SERVIÇO.NAO.LISTADO[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS=as.character(attributes.csv$V130_RELACOES_NÚMERO.SERVIÇOS.NÃO.LISTADOS[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V131_GEO_kml_latitude=as.character(attributes.csv$V131_GEO_kml_latitude[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])

V(full_no_zero)$V132_GEO_kml_longitude=as.character(attributes.csv$V132_GEO_kml_longitude[match(V(full_no_zero)$name, attributes.csv$V3_LABEL_ID2)])
```

#Adding pallettes colors
```{r}
vertex_col <- brewer.pal(length(unique(V(full_no_zero)$LABEL_COR)), "Set3")
V(full_no_zero)$color <- vertex_col[factor(V(full_no_zero)$LABEL_COR)]
```


#Basic Proof 
```{r, message=FALSE, warning=FALSE, include=FALSE}
#The most important test full_no_zero
a=get.vertex.attribute(full_no_zero, 'V2_LABEL_ID')
b=attributes.csv$V3_LABEL_ID2
c=cbind(a,b)
head(c)

#The most important test full_no_zero
d=get.vertex.attribute(full_with_zero, 'V2_LABEL_ID')
b=attributes.csv$V3_LABEL_ID2
e=cbind(d,b)
head(e)
```

#Creating individual graphs by type after all atributtes are added
```{r, message=FALSE, warning=FALSE, include=FALSE}

#B1 Tipo de Relacionamento	B1.2 – TIPOS DE RELACIONAMENTO - FORMAL. No que se refere à ATENÇÃO aos USUÁRIOS DE DROGAS, você caracteriza como FORMAL o relacionamento que o seu serviço possui com os #serviços a seguir ? Parceria Formal - Feita através de paceria/fluxo institucional devadmente reconheca, por meio de convênios, contratos, ou acordo entre gesotres/secretarias etc.
var0 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero, name = "var0") == 0])

#B2- ATIVADES EM CONJUNTO	B2.1 – TIPOS DE RELACIONAMENTO - REFERENCIA DE ENVIO  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE ENVIO OU ENCAMINHAMENTO DE USUÁRIO DE DROGAS COM OS SERVIÇOS A SEGUIR: #REFERENCIA DE ENVIO - Usuários de Drogas encaminhados a outros serviços da rede
var1 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var1") == 0])

#B2- ATIVADES EM CONJUNTO	B2.2 – TIPOS DE RELACIONAMENTO - REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE RECEBIMENTO OU CONTRAREFERENCIA DE USUÁRIO DE #DROGAS COM: REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA  - USUÁRIOS DE DROGAS RECEBOS OU CONTRAREFERENCIADOS DE OUTROS SERVIÇOS DA REDE
var2 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var2") == 0])

#B2- ATIVADES EM CONJUNTO	B2.3 – TIPOS DE RELACIONAMENTO  - COORDENAÇÃO CONJUNTA DE CASOS  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE COORDENAÇÃO CONJUNTA DE CASOS REFERENTE AO USO DE DROGAS COM: COORDENAÇÃO #CONJUNTA DE CASOS - COMPARTILHAMENTO DE DADOS E CONDUTAS A RESPEITO DE UM CASO ESPECÍFICO RELACIONADO AO USO DE DROGAS, RESPONSABILADE COMPARTILHADA DE CASOS, TRATAMENTO DE USUÁRIOS DE DROGAS EM CONJUNTO #COM OUTROS SERVIÇOS
var3 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var3") == 0])

#B2- ATIVADES EM CONJUNTO	B2.4 – TIPOS DE RELACIONAMENTO - PROGRAMAS EM CONJUNTO - O SEU SERVIÇO MANTÉM ALGUM TIPO DE PROGRAMA EM CONJUNTO REFERENTE AO USO DE DROGAS COM: PROGRAMAS EM CONJUNTO  - #PROGRAMAS E PROJETOS REFERENTES AO USO DE DROGAS DESENVOLVOS EM CONJUNTO COM OUTROS SERVIÇOS
var4 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var4") == 0])

#B2- ATIVADES EM CONJUNTO	B2.5 – TIPOS DE RELACIONAMENTO  - OFERTA DE TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ TREINOU OU CAPACITOU ALGUM DOS SERVIÇOS A SEGUIR:  OFERTA #DE TREINAMENTOS/CAPACITAÇÕES  - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE RELACIONADOS AO USO DE DROGAS OFERECOS PARA OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL
var5 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var5") == 0])

#B2- ATIVADES EM CONJUNTO	B2.6 – TIPOS DE RELACIONAMENTO  - RECEBER TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ FOI TREINADO OU CAPACITADO POR ALGUM DOS SERVIÇOS A SEGUIR: #RECEBER TREINAMENTOS/CAPACITAÇÕES - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE REFERENTES AO USO DE DROGAS RECEBOS DE OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO #PROFISSIONAL 
var6 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var6") == 0])

#ACESSO	A) Este serviço mostra-se disponível para realização de ativades em conjunto.
var7 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var7") == 0])

#ACESSO	B) O horário de funcionamento deste serviço possibilita a realização de ações em conjunto.
var8 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var8") == 0])

#ACESSO	C) Este serviço disponibiliza informações sobre suas ativades para o seu serviço.
var9 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var9") == 0])

#ACESSO	D) O seu serviço consegue acessar facilmente informações deste serviço.
var10 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var10") == 0])

#ACESSO	E) Os canais de comunicação com este serviço são suficientes para realização de ações em conjunto.
var11 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var11") == 0])

#ACESSO	F) Seu serviço tem facilade de entrar em contato com este serviço para realizar ativades em conjunto.
var12 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var12") == 0])

#ACESSO	G) O acesso geográfico a este serviço impede a realização de ativades em conjunto.  
var13 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var13") == 0])

#ACESSO	H) O custo para acessar este serviço impede a realização de ativades em conjunto.
var14 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var14") == 0])

#ACESSO	I) O tempo gasto para acessar este serviço impede a realização ativades em conjunto.
var15 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var15") == 0])

#CONFIANÇA	A) Seu serviço confia  na qualificação profissional da equipe deste serviço 
var16 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var16") == 0])

#CONFIANÇA	B) Seu serviço confia  na capacade técnica da equipe deste serviço.
var17 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var17") == 0])

#CONFIANÇA	C) Seu serviço confia  nas ações realizadas por este serviço.
var18 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var18") == 0])

#CONFIANÇA	D) Seu serviço confia  em compartilhar informações internas com este serviço. 
var19 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var19") == 0])

#CONFIANÇA	E) Seu serviço confia nas informações recebas deste serviço.
var20 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var20") == 0])

#CONFIANÇA	F) Seu serviço confia  em realizar ações conjuntas com este serviço.
var21 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var21") == 0])

#CONFIANÇA	G) Seu serviço está satisfeito  com as ações desempenhadas por este serviço.
var22 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var22") == 0])

#CONFIANÇA	H) Seu serviço espera que o relacionamento com este serviço continue nos próximos anos.
var23 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var23") == 0])

#CONFIANÇA	I) Seu serviço espera que o relacionamento com este serviço se fortaleça nos próximos anos.
var24 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var24") == 0])

#SOMATÓRIO ATIVIDADE
atividade = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "atividade") == 0])

#SOMATÓRIO ACESSO
acesso = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "acesso") == 0])

#SOMATÓRIO CONFIANÇA
confianca = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "confianca") == 0])

#SOMATÓRIO TOTAL
total = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "total") == 0])

```

#Reachability Function
```{r}
reachability <- function(g, m) {
  reach_mat = matrix(nrow = vcount(g), 
                     ncol = vcount(g))
  for (i in 1:vcount(g)) {
    reach_mat[i,] = 0
    this_node_reach <- subcomponent(g, i, mode = m) # used "i" instead of "(i - 1)"

    for (j in 1:(length(this_node_reach))) {
      alter = this_node_reach[j] # removed "+ 1"
      reach_mat[i, alter] = 1
    }
  }
  return(reach_mat)
}
```

#Descriptive Analysis for Full No Zero
```{r}
#Centrality Degree  
V(temp)$indegree<-degree(temp, mode = "in")
V(temp)$outdegree <- degree(temp, mode = "out")
V(temp)$totaldegree <- degree(temp, mode = "total")

temp_indegree<-degree(temp, mode = "in")
temp_outdegree<-degree(temp, mode = "out")
temp_totaldegree<-degree(temp, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(temp_indegree)
sd(temp_indegree)
##out
summary(temp_outdegree)
sd(temp_outdegree)
##all
summary(temp_totaldegree)
sd(temp_totaldegree)

#Closeness 
V(temp)$incloseness <- closeness(temp, mode = "in") #%>% round(6)
V(temp)$outcloseness <- closeness(temp, mode = "out") #%>% round(6)
V(temp)$totalcloseness <- closeness(temp, mode = "total") #%>% round(6)
temp_incloseness<- closeness(temp, mode = "in") #%>% round(6)
temp_outcloseness<- closeness(temp, mode = "out") #%>% round(6)
temp_totalcloseness<- closeness(temp, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(temp_incloseness)
sd(temp_incloseness)
##out
summary(temp_outcloseness)
sd(temp_outcloseness)
##all
summary(temp_totalcloseness)
sd(temp_totalcloseness)

#Betweenness
V(temp)$betweenness <- betweenness(temp) %>% round(1)
temp_betweenness <- betweenness(temp) %>% round(1)

##all
summary(temp_betweenness)
sd(temp_betweenness)

#Eigen_Centrality
V(temp)$eigenvector <- eigen_centrality(temp, directed = TRUE) %$% vector %>% round(3)
temp_eigenvector <- eigen_centrality(temp, directed = TRUE) %$% vector %>% round(3)

#all
summary(temp_eigenvector)
sd(temp_eigenvector)

#Shortest Paths
temp_sp_in <- shortest.paths(temp, mode='in')
temp_sp_out <- shortest.paths(temp, mode='out')

#in
mean(temp_sp_in[which(temp_sp_in != Inf)])
sd(temp_sp_in[which(temp_sp_in != Inf)])
#out
mean(temp_sp_out[which(temp_sp_out != Inf)])
sd(temp_sp_out[which(temp_sp_out != Inf)])

#Reachability
temp_reach_in <- reachability(temp, 'in')
temp_reach_out <- reachability(temp, 'out')

#in
mean(temp_reach_in[which(temp_reach_in != Inf)])
sd(temp_reach_in[which(temp_reach_in != Inf)])
#out
mean(temp_reach_out[which(temp_reach_out != Inf)])
sd(temp_reach_out[which(temp_reach_out != Inf)])

# Density 
graph.density(temp)

# Reciprocity
reciprocity(temp)

# Transitivity
transitivity(temp)

#Triad Census
tc_temp <- triad.census(temp)
triad_df <- data.frame(tc_temp)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

temp_sp_in_vec <- vector()
temp_sp_out_vec <- vector()
temp_reach_in_vec <- vector()
temp_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(temp))
  temp_reach_in_vec[i] <- mean(temp_reach_in[i,])
  V(temp)$temp_reach_in_vec[i] <- mean(temp_reach_in[i,]) #adding to igraph object
  
  temp_reach_out_vec[i] <- mean(temp_reach_out[i,])
  V(temp)$temp_reach_out_vec[i] <- mean(temp_reach_out[i,]) #adding to igraph object
  
  temp_shortest.paths.in_vec[i] <- mean(temp_sp_in[i,])
  V(temp)$temp_shortest.paths.in_vec[i] <- mean(temp_sp_in[i,]) #adding to igraph object
  
  temp_shortest.paths.out_vec[i] <- mean(temp_sp_out[i,])
  V(temp)$temp_shortest.paths.out_vec[i] <- mean(temp_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
temp_indegree,
temp_outdegree,
temp_totaldegree,
temp_incloseness,
temp_outcloseness,
temp_totalcloseness,
temp_betweenness,
temp_eigenvector,
temp_reach_in_vec, 
temp_reach_out_vec, 
temp_sp_in_vec, 
temp_sp_out_vec)

write.csv(temp_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/temp_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_temp <- triad.census(temp)
triad_df_temp <- data.frame(census_labels,tc_temp)
triad_df_temp
write.csv(triad_df_temp, 'temp_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```

#Descriptive SNA - var0
```{r}
#Centrality Degree  
V(var0)$indegree<-degree(var0, mode = "in")
V(var0)$outdegree <- degree(var0, mode = "out")
V(var0)$totaldegree <- degree(var0, mode = "total")

var0_indegree<-degree(var0, mode = "in")
var0_outdegree<-degree(var0, mode = "out")
var0_totaldegree<-degree(var0, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var0_indegree)
sd(var0_indegree)
##out
summary(var0_outdegree)
sd(var0_outdegree)
##all
summary(var0_totaldegree)
sd(var0_totaldegree)

#Closeness 
V(var0)$incloseness <- closeness(var0, mode = "in") #%>% round(6)
V(var0)$outcloseness <- closeness(var0, mode = "out") #%>% round(6)
V(var0)$totalcloseness <- closeness(var0, mode = "total") #%>% round(6)
var0_incloseness<- closeness(var0, mode = "in") #%>% round(6)
var0_outcloseness<- closeness(var0, mode = "out") #%>% round(6)
var0_totalcloseness<- closeness(var0, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var0_incloseness)
sd(var0_incloseness)
##out
summary(var0_outcloseness)
sd(var0_outcloseness)
##all
summary(var0_totalcloseness)
sd(var0_totalcloseness)

#Betweenness
V(var0)$betweenness <- betweenness(var0) %>% round(1)
var0_betweenness <- betweenness(var0) %>% round(1)

##all
summary(var0_betweenness)
sd(var0_betweenness)

#Eigen_Centrality
V(var0)$eigenvector <- eigen_centrality(var0, directed = TRUE) %$% vector %>% round(3)
var0_eigenvector <- eigen_centrality(var0, directed = TRUE) %$% vector %>% round(3)

#all
summary(var0_eigenvector)
sd(var0_eigenvector)

#Shortest Paths
var0_sp_in <- shortest.paths(var0, mode='in')
var0_sp_out <- shortest.paths(var0, mode='out')

#in
mean(var0_sp_in[which(var0_sp_in != Inf)])
sd(var0_sp_in[which(var0_sp_in != Inf)])
#out
mean(var0_sp_out[which(var0_sp_out != Inf)])
sd(var0_sp_out[which(var0_sp_out != Inf)])

#Reachability
var0_reach_in <- reachability(var0, 'in')
var0_reach_out <- reachability(var0, 'out')

#in
mean(var0_reach_in[which(var0_reach_in != Inf)])
sd(var0_reach_in[which(var0_reach_in != Inf)])
#out
mean(var0_reach_out[which(var0_reach_out != Inf)])
sd(var0_reach_out[which(var0_reach_out != Inf)])

# Density 
graph.density(var0)

# Reciprocity
reciprocity(var0)

# Transitivity
transitivity(var0)

#Triad Census
tc_var0 <- triad.census(var0)
triad_df <- data.frame(tc_var0)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var0_sp_in_vec <- vector()
var0_sp_out_vec <- vector()
var0_reach_in_vec <- vector()
var0_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var0))
  var0_reach_in_vec[i] <- mean(var0_reach_in[i,])
  V(var0)$var0_reach_in_vec[i] <- mean(var0_reach_in[i,]) #adding to igraph object
  
  var0_reach_out_vec[i] <- mean(var0_reach_out[i,])
  V(var0)$var0_reach_out_vec[i] <- mean(var0_reach_out[i,]) #adding to igraph object
  
  var0_shortest.paths.in_vec[i] <- mean(var0_sp_in[i,])
  V(var0)$var0_shortest.paths.in_vec[i] <- mean(var0_sp_in[i,]) #adding to igraph object
  
  var0_shortest.paths.out_vec[i] <- mean(var0_sp_out[i,])
  V(var0)$var0_shortest.paths.out_vec[i] <- mean(var0_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var0_indegree,
var0_outdegree,
var0_totaldegree,
var0_incloseness,
var0_outcloseness,
var0_totalcloseness,
var0_betweenness,
var0_eigenvector,
var0_reach_in_vec, 
var0_reach_out_vec, 
var0_sp_in_vec, 
var0_sp_out_vec)

write.csv(var0_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var0_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var0 <- triad.census(var0)
triad_df_var0 <- data.frame(census_labels,tc_var0)
triad_df_var0
write.csv(triad_df_var0, 'var0_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var1
```{r}
#Centrality Degree  
V(var1)$indegree<-degree(var1, mode = "in")
V(var1)$outdegree <- degree(var1, mode = "out")
V(var1)$totaldegree <- degree(var1, mode = "total")

var1_indegree<-degree(var1, mode = "in")
var1_outdegree<-degree(var1, mode = "out")
var1_totaldegree<-degree(var1, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var1_indegree)
sd(var1_indegree)
##out
summary(var1_outdegree)
sd(var1_outdegree)
##all
summary(var1_totaldegree)
sd(var1_totaldegree)

#Closeness 
V(var1)$incloseness <- closeness(var1, mode = "in") #%>% round(6)
V(var1)$outcloseness <- closeness(var1, mode = "out") #%>% round(6)
V(var1)$totalcloseness <- closeness(var1, mode = "total") #%>% round(6)
var1_incloseness<- closeness(var1, mode = "in") #%>% round(6)
var1_outcloseness<- closeness(var1, mode = "out") #%>% round(6)
var1_totalcloseness<- closeness(var1, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var1_incloseness)
sd(var1_incloseness)
##out
summary(var1_outcloseness)
sd(var1_outcloseness)
##all
summary(var1_totalcloseness)
sd(var1_totalcloseness)

#Betweenness
V(var1)$betweenness <- betweenness(var1) %>% round(1)
var1_betweenness <- betweenness(var1) %>% round(1)

##all
summary(var1_betweenness)
sd(var1_betweenness)

#Eigen_Centrality
V(var1)$eigenvector <- eigen_centrality(var1, directed = TRUE) %$% vector %>% round(3)
var1_eigenvector <- eigen_centrality(var1, directed = TRUE) %$% vector %>% round(3)

#all
summary(var1_eigenvector)
sd(var1_eigenvector)

#Shortest Paths
var1_sp_in <- shortest.paths(var1, mode='in')
var1_sp_out <- shortest.paths(var1, mode='out')

#in
mean(var1_sp_in[which(var1_sp_in != Inf)])
sd(var1_sp_in[which(var1_sp_in != Inf)])
#out
mean(var1_sp_out[which(var1_sp_out != Inf)])
sd(var1_sp_out[which(var1_sp_out != Inf)])

#Reachability
var1_reach_in <- reachability(var1, 'in')
var1_reach_out <- reachability(var1, 'out')

#in
mean(var1_reach_in[which(var1_reach_in != Inf)])
sd(var1_reach_in[which(var1_reach_in != Inf)])
#out
mean(var1_reach_out[which(var1_reach_out != Inf)])
sd(var1_reach_out[which(var1_reach_out != Inf)])

# Density 
graph.density(var1)

# Reciprocity
reciprocity(var1)

# Transitivity
transitivity(var1)

#Triad Census
tc_var1 <- triad.census(var1)
triad_df <- data.frame(tc_var1)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var1_sp_in_vec <- vector()
var1_sp_out_vec <- vector()
var1_reach_in_vec <- vector()
var1_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var1))
  var1_reach_in_vec[i] <- mean(var1_reach_in[i,])
  V(var1)$var1_reach_in_vec[i] <- mean(var1_reach_in[i,]) #adding to igraph object
  
  var1_reach_out_vec[i] <- mean(var1_reach_out[i,])
  V(var1)$var1_reach_out_vec[i] <- mean(var1_reach_out[i,]) #adding to igraph object
  
  var1_shortest.paths.in_vec[i] <- mean(var1_sp_in[i,])
  V(var1)$var1_shortest.paths.in_vec[i] <- mean(var1_sp_in[i,]) #adding to igraph object
  
  var1_shortest.paths.out_vec[i] <- mean(var1_sp_out[i,])
  V(var1)$var1_shortest.paths.out_vec[i] <- mean(var1_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var1_indegree,
var1_outdegree,
var1_totaldegree,
var1_incloseness,
var1_outcloseness,
var1_totalcloseness,
var1_betweenness,
var1_eigenvector,
var1_reach_in_vec, 
var1_reach_out_vec, 
var1_sp_in_vec, 
var1_sp_out_vec)

write.csv(var1_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var1_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var1 <- triad.census(var1)
triad_df_var1 <- data.frame(census_labels,tc_var1)
triad_df_var1
write.csv(triad_df_var1, 'var1_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var2
```{r}
#Centrality Degree  
V(var2)$indegree<-degree(var2, mode = "in")
V(var2)$outdegree <- degree(var2, mode = "out")
V(var2)$totaldegree <- degree(var2, mode = "total")

var2_indegree<-degree(var2, mode = "in")
var2_outdegree<-degree(var2, mode = "out")
var2_totaldegree<-degree(var2, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var2_indegree)
sd(var2_indegree)
##out
summary(var2_outdegree)
sd(var2_outdegree)
##all
summary(var2_totaldegree)
sd(var2_totaldegree)

#Closeness 
V(var2)$incloseness <- closeness(var2, mode = "in") #%>% round(6)
V(var2)$outcloseness <- closeness(var2, mode = "out") #%>% round(6)
V(var2)$totalcloseness <- closeness(var2, mode = "total") #%>% round(6)
var2_incloseness<- closeness(var2, mode = "in") #%>% round(6)
var2_outcloseness<- closeness(var2, mode = "out") #%>% round(6)
var2_totalcloseness<- closeness(var2, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var2_incloseness)
sd(var2_incloseness)
##out
summary(var2_outcloseness)
sd(var2_outcloseness)
##all
summary(var2_totalcloseness)
sd(var2_totalcloseness)

#Betweenness
V(var2)$betweenness <- betweenness(var2) %>% round(1)
var2_betweenness <- betweenness(var2) %>% round(1)

##all
summary(var2_betweenness)
sd(var2_betweenness)

#Eigen_Centrality
V(var2)$eigenvector <- eigen_centrality(var2, directed = TRUE) %$% vector %>% round(3)
var2_eigenvector <- eigen_centrality(var2, directed = TRUE) %$% vector %>% round(3)

#all
summary(var2_eigenvector)
sd(var2_eigenvector)

#Shortest Paths
var2_sp_in <- shortest.paths(var2, mode='in')
var2_sp_out <- shortest.paths(var2, mode='out')

#in
mean(var2_sp_in[which(var2_sp_in != Inf)])
sd(var2_sp_in[which(var2_sp_in != Inf)])
#out
mean(var2_sp_out[which(var2_sp_out != Inf)])
sd(var2_sp_out[which(var2_sp_out != Inf)])

#Reachability
var2_reach_in <- reachability(var2, 'in')
var2_reach_out <- reachability(var2, 'out')

#in
mean(var2_reach_in[which(var2_reach_in != Inf)])
sd(var2_reach_in[which(var2_reach_in != Inf)])
#out
mean(var2_reach_out[which(var2_reach_out != Inf)])
sd(var2_reach_out[which(var2_reach_out != Inf)])

# Density 
graph.density(var2)

# Reciprocity
reciprocity(var2)

# Transitivity
transitivity(var2)

#Triad Census
tc_var2 <- triad.census(var2)
triad_df <- data.frame(tc_var2)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var2_sp_in_vec <- vector()
var2_sp_out_vec <- vector()
var2_reach_in_vec <- vector()
var2_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var2))
  var2_reach_in_vec[i] <- mean(var2_reach_in[i,])
  V(var2)$var2_reach_in_vec[i] <- mean(var2_reach_in[i,]) #adding to igraph object
  
  var2_reach_out_vec[i] <- mean(var2_reach_out[i,])
  V(var2)$var2_reach_out_vec[i] <- mean(var2_reach_out[i,]) #adding to igraph object
  
  var2_shortest.paths.in_vec[i] <- mean(var2_sp_in[i,])
  V(var2)$var2_shortest.paths.in_vec[i] <- mean(var2_sp_in[i,]) #adding to igraph object
  
  var2_shortest.paths.out_vec[i] <- mean(var2_sp_out[i,])
  V(var2)$var2_shortest.paths.out_vec[i] <- mean(var2_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var2_indegree,
var2_outdegree,
var2_totaldegree,
var2_incloseness,
var2_outcloseness,
var2_totalcloseness,
var2_betweenness,
var2_eigenvector,
var2_reach_in_vec, 
var2_reach_out_vec, 
var2_sp_in_vec, 
var2_sp_out_vec)

write.csv(var2_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var2_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var2 <- triad.census(var2)
triad_df_var2 <- data.frame(census_labels,tc_var2)
triad_df_var2
write.csv(triad_df_var2, 'var2_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var3
```{r}
#Centrality Degree  
V(var3)$indegree<-degree(var3, mode = "in")
V(var3)$outdegree <- degree(var3, mode = "out")
V(var3)$totaldegree <- degree(var3, mode = "total")

var3_indegree<-degree(var3, mode = "in")
var3_outdegree<-degree(var3, mode = "out")
var3_totaldegree<-degree(var3, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var3_indegree)
sd(var3_indegree)
##out
summary(var3_outdegree)
sd(var3_outdegree)
##all
summary(var3_totaldegree)
sd(var3_totaldegree)

#Closeness 
V(var3)$incloseness <- closeness(var3, mode = "in") #%>% round(6)
V(var3)$outcloseness <- closeness(var3, mode = "out") #%>% round(6)
V(var3)$totalcloseness <- closeness(var3, mode = "total") #%>% round(6)
var3_incloseness<- closeness(var3, mode = "in") #%>% round(6)
var3_outcloseness<- closeness(var3, mode = "out") #%>% round(6)
var3_totalcloseness<- closeness(var3, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var3_incloseness)
sd(var3_incloseness)
##out
summary(var3_outcloseness)
sd(var3_outcloseness)
##all
summary(var3_totalcloseness)
sd(var3_totalcloseness)

#Betweenness
V(var3)$betweenness <- betweenness(var3) %>% round(1)
var3_betweenness <- betweenness(var3) %>% round(1)

##all
summary(var3_betweenness)
sd(var3_betweenness)

#Eigen_Centrality
V(var3)$eigenvector <- eigen_centrality(var3, directed = TRUE) %$% vector %>% round(3)
var3_eigenvector <- eigen_centrality(var3, directed = TRUE) %$% vector %>% round(3)

#all
summary(var3_eigenvector)
sd(var3_eigenvector)

#Shortest Paths
var3_sp_in <- shortest.paths(var3, mode='in')
var3_sp_out <- shortest.paths(var3, mode='out')

#in
mean(var3_sp_in[which(var3_sp_in != Inf)])
sd(var3_sp_in[which(var3_sp_in != Inf)])
#out
mean(var3_sp_out[which(var3_sp_out != Inf)])
sd(var3_sp_out[which(var3_sp_out != Inf)])

#Reachability
var3_reach_in <- reachability(var3, 'in')
var3_reach_out <- reachability(var3, 'out')

#in
mean(var3_reach_in[which(var3_reach_in != Inf)])
sd(var3_reach_in[which(var3_reach_in != Inf)])
#out
mean(var3_reach_out[which(var3_reach_out != Inf)])
sd(var3_reach_out[which(var3_reach_out != Inf)])

# Density 
graph.density(var3)

# Reciprocity
reciprocity(var3)

# Transitivity
transitivity(var3)

#Triad Census
tc_var3 <- triad.census(var3)
triad_df <- data.frame(tc_var3)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var3_sp_in_vec <- vector()
var3_sp_out_vec <- vector()
var3_reach_in_vec <- vector()
var3_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var3))
  var3_reach_in_vec[i] <- mean(var3_reach_in[i,])
  V(var3)$var3_reach_in_vec[i] <- mean(var3_reach_in[i,]) #adding to igraph object
  
  var3_reach_out_vec[i] <- mean(var3_reach_out[i,])
  V(var3)$var3_reach_out_vec[i] <- mean(var3_reach_out[i,]) #adding to igraph object
  
  var3_shortest.paths.in_vec[i] <- mean(var3_sp_in[i,])
  V(var3)$var3_shortest.paths.in_vec[i] <- mean(var3_sp_in[i,]) #adding to igraph object
  
  var3_shortest.paths.out_vec[i] <- mean(var3_sp_out[i,])
  V(var3)$var3_shortest.paths.out_vec[i] <- mean(var3_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var3_indegree,
var3_outdegree,
var3_totaldegree,
var3_incloseness,
var3_outcloseness,
var3_totalcloseness,
var3_betweenness,
var3_eigenvector,
var3_reach_in_vec, 
var3_reach_out_vec, 
var3_sp_in_vec, 
var3_sp_out_vec)

write.csv(var3_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var3_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var3 <- triad.census(var3)
triad_df_var3 <- data.frame(census_labels,tc_var3)
triad_df_var3
write.csv(triad_df_var3, 'var3_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var4
```{r}
#Centrality Degree  
V(var4)$indegree<-degree(var4, mode = "in")
V(var4)$outdegree <- degree(var4, mode = "out")
V(var4)$totaldegree <- degree(var4, mode = "total")

var4_indegree<-degree(var4, mode = "in")
var4_outdegree<-degree(var4, mode = "out")
var4_totaldegree<-degree(var4, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var4_indegree)
sd(var4_indegree)
##out
summary(var4_outdegree)
sd(var4_outdegree)
##all
summary(var4_totaldegree)
sd(var4_totaldegree)

#Closeness 
V(var4)$incloseness <- closeness(var4, mode = "in") #%>% round(6)
V(var4)$outcloseness <- closeness(var4, mode = "out") #%>% round(6)
V(var4)$totalcloseness <- closeness(var4, mode = "total") #%>% round(6)
var4_incloseness<- closeness(var4, mode = "in") #%>% round(6)
var4_outcloseness<- closeness(var4, mode = "out") #%>% round(6)
var4_totalcloseness<- closeness(var4, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var4_incloseness)
sd(var4_incloseness)
##out
summary(var4_outcloseness)
sd(var4_outcloseness)
##all
summary(var4_totalcloseness)
sd(var4_totalcloseness)

#Betweenness
V(var4)$betweenness <- betweenness(var4) %>% round(1)
var4_betweenness <- betweenness(var4) %>% round(1)

##all
summary(var4_betweenness)
sd(var4_betweenness)

#Eigen_Centrality
V(var4)$eigenvector <- eigen_centrality(var4, directed = TRUE) %$% vector %>% round(3)
var4_eigenvector <- eigen_centrality(var4, directed = TRUE) %$% vector %>% round(3)

#all
summary(var4_eigenvector)
sd(var4_eigenvector)

#Shortest Paths
var4_sp_in <- shortest.paths(var4, mode='in')
var4_sp_out <- shortest.paths(var4, mode='out')

#in
mean(var4_sp_in[which(var4_sp_in != Inf)])
sd(var4_sp_in[which(var4_sp_in != Inf)])
#out
mean(var4_sp_out[which(var4_sp_out != Inf)])
sd(var4_sp_out[which(var4_sp_out != Inf)])

#Reachability
var4_reach_in <- reachability(var4, 'in')
var4_reach_out <- reachability(var4, 'out')

#in
mean(var4_reach_in[which(var4_reach_in != Inf)])
sd(var4_reach_in[which(var4_reach_in != Inf)])
#out
mean(var4_reach_out[which(var4_reach_out != Inf)])
sd(var4_reach_out[which(var4_reach_out != Inf)])

# Density 
graph.density(var4)

# Reciprocity
reciprocity(var4)

# Transitivity
transitivity(var4)

#Triad Census
tc_var4 <- triad.census(var4)
triad_df <- data.frame(tc_var4)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var4_sp_in_vec <- vector()
var4_sp_out_vec <- vector()
var4_reach_in_vec <- vector()
var4_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var4))
  var4_reach_in_vec[i] <- mean(var4_reach_in[i,])
  V(var4)$var4_reach_in_vec[i] <- mean(var4_reach_in[i,]) #adding to igraph object
  
  var4_reach_out_vec[i] <- mean(var4_reach_out[i,])
  V(var4)$var4_reach_out_vec[i] <- mean(var4_reach_out[i,]) #adding to igraph object
  
  var4_shortest.paths.in_vec[i] <- mean(var4_sp_in[i,])
  V(var4)$var4_shortest.paths.in_vec[i] <- mean(var4_sp_in[i,]) #adding to igraph object
  
  var4_shortest.paths.out_vec[i] <- mean(var4_sp_out[i,])
  V(var4)$var4_shortest.paths.out_vec[i] <- mean(var4_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var4_indegree,
var4_outdegree,
var4_totaldegree,
var4_incloseness,
var4_outcloseness,
var4_totalcloseness,
var4_betweenness,
var4_eigenvector,
var4_reach_in_vec, 
var4_reach_out_vec, 
var4_sp_in_vec, 
var4_sp_out_vec)

write.csv(var4_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var4_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var4 <- triad.census(var4)
triad_df_var4 <- data.frame(census_labels,tc_var4)
triad_df_var4
write.csv(triad_df_var4, 'var4_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var5
```{r}
#Centrality Degree  
V(var5)$indegree<-degree(var5, mode = "in")
V(var5)$outdegree <- degree(var5, mode = "out")
V(var5)$totaldegree <- degree(var5, mode = "total")

var5_indegree<-degree(var5, mode = "in")
var5_outdegree<-degree(var5, mode = "out")
var5_totaldegree<-degree(var5, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var5_indegree)
sd(var5_indegree)
##out
summary(var5_outdegree)
sd(var5_outdegree)
##all
summary(var5_totaldegree)
sd(var5_totaldegree)

#Closeness 
V(var5)$incloseness <- closeness(var5, mode = "in") #%>% round(6)
V(var5)$outcloseness <- closeness(var5, mode = "out") #%>% round(6)
V(var5)$totalcloseness <- closeness(var5, mode = "total") #%>% round(6)
var5_incloseness<- closeness(var5, mode = "in") #%>% round(6)
var5_outcloseness<- closeness(var5, mode = "out") #%>% round(6)
var5_totalcloseness<- closeness(var5, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var5_incloseness)
sd(var5_incloseness)
##out
summary(var5_outcloseness)
sd(var5_outcloseness)
##all
summary(var5_totalcloseness)
sd(var5_totalcloseness)

#Betweenness
V(var5)$betweenness <- betweenness(var5) %>% round(1)
var5_betweenness <- betweenness(var5) %>% round(1)

##all
summary(var5_betweenness)
sd(var5_betweenness)

#Eigen_Centrality
V(var5)$eigenvector <- eigen_centrality(var5, directed = TRUE) %$% vector %>% round(3)
var5_eigenvector <- eigen_centrality(var5, directed = TRUE) %$% vector %>% round(3)

#all
summary(var5_eigenvector)
sd(var5_eigenvector)

#Shortest Paths
var5_sp_in <- shortest.paths(var5, mode='in')
var5_sp_out <- shortest.paths(var5, mode='out')

#in
mean(var5_sp_in[which(var5_sp_in != Inf)])
sd(var5_sp_in[which(var5_sp_in != Inf)])
#out
mean(var5_sp_out[which(var5_sp_out != Inf)])
sd(var5_sp_out[which(var5_sp_out != Inf)])

#Reachability
var5_reach_in <- reachability(var5, 'in')
var5_reach_out <- reachability(var5, 'out')

#in
mean(var5_reach_in[which(var5_reach_in != Inf)])
sd(var5_reach_in[which(var5_reach_in != Inf)])
#out
mean(var5_reach_out[which(var5_reach_out != Inf)])
sd(var5_reach_out[which(var5_reach_out != Inf)])

# Density 
graph.density(var5)

# Reciprocity
reciprocity(var5)

# Transitivity
transitivity(var5)

#Triad Census
tc_var5 <- triad.census(var5)
triad_df <- data.frame(tc_var5)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var5_sp_in_vec <- vector()
var5_sp_out_vec <- vector()
var5_reach_in_vec <- vector()
var5_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var5))
  var5_reach_in_vec[i] <- mean(var5_reach_in[i,])
  V(var5)$var5_reach_in_vec[i] <- mean(var5_reach_in[i,]) #adding to igraph object
  
  var5_reach_out_vec[i] <- mean(var5_reach_out[i,])
  V(var5)$var5_reach_out_vec[i] <- mean(var5_reach_out[i,]) #adding to igraph object
  
  var5_shortest.paths.in_vec[i] <- mean(var5_sp_in[i,])
  V(var5)$var5_shortest.paths.in_vec[i] <- mean(var5_sp_in[i,]) #adding to igraph object
  
  var5_shortest.paths.out_vec[i] <- mean(var5_sp_out[i,])
  V(var5)$var5_shortest.paths.out_vec[i] <- mean(var5_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var5_indegree,
var5_outdegree,
var5_totaldegree,
var5_incloseness,
var5_outcloseness,
var5_totalcloseness,
var5_betweenness,
var5_eigenvector,
var5_reach_in_vec, 
var5_reach_out_vec, 
var5_sp_in_vec, 
var5_sp_out_vec)

write.csv(var5_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var5_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var5 <- triad.census(var5)
triad_df_var5 <- data.frame(census_labels,tc_var5)
triad_df_var5
write.csv(triad_df_var5, 'var5_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var6
```{r}
#Centrality Degree  
V(var6)$indegree<-degree(var6, mode = "in")
V(var6)$outdegree <- degree(var6, mode = "out")
V(var6)$totaldegree <- degree(var6, mode = "total")

var6_indegree<-degree(var6, mode = "in")
var6_outdegree<-degree(var6, mode = "out")
var6_totaldegree<-degree(var6, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var6_indegree)
sd(var6_indegree)
##out
summary(var6_outdegree)
sd(var6_outdegree)
##all
summary(var6_totaldegree)
sd(var6_totaldegree)

#Closeness 
V(var6)$incloseness <- closeness(var6, mode = "in") #%>% round(6)
V(var6)$outcloseness <- closeness(var6, mode = "out") #%>% round(6)
V(var6)$totalcloseness <- closeness(var6, mode = "total") #%>% round(6)
var6_incloseness<- closeness(var6, mode = "in") #%>% round(6)
var6_outcloseness<- closeness(var6, mode = "out") #%>% round(6)
var6_totalcloseness<- closeness(var6, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var6_incloseness)
sd(var6_incloseness)
##out
summary(var6_outcloseness)
sd(var6_outcloseness)
##all
summary(var6_totalcloseness)
sd(var6_totalcloseness)

#Betweenness
V(var6)$betweenness <- betweenness(var6) %>% round(1)
var6_betweenness <- betweenness(var6) %>% round(1)

##all
summary(var6_betweenness)
sd(var6_betweenness)

#Eigen_Centrality
V(var6)$eigenvector <- eigen_centrality(var6, directed = TRUE) %$% vector %>% round(3)
var6_eigenvector <- eigen_centrality(var6, directed = TRUE) %$% vector %>% round(3)

#all
summary(var6_eigenvector)
sd(var6_eigenvector)

#Shortest Paths
var6_sp_in <- shortest.paths(var6, mode='in')
var6_sp_out <- shortest.paths(var6, mode='out')

#in
mean(var6_sp_in[which(var6_sp_in != Inf)])
sd(var6_sp_in[which(var6_sp_in != Inf)])
#out
mean(var6_sp_out[which(var6_sp_out != Inf)])
sd(var6_sp_out[which(var6_sp_out != Inf)])

#Reachability
var6_reach_in <- reachability(var6, 'in')
var6_reach_out <- reachability(var6, 'out')

#in
mean(var6_reach_in[which(var6_reach_in != Inf)])
sd(var6_reach_in[which(var6_reach_in != Inf)])
#out
mean(var6_reach_out[which(var6_reach_out != Inf)])
sd(var6_reach_out[which(var6_reach_out != Inf)])

# Density 
graph.density(var6)

# Reciprocity
reciprocity(var6)

# Transitivity
transitivity(var6)

#Triad Census
tc_var6 <- triad.census(var6)
triad_df <- data.frame(tc_var6)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var6_sp_in_vec <- vector()
var6_sp_out_vec <- vector()
var6_reach_in_vec <- vector()
var6_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var6))
  var6_reach_in_vec[i] <- mean(var6_reach_in[i,])
  V(var6)$var6_reach_in_vec[i] <- mean(var6_reach_in[i,]) #adding to igraph object
  
  var6_reach_out_vec[i] <- mean(var6_reach_out[i,])
  V(var6)$var6_reach_out_vec[i] <- mean(var6_reach_out[i,]) #adding to igraph object
  
  var6_shortest.paths.in_vec[i] <- mean(var6_sp_in[i,])
  V(var6)$var6_shortest.paths.in_vec[i] <- mean(var6_sp_in[i,]) #adding to igraph object
  
  var6_shortest.paths.out_vec[i] <- mean(var6_sp_out[i,])
  V(var6)$var6_shortest.paths.out_vec[i] <- mean(var6_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var6_indegree,
var6_outdegree,
var6_totaldegree,
var6_incloseness,
var6_outcloseness,
var6_totalcloseness,
var6_betweenness,
var6_eigenvector,
var6_reach_in_vec, 
var6_reach_out_vec, 
var6_sp_in_vec, 
var6_sp_out_vec)

write.csv(var6_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var6_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var6 <- triad.census(var6)
triad_df_var6 <- data.frame(census_labels,tc_var6)
triad_df_var6
write.csv(triad_df_var6, 'var6_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var7
```{r}
#Centrality Degree  
V(var7)$indegree<-degree(var7, mode = "in")
V(var7)$outdegree <- degree(var7, mode = "out")
V(var7)$totaldegree <- degree(var7, mode = "total")

var7_indegree<-degree(var7, mode = "in")
var7_outdegree<-degree(var7, mode = "out")
var7_totaldegree<-degree(var7, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var7_indegree)
sd(var7_indegree)
##out
summary(var7_outdegree)
sd(var7_outdegree)
##all
summary(var7_totaldegree)
sd(var7_totaldegree)

#Closeness 
V(var7)$incloseness <- closeness(var7, mode = "in") #%>% round(6)
V(var7)$outcloseness <- closeness(var7, mode = "out") #%>% round(6)
V(var7)$totalcloseness <- closeness(var7, mode = "total") #%>% round(6)
var7_incloseness<- closeness(var7, mode = "in") #%>% round(6)
var7_outcloseness<- closeness(var7, mode = "out") #%>% round(6)
var7_totalcloseness<- closeness(var7, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var7_incloseness)
sd(var7_incloseness)
##out
summary(var7_outcloseness)
sd(var7_outcloseness)
##all
summary(var7_totalcloseness)
sd(var7_totalcloseness)

#Betweenness
V(var7)$betweenness <- betweenness(var7) %>% round(1)
var7_betweenness <- betweenness(var7) %>% round(1)

##all
summary(var7_betweenness)
sd(var7_betweenness)

#Eigen_Centrality
V(var7)$eigenvector <- eigen_centrality(var7, directed = TRUE) %$% vector %>% round(3)
var7_eigenvector <- eigen_centrality(var7, directed = TRUE) %$% vector %>% round(3)

#all
summary(var7_eigenvector)
sd(var7_eigenvector)

#Shortest Paths
var7_sp_in <- shortest.paths(var7, mode='in')
var7_sp_out <- shortest.paths(var7, mode='out')

#in
mean(var7_sp_in[which(var7_sp_in != Inf)])
sd(var7_sp_in[which(var7_sp_in != Inf)])
#out
mean(var7_sp_out[which(var7_sp_out != Inf)])
sd(var7_sp_out[which(var7_sp_out != Inf)])

#Reachability
var7_reach_in <- reachability(var7, 'in')
var7_reach_out <- reachability(var7, 'out')

#in
mean(var7_reach_in[which(var7_reach_in != Inf)])
sd(var7_reach_in[which(var7_reach_in != Inf)])
#out
mean(var7_reach_out[which(var7_reach_out != Inf)])
sd(var7_reach_out[which(var7_reach_out != Inf)])

# Density 
graph.density(var7)

# Reciprocity
reciprocity(var7)

# Transitivity
transitivity(var7)

#Triad Census
tc_var7 <- triad.census(var7)
triad_df <- data.frame(tc_var7)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var7_sp_in_vec <- vector()
var7_sp_out_vec <- vector()
var7_reach_in_vec <- vector()
var7_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var7))
  var7_reach_in_vec[i] <- mean(var7_reach_in[i,])
  V(var7)$var7_reach_in_vec[i] <- mean(var7_reach_in[i,]) #adding to igraph object
  
  var7_reach_out_vec[i] <- mean(var7_reach_out[i,])
  V(var7)$var7_reach_out_vec[i] <- mean(var7_reach_out[i,]) #adding to igraph object
  
  var7_shortest.paths.in_vec[i] <- mean(var7_sp_in[i,])
  V(var7)$var7_shortest.paths.in_vec[i] <- mean(var7_sp_in[i,]) #adding to igraph object
  
  var7_shortest.paths.out_vec[i] <- mean(var7_sp_out[i,])
  V(var7)$var7_shortest.paths.out_vec[i] <- mean(var7_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var7_indegree,
var7_outdegree,
var7_totaldegree,
var7_incloseness,
var7_outcloseness,
var7_totalcloseness,
var7_betweenness,
var7_eigenvector,
var7_reach_in_vec, 
var7_reach_out_vec, 
var7_sp_in_vec, 
var7_sp_out_vec)

write.csv(var7_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var7_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var7 <- triad.census(var7)
triad_df_var7 <- data.frame(census_labels,tc_var7)
triad_df_var7
write.csv(triad_df_var7, 'var7_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var8
```{r}
#Centrality Degree  
V(var8)$indegree<-degree(var8, mode = "in")
V(var8)$outdegree <- degree(var8, mode = "out")
V(var8)$totaldegree <- degree(var8, mode = "total")

var8_indegree<-degree(var8, mode = "in")
var8_outdegree<-degree(var8, mode = "out")
var8_totaldegree<-degree(var8, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var8_indegree)
sd(var8_indegree)
##out
summary(var8_outdegree)
sd(var8_outdegree)
##all
summary(var8_totaldegree)
sd(var8_totaldegree)

#Closeness 
V(var8)$incloseness <- closeness(var8, mode = "in") #%>% round(6)
V(var8)$outcloseness <- closeness(var8, mode = "out") #%>% round(6)
V(var8)$totalcloseness <- closeness(var8, mode = "total") #%>% round(6)
var8_incloseness<- closeness(var8, mode = "in") #%>% round(6)
var8_outcloseness<- closeness(var8, mode = "out") #%>% round(6)
var8_totalcloseness<- closeness(var8, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var8_incloseness)
sd(var8_incloseness)
##out
summary(var8_outcloseness)
sd(var8_outcloseness)
##all
summary(var8_totalcloseness)
sd(var8_totalcloseness)

#Betweenness
V(var8)$betweenness <- betweenness(var8) %>% round(1)
var8_betweenness <- betweenness(var8) %>% round(1)

##all
summary(var8_betweenness)
sd(var8_betweenness)

#Eigen_Centrality
V(var8)$eigenvector <- eigen_centrality(var8, directed = TRUE) %$% vector %>% round(3)
var8_eigenvector <- eigen_centrality(var8, directed = TRUE) %$% vector %>% round(3)

#all
summary(var8_eigenvector)
sd(var8_eigenvector)

#Shortest Paths
var8_sp_in <- shortest.paths(var8, mode='in')
var8_sp_out <- shortest.paths(var8, mode='out')

#in
mean(var8_sp_in[which(var8_sp_in != Inf)])
sd(var8_sp_in[which(var8_sp_in != Inf)])
#out
mean(var8_sp_out[which(var8_sp_out != Inf)])
sd(var8_sp_out[which(var8_sp_out != Inf)])

#Reachability
var8_reach_in <- reachability(var8, 'in')
var8_reach_out <- reachability(var8, 'out')

#in
mean(var8_reach_in[which(var8_reach_in != Inf)])
sd(var8_reach_in[which(var8_reach_in != Inf)])
#out
mean(var8_reach_out[which(var8_reach_out != Inf)])
sd(var8_reach_out[which(var8_reach_out != Inf)])

# Density 
graph.density(var8)

# Reciprocity
reciprocity(var8)

# Transitivity
transitivity(var8)

#Triad Census
tc_var8 <- triad.census(var8)
triad_df <- data.frame(tc_var8)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var8_sp_in_vec <- vector()
var8_sp_out_vec <- vector()
var8_reach_in_vec <- vector()
var8_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var8))
  var8_reach_in_vec[i] <- mean(var8_reach_in[i,])
  V(var8)$var8_reach_in_vec[i] <- mean(var8_reach_in[i,]) #adding to igraph object
  
  var8_reach_out_vec[i] <- mean(var8_reach_out[i,])
  V(var8)$var8_reach_out_vec[i] <- mean(var8_reach_out[i,]) #adding to igraph object
  
  var8_shortest.paths.in_vec[i] <- mean(var8_sp_in[i,])
  V(var8)$var8_shortest.paths.in_vec[i] <- mean(var8_sp_in[i,]) #adding to igraph object
  
  var8_shortest.paths.out_vec[i] <- mean(var8_sp_out[i,])
  V(var8)$var8_shortest.paths.out_vec[i] <- mean(var8_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var8_indegree,
var8_outdegree,
var8_totaldegree,
var8_incloseness,
var8_outcloseness,
var8_totalcloseness,
var8_betweenness,
var8_eigenvector,
var8_reach_in_vec, 
var8_reach_out_vec, 
var8_sp_in_vec, 
var8_sp_out_vec)

write.csv(var8_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var8_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var8 <- triad.census(var8)
triad_df_var8 <- data.frame(census_labels,tc_var8)
triad_df_var8
write.csv(triad_df_var8, 'var8_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var9
```{r}
#Centrality Degree  
V(var9)$indegree<-degree(var9, mode = "in")
V(var9)$outdegree <- degree(var9, mode = "out")
V(var9)$totaldegree <- degree(var9, mode = "total")

var9_indegree<-degree(var9, mode = "in")
var9_outdegree<-degree(var9, mode = "out")
var9_totaldegree<-degree(var9, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var9_indegree)
sd(var9_indegree)
##out
summary(var9_outdegree)
sd(var9_outdegree)
##all
summary(var9_totaldegree)
sd(var9_totaldegree)

#Closeness 
V(var9)$incloseness <- closeness(var9, mode = "in") #%>% round(6)
V(var9)$outcloseness <- closeness(var9, mode = "out") #%>% round(6)
V(var9)$totalcloseness <- closeness(var9, mode = "total") #%>% round(6)
var9_incloseness<- closeness(var9, mode = "in") #%>% round(6)
var9_outcloseness<- closeness(var9, mode = "out") #%>% round(6)
var9_totalcloseness<- closeness(var9, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var9_incloseness)
sd(var9_incloseness)
##out
summary(var9_outcloseness)
sd(var9_outcloseness)
##all
summary(var9_totalcloseness)
sd(var9_totalcloseness)

#Betweenness
V(var9)$betweenness <- betweenness(var9) %>% round(1)
var9_betweenness <- betweenness(var9) %>% round(1)

##all
summary(var9_betweenness)
sd(var9_betweenness)

#Eigen_Centrality
V(var9)$eigenvector <- eigen_centrality(var9, directed = TRUE) %$% vector %>% round(3)
var9_eigenvector <- eigen_centrality(var9, directed = TRUE) %$% vector %>% round(3)

#all
summary(var9_eigenvector)
sd(var9_eigenvector)

#Shortest Paths
var9_sp_in <- shortest.paths(var9, mode='in')
var9_sp_out <- shortest.paths(var9, mode='out')

#in
mean(var9_sp_in[which(var9_sp_in != Inf)])
sd(var9_sp_in[which(var9_sp_in != Inf)])
#out
mean(var9_sp_out[which(var9_sp_out != Inf)])
sd(var9_sp_out[which(var9_sp_out != Inf)])

#Reachability
var9_reach_in <- reachability(var9, 'in')
var9_reach_out <- reachability(var9, 'out')

#in
mean(var9_reach_in[which(var9_reach_in != Inf)])
sd(var9_reach_in[which(var9_reach_in != Inf)])
#out
mean(var9_reach_out[which(var9_reach_out != Inf)])
sd(var9_reach_out[which(var9_reach_out != Inf)])

# Density 
graph.density(var9)

# Reciprocity
reciprocity(var9)

# Transitivity
transitivity(var9)

#Triad Census
tc_var9 <- triad.census(var9)
triad_df <- data.frame(tc_var9)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var9_sp_in_vec <- vector()
var9_sp_out_vec <- vector()
var9_reach_in_vec <- vector()
var9_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var9))
  var9_reach_in_vec[i] <- mean(var9_reach_in[i,])
  V(var9)$var9_reach_in_vec[i] <- mean(var9_reach_in[i,]) #adding to igraph object
  
  var9_reach_out_vec[i] <- mean(var9_reach_out[i,])
  V(var9)$var9_reach_out_vec[i] <- mean(var9_reach_out[i,]) #adding to igraph object
  
  var9_shortest.paths.in_vec[i] <- mean(var9_sp_in[i,])
  V(var9)$var9_shortest.paths.in_vec[i] <- mean(var9_sp_in[i,]) #adding to igraph object
  
  var9_shortest.paths.out_vec[i] <- mean(var9_sp_out[i,])
  V(var9)$var9_shortest.paths.out_vec[i] <- mean(var9_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var9_indegree,
var9_outdegree,
var9_totaldegree,
var9_incloseness,
var9_outcloseness,
var9_totalcloseness,
var9_betweenness,
var9_eigenvector,
var9_reach_in_vec, 
var9_reach_out_vec, 
var9_sp_in_vec, 
var9_sp_out_vec)

write.csv(var9_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var9_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var9 <- triad.census(var9)
triad_df_var9 <- data.frame(census_labels,tc_var9)
triad_df_var9
write.csv(triad_df_var9, 'var9_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var10
```{r}
#Centrality Degree  
V(var10)$indegree<-degree(var10, mode = "in")
V(var10)$outdegree <- degree(var10, mode = "out")
V(var10)$totaldegree <- degree(var10, mode = "total")

var10_indegree<-degree(var10, mode = "in")
var10_outdegree<-degree(var10, mode = "out")
var10_totaldegree<-degree(var10, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var10_indegree)
sd(var10_indegree)
##out
summary(var10_outdegree)
sd(var10_outdegree)
##all
summary(var10_totaldegree)
sd(var10_totaldegree)

#Closeness 
V(var10)$incloseness <- closeness(var10, mode = "in") #%>% round(6)
V(var10)$outcloseness <- closeness(var10, mode = "out") #%>% round(6)
V(var10)$totalcloseness <- closeness(var10, mode = "total") #%>% round(6)
var10_incloseness<- closeness(var10, mode = "in") #%>% round(6)
var10_outcloseness<- closeness(var10, mode = "out") #%>% round(6)
var10_totalcloseness<- closeness(var10, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var10_incloseness)
sd(var10_incloseness)
##out
summary(var10_outcloseness)
sd(var10_outcloseness)
##all
summary(var10_totalcloseness)
sd(var10_totalcloseness)

#Betweenness
V(var10)$betweenness <- betweenness(var10) %>% round(1)
var10_betweenness <- betweenness(var10) %>% round(1)

##all
summary(var10_betweenness)
sd(var10_betweenness)

#Eigen_Centrality
V(var10)$eigenvector <- eigen_centrality(var10, directed = TRUE) %$% vector %>% round(3)
var10_eigenvector <- eigen_centrality(var10, directed = TRUE) %$% vector %>% round(3)

#all
summary(var10_eigenvector)
sd(var10_eigenvector)

#Shortest Paths
var10_sp_in <- shortest.paths(var10, mode='in')
var10_sp_out <- shortest.paths(var10, mode='out')

#in
mean(var10_sp_in[which(var10_sp_in != Inf)])
sd(var10_sp_in[which(var10_sp_in != Inf)])
#out
mean(var10_sp_out[which(var10_sp_out != Inf)])
sd(var10_sp_out[which(var10_sp_out != Inf)])

#Reachability
var10_reach_in <- reachability(var10, 'in')
var10_reach_out <- reachability(var10, 'out')

#in
mean(var10_reach_in[which(var10_reach_in != Inf)])
sd(var10_reach_in[which(var10_reach_in != Inf)])
#out
mean(var10_reach_out[which(var10_reach_out != Inf)])
sd(var10_reach_out[which(var10_reach_out != Inf)])

# Density 
graph.density(var10)

# Reciprocity
reciprocity(var10)

# Transitivity
transitivity(var10)

#Triad Census
tc_var10 <- triad.census(var10)
triad_df <- data.frame(tc_var10)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var10_sp_in_vec <- vector()
var10_sp_out_vec <- vector()
var10_reach_in_vec <- vector()
var10_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var10))
  var10_reach_in_vec[i] <- mean(var10_reach_in[i,])
  V(var10)$var10_reach_in_vec[i] <- mean(var10_reach_in[i,]) #adding to igraph object
  
  var10_reach_out_vec[i] <- mean(var10_reach_out[i,])
  V(var10)$var10_reach_out_vec[i] <- mean(var10_reach_out[i,]) #adding to igraph object
  
  var10_shortest.paths.in_vec[i] <- mean(var10_sp_in[i,])
  V(var10)$var10_shortest.paths.in_vec[i] <- mean(var10_sp_in[i,]) #adding to igraph object
  
  var10_shortest.paths.out_vec[i] <- mean(var10_sp_out[i,])
  V(var10)$var10_shortest.paths.out_vec[i] <- mean(var10_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var10_indegree,
var10_outdegree,
var10_totaldegree,
var10_incloseness,
var10_outcloseness,
var10_totalcloseness,
var10_betweenness,
var10_eigenvector,
var10_reach_in_vec, 
var10_reach_out_vec, 
var10_sp_in_vec, 
var10_sp_out_vec)

write.csv(var10_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var10_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var10 <- triad.census(var10)
triad_df_var10 <- data.frame(census_labels,tc_var10)
triad_df_var10
write.csv(triad_df_var10, 'var10_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var11
```{r}
#Centrality Degree  
V(var11)$indegree<-degree(var11, mode = "in")
V(var11)$outdegree <- degree(var11, mode = "out")
V(var11)$totaldegree <- degree(var11, mode = "total")

var11_indegree<-degree(var11, mode = "in")
var11_outdegree<-degree(var11, mode = "out")
var11_totaldegree<-degree(var11, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var11_indegree)
sd(var11_indegree)
##out
summary(var11_outdegree)
sd(var11_outdegree)
##all
summary(var11_totaldegree)
sd(var11_totaldegree)

#Closeness 
V(var11)$incloseness <- closeness(var11, mode = "in") #%>% round(6)
V(var11)$outcloseness <- closeness(var11, mode = "out") #%>% round(6)
V(var11)$totalcloseness <- closeness(var11, mode = "total") #%>% round(6)
var11_incloseness<- closeness(var11, mode = "in") #%>% round(6)
var11_outcloseness<- closeness(var11, mode = "out") #%>% round(6)
var11_totalcloseness<- closeness(var11, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var11_incloseness)
sd(var11_incloseness)
##out
summary(var11_outcloseness)
sd(var11_outcloseness)
##all
summary(var11_totalcloseness)
sd(var11_totalcloseness)

#Betweenness
V(var11)$betweenness <- betweenness(var11) %>% round(1)
var11_betweenness <- betweenness(var11) %>% round(1)

##all
summary(var11_betweenness)
sd(var11_betweenness)

#Eigen_Centrality
V(var11)$eigenvector <- eigen_centrality(var11, directed = TRUE) %$% vector %>% round(3)
var11_eigenvector <- eigen_centrality(var11, directed = TRUE) %$% vector %>% round(3)

#all
summary(var11_eigenvector)
sd(var11_eigenvector)

#Shortest Paths
var11_sp_in <- shortest.paths(var11, mode='in')
var11_sp_out <- shortest.paths(var11, mode='out')

#in
mean(var11_sp_in[which(var11_sp_in != Inf)])
sd(var11_sp_in[which(var11_sp_in != Inf)])
#out
mean(var11_sp_out[which(var11_sp_out != Inf)])
sd(var11_sp_out[which(var11_sp_out != Inf)])

#Reachability
var11_reach_in <- reachability(var11, 'in')
var11_reach_out <- reachability(var11, 'out')

#in
mean(var11_reach_in[which(var11_reach_in != Inf)])
sd(var11_reach_in[which(var11_reach_in != Inf)])
#out
mean(var11_reach_out[which(var11_reach_out != Inf)])
sd(var11_reach_out[which(var11_reach_out != Inf)])

# Density 
graph.density(var11)

# Reciprocity
reciprocity(var11)

# Transitivity
transitivity(var11)

#Triad Census
tc_var11 <- triad.census(var11)
triad_df <- data.frame(tc_var11)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var11_sp_in_vec <- vector()
var11_sp_out_vec <- vector()
var11_reach_in_vec <- vector()
var11_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var11))
  var11_reach_in_vec[i] <- mean(var11_reach_in[i,])
  V(var11)$var11_reach_in_vec[i] <- mean(var11_reach_in[i,]) #adding to igraph object
  
  var11_reach_out_vec[i] <- mean(var11_reach_out[i,])
  V(var11)$var11_reach_out_vec[i] <- mean(var11_reach_out[i,]) #adding to igraph object
  
  var11_shortest.paths.in_vec[i] <- mean(var11_sp_in[i,])
  V(var11)$var11_shortest.paths.in_vec[i] <- mean(var11_sp_in[i,]) #adding to igraph object
  
  var11_shortest.paths.out_vec[i] <- mean(var11_sp_out[i,])
  V(var11)$var11_shortest.paths.out_vec[i] <- mean(var11_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var11_indegree,
var11_outdegree,
var11_totaldegree,
var11_incloseness,
var11_outcloseness,
var11_totalcloseness,
var11_betweenness,
var11_eigenvector,
var11_reach_in_vec, 
var11_reach_out_vec, 
var11_sp_in_vec, 
var11_sp_out_vec)

write.csv(var11_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var11_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var11 <- triad.census(var11)
triad_df_var11 <- data.frame(census_labels,tc_var11)
triad_df_var11
write.csv(triad_df_var11, 'var11_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var12
```{r}
#Centrality Degree  
V(var12)$indegree<-degree(var12, mode = "in")
V(var12)$outdegree <- degree(var12, mode = "out")
V(var12)$totaldegree <- degree(var12, mode = "total")

var12_indegree<-degree(var12, mode = "in")
var12_outdegree<-degree(var12, mode = "out")
var12_totaldegree<-degree(var12, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var12_indegree)
sd(var12_indegree)
##out
summary(var12_outdegree)
sd(var12_outdegree)
##all
summary(var12_totaldegree)
sd(var12_totaldegree)

#Closeness 
V(var12)$incloseness <- closeness(var12, mode = "in") #%>% round(6)
V(var12)$outcloseness <- closeness(var12, mode = "out") #%>% round(6)
V(var12)$totalcloseness <- closeness(var12, mode = "total") #%>% round(6)
var12_incloseness<- closeness(var12, mode = "in") #%>% round(6)
var12_outcloseness<- closeness(var12, mode = "out") #%>% round(6)
var12_totalcloseness<- closeness(var12, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var12_incloseness)
sd(var12_incloseness)
##out
summary(var12_outcloseness)
sd(var12_outcloseness)
##all
summary(var12_totalcloseness)
sd(var12_totalcloseness)

#Betweenness
V(var12)$betweenness <- betweenness(var12) %>% round(1)
var12_betweenness <- betweenness(var12) %>% round(1)

##all
summary(var12_betweenness)
sd(var12_betweenness)

#Eigen_Centrality
V(var12)$eigenvector <- eigen_centrality(var12, directed = TRUE) %$% vector %>% round(3)
var12_eigenvector <- eigen_centrality(var12, directed = TRUE) %$% vector %>% round(3)

#all
summary(var12_eigenvector)
sd(var12_eigenvector)

#Shortest Paths
var12_sp_in <- shortest.paths(var12, mode='in')
var12_sp_out <- shortest.paths(var12, mode='out')

#in
mean(var12_sp_in[which(var12_sp_in != Inf)])
sd(var12_sp_in[which(var12_sp_in != Inf)])
#out
mean(var12_sp_out[which(var12_sp_out != Inf)])
sd(var12_sp_out[which(var12_sp_out != Inf)])

#Reachability
var12_reach_in <- reachability(var12, 'in')
var12_reach_out <- reachability(var12, 'out')

#in
mean(var12_reach_in[which(var12_reach_in != Inf)])
sd(var12_reach_in[which(var12_reach_in != Inf)])
#out
mean(var12_reach_out[which(var12_reach_out != Inf)])
sd(var12_reach_out[which(var12_reach_out != Inf)])

# Density 
graph.density(var12)

# Reciprocity
reciprocity(var12)

# Transitivity
transitivity(var12)

#Triad Census
tc_var12 <- triad.census(var12)
triad_df <- data.frame(tc_var12)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var12_sp_in_vec <- vector()
var12_sp_out_vec <- vector()
var12_reach_in_vec <- vector()
var12_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var12))
  var12_reach_in_vec[i] <- mean(var12_reach_in[i,])
  V(var12)$var12_reach_in_vec[i] <- mean(var12_reach_in[i,]) #adding to igraph object
  
  var12_reach_out_vec[i] <- mean(var12_reach_out[i,])
  V(var12)$var12_reach_out_vec[i] <- mean(var12_reach_out[i,]) #adding to igraph object
  
  var12_shortest.paths.in_vec[i] <- mean(var12_sp_in[i,])
  V(var12)$var12_shortest.paths.in_vec[i] <- mean(var12_sp_in[i,]) #adding to igraph object
  
  var12_shortest.paths.out_vec[i] <- mean(var12_sp_out[i,])
  V(var12)$var12_shortest.paths.out_vec[i] <- mean(var12_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var12_indegree,
var12_outdegree,
var12_totaldegree,
var12_incloseness,
var12_outcloseness,
var12_totalcloseness,
var12_betweenness,
var12_eigenvector,
var12_reach_in_vec, 
var12_reach_out_vec, 
var12_sp_in_vec, 
var12_sp_out_vec)

write.csv(var12_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var12_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var12 <- triad.census(var12)
triad_df_var12 <- data.frame(census_labels,tc_var12)
triad_df_var12
write.csv(triad_df_var12, 'var12_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var13
```{r}
#Centrality Degree  
V(var13)$indegree<-degree(var13, mode = "in")
V(var13)$outdegree <- degree(var13, mode = "out")
V(var13)$totaldegree <- degree(var13, mode = "total")

var13_indegree<-degree(var13, mode = "in")
var13_outdegree<-degree(var13, mode = "out")
var13_totaldegree<-degree(var13, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var13_indegree)
sd(var13_indegree)
##out
summary(var13_outdegree)
sd(var13_outdegree)
##all
summary(var13_totaldegree)
sd(var13_totaldegree)

#Closeness 
V(var13)$incloseness <- closeness(var13, mode = "in") #%>% round(6)
V(var13)$outcloseness <- closeness(var13, mode = "out") #%>% round(6)
V(var13)$totalcloseness <- closeness(var13, mode = "total") #%>% round(6)
var13_incloseness<- closeness(var13, mode = "in") #%>% round(6)
var13_outcloseness<- closeness(var13, mode = "out") #%>% round(6)
var13_totalcloseness<- closeness(var13, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var13_incloseness)
sd(var13_incloseness)
##out
summary(var13_outcloseness)
sd(var13_outcloseness)
##all
summary(var13_totalcloseness)
sd(var13_totalcloseness)

#Betweenness
V(var13)$betweenness <- betweenness(var13) %>% round(1)
var13_betweenness <- betweenness(var13) %>% round(1)

##all
summary(var13_betweenness)
sd(var13_betweenness)

#Eigen_Centrality
V(var13)$eigenvector <- eigen_centrality(var13, directed = TRUE) %$% vector %>% round(3)
var13_eigenvector <- eigen_centrality(var13, directed = TRUE) %$% vector %>% round(3)

#all
summary(var13_eigenvector)
sd(var13_eigenvector)

#Shortest Paths
var13_sp_in <- shortest.paths(var13, mode='in')
var13_sp_out <- shortest.paths(var13, mode='out')

#in
mean(var13_sp_in[which(var13_sp_in != Inf)])
sd(var13_sp_in[which(var13_sp_in != Inf)])
#out
mean(var13_sp_out[which(var13_sp_out != Inf)])
sd(var13_sp_out[which(var13_sp_out != Inf)])

#Reachability
var13_reach_in <- reachability(var13, 'in')
var13_reach_out <- reachability(var13, 'out')

#in
mean(var13_reach_in[which(var13_reach_in != Inf)])
sd(var13_reach_in[which(var13_reach_in != Inf)])
#out
mean(var13_reach_out[which(var13_reach_out != Inf)])
sd(var13_reach_out[which(var13_reach_out != Inf)])

# Density 
graph.density(var13)

# Reciprocity
reciprocity(var13)

# Transitivity
transitivity(var13)

#Triad Census
tc_var13 <- triad.census(var13)
triad_df <- data.frame(tc_var13)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var13_sp_in_vec <- vector()
var13_sp_out_vec <- vector()
var13_reach_in_vec <- vector()
var13_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var13))
  var13_reach_in_vec[i] <- mean(var13_reach_in[i,])
  V(var13)$var13_reach_in_vec[i] <- mean(var13_reach_in[i,]) #adding to igraph object
  
  var13_reach_out_vec[i] <- mean(var13_reach_out[i,])
  V(var13)$var13_reach_out_vec[i] <- mean(var13_reach_out[i,]) #adding to igraph object
  
  var13_shortest.paths.in_vec[i] <- mean(var13_sp_in[i,])
  V(var13)$var13_shortest.paths.in_vec[i] <- mean(var13_sp_in[i,]) #adding to igraph object
  
  var13_shortest.paths.out_vec[i] <- mean(var13_sp_out[i,])
  V(var13)$var13_shortest.paths.out_vec[i] <- mean(var13_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var13_indegree,
var13_outdegree,
var13_totaldegree,
var13_incloseness,
var13_outcloseness,
var13_totalcloseness,
var13_betweenness,
var13_eigenvector,
var13_reach_in_vec, 
var13_reach_out_vec, 
var13_sp_in_vec, 
var13_sp_out_vec)

write.csv(var13_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var13_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var13 <- triad.census(var13)
triad_df_var13 <- data.frame(census_labels,tc_var13)
triad_df_var13
write.csv(triad_df_var13, 'var13_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var14
```{r}
#Centrality Degree  
V(var14)$indegree<-degree(var14, mode = "in")
V(var14)$outdegree <- degree(var14, mode = "out")
V(var14)$totaldegree <- degree(var14, mode = "total")

var14_indegree<-degree(var14, mode = "in")
var14_outdegree<-degree(var14, mode = "out")
var14_totaldegree<-degree(var14, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var14_indegree)
sd(var14_indegree)
##out
summary(var14_outdegree)
sd(var14_outdegree)
##all
summary(var14_totaldegree)
sd(var14_totaldegree)

#Closeness 
V(var14)$incloseness <- closeness(var14, mode = "in") #%>% round(6)
V(var14)$outcloseness <- closeness(var14, mode = "out") #%>% round(6)
V(var14)$totalcloseness <- closeness(var14, mode = "total") #%>% round(6)
var14_incloseness<- closeness(var14, mode = "in") #%>% round(6)
var14_outcloseness<- closeness(var14, mode = "out") #%>% round(6)
var14_totalcloseness<- closeness(var14, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var14_incloseness)
sd(var14_incloseness)
##out
summary(var14_outcloseness)
sd(var14_outcloseness)
##all
summary(var14_totalcloseness)
sd(var14_totalcloseness)

#Betweenness
V(var14)$betweenness <- betweenness(var14) %>% round(1)
var14_betweenness <- betweenness(var14) %>% round(1)

##all
summary(var14_betweenness)
sd(var14_betweenness)

#Eigen_Centrality
V(var14)$eigenvector <- eigen_centrality(var14, directed = TRUE) %$% vector %>% round(3)
var14_eigenvector <- eigen_centrality(var14, directed = TRUE) %$% vector %>% round(3)

#all
summary(var14_eigenvector)
sd(var14_eigenvector)

#Shortest Paths
var14_sp_in <- shortest.paths(var14, mode='in')
var14_sp_out <- shortest.paths(var14, mode='out')

#in
mean(var14_sp_in[which(var14_sp_in != Inf)])
sd(var14_sp_in[which(var14_sp_in != Inf)])
#out
mean(var14_sp_out[which(var14_sp_out != Inf)])
sd(var14_sp_out[which(var14_sp_out != Inf)])

#Reachability
var14_reach_in <- reachability(var14, 'in')
var14_reach_out <- reachability(var14, 'out')

#in
mean(var14_reach_in[which(var14_reach_in != Inf)])
sd(var14_reach_in[which(var14_reach_in != Inf)])
#out
mean(var14_reach_out[which(var14_reach_out != Inf)])
sd(var14_reach_out[which(var14_reach_out != Inf)])

# Density 
graph.density(var14)

# Reciprocity
reciprocity(var14)

# Transitivity
transitivity(var14)

#Triad Census
tc_var14 <- triad.census(var14)
triad_df <- data.frame(tc_var14)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var14_sp_in_vec <- vector()
var14_sp_out_vec <- vector()
var14_reach_in_vec <- vector()
var14_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var14))
  var14_reach_in_vec[i] <- mean(var14_reach_in[i,])
  V(var14)$var14_reach_in_vec[i] <- mean(var14_reach_in[i,]) #adding to igraph object
  
  var14_reach_out_vec[i] <- mean(var14_reach_out[i,])
  V(var14)$var14_reach_out_vec[i] <- mean(var14_reach_out[i,]) #adding to igraph object
  
  var14_shortest.paths.in_vec[i] <- mean(var14_sp_in[i,])
  V(var14)$var14_shortest.paths.in_vec[i] <- mean(var14_sp_in[i,]) #adding to igraph object
  
  var14_shortest.paths.out_vec[i] <- mean(var14_sp_out[i,])
  V(var14)$var14_shortest.paths.out_vec[i] <- mean(var14_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var14_indegree,
var14_outdegree,
var14_totaldegree,
var14_incloseness,
var14_outcloseness,
var14_totalcloseness,
var14_betweenness,
var14_eigenvector,
var14_reach_in_vec, 
var14_reach_out_vec, 
var14_sp_in_vec, 
var14_sp_out_vec)

write.csv(var14_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var14_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var14 <- triad.census(var14)
triad_df_var14 <- data.frame(census_labels,tc_var14)
triad_df_var14
write.csv(triad_df_var14, 'var14_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var15
```{r}
#Centrality Degree  
V(var15)$indegree<-degree(var15, mode = "in")
V(var15)$outdegree <- degree(var15, mode = "out")
V(var15)$totaldegree <- degree(var15, mode = "total")

var15_indegree<-degree(var15, mode = "in")
var15_outdegree<-degree(var15, mode = "out")
var15_totaldegree<-degree(var15, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var15_indegree)
sd(var15_indegree)
##out
summary(var15_outdegree)
sd(var15_outdegree)
##all
summary(var15_totaldegree)
sd(var15_totaldegree)

#Closeness 
V(var15)$incloseness <- closeness(var15, mode = "in") #%>% round(6)
V(var15)$outcloseness <- closeness(var15, mode = "out") #%>% round(6)
V(var15)$totalcloseness <- closeness(var15, mode = "total") #%>% round(6)
var15_incloseness<- closeness(var15, mode = "in") #%>% round(6)
var15_outcloseness<- closeness(var15, mode = "out") #%>% round(6)
var15_totalcloseness<- closeness(var15, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var15_incloseness)
sd(var15_incloseness)
##out
summary(var15_outcloseness)
sd(var15_outcloseness)
##all
summary(var15_totalcloseness)
sd(var15_totalcloseness)

#Betweenness
V(var15)$betweenness <- betweenness(var15) %>% round(1)
var15_betweenness <- betweenness(var15) %>% round(1)

##all
summary(var15_betweenness)
sd(var15_betweenness)

#Eigen_Centrality
V(var15)$eigenvector <- eigen_centrality(var15, directed = TRUE) %$% vector %>% round(3)
var15_eigenvector <- eigen_centrality(var15, directed = TRUE) %$% vector %>% round(3)

#all
summary(var15_eigenvector)
sd(var15_eigenvector)

#Shortest Paths
var15_sp_in <- shortest.paths(var15, mode='in')
var15_sp_out <- shortest.paths(var15, mode='out')

#in
mean(var15_sp_in[which(var15_sp_in != Inf)])
sd(var15_sp_in[which(var15_sp_in != Inf)])
#out
mean(var15_sp_out[which(var15_sp_out != Inf)])
sd(var15_sp_out[which(var15_sp_out != Inf)])

#Reachability
var15_reach_in <- reachability(var15, 'in')
var15_reach_out <- reachability(var15, 'out')

#in
mean(var15_reach_in[which(var15_reach_in != Inf)])
sd(var15_reach_in[which(var15_reach_in != Inf)])
#out
mean(var15_reach_out[which(var15_reach_out != Inf)])
sd(var15_reach_out[which(var15_reach_out != Inf)])

# Density 
graph.density(var15)

# Reciprocity
reciprocity(var15)

# Transitivity
transitivity(var15)

#Triad Census
tc_var15 <- triad.census(var15)
triad_df <- data.frame(tc_var15)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var15_sp_in_vec <- vector()
var15_sp_out_vec <- vector()
var15_reach_in_vec <- vector()
var15_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var15))
  var15_reach_in_vec[i] <- mean(var15_reach_in[i,])
  V(var15)$var15_reach_in_vec[i] <- mean(var15_reach_in[i,]) #adding to igraph object
  
  var15_reach_out_vec[i] <- mean(var15_reach_out[i,])
  V(var15)$var15_reach_out_vec[i] <- mean(var15_reach_out[i,]) #adding to igraph object
  
  var15_shortest.paths.in_vec[i] <- mean(var15_sp_in[i,])
  V(var15)$var15_shortest.paths.in_vec[i] <- mean(var15_sp_in[i,]) #adding to igraph object
  
  var15_shortest.paths.out_vec[i] <- mean(var15_sp_out[i,])
  V(var15)$var15_shortest.paths.out_vec[i] <- mean(var15_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var15_indegree,
var15_outdegree,
var15_totaldegree,
var15_incloseness,
var15_outcloseness,
var15_totalcloseness,
var15_betweenness,
var15_eigenvector,
var15_reach_in_vec, 
var15_reach_out_vec, 
var15_sp_in_vec, 
var15_sp_out_vec)

write.csv(var15_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var15_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var15 <- triad.census(var15)
triad_df_var15 <- data.frame(census_labels,tc_var15)
triad_df_var15
write.csv(triad_df_var15, 'var15_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var16
```{r}
#Centrality Degree  
V(var16)$indegree<-degree(var16, mode = "in")
V(var16)$outdegree <- degree(var16, mode = "out")
V(var16)$totaldegree <- degree(var16, mode = "total")

var16_indegree<-degree(var16, mode = "in")
var16_outdegree<-degree(var16, mode = "out")
var16_totaldegree<-degree(var16, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var16_indegree)
sd(var16_indegree)
##out
summary(var16_outdegree)
sd(var16_outdegree)
##all
summary(var16_totaldegree)
sd(var16_totaldegree)

#Closeness 
V(var16)$incloseness <- closeness(var16, mode = "in") #%>% round(6)
V(var16)$outcloseness <- closeness(var16, mode = "out") #%>% round(6)
V(var16)$totalcloseness <- closeness(var16, mode = "total") #%>% round(6)
var16_incloseness<- closeness(var16, mode = "in") #%>% round(6)
var16_outcloseness<- closeness(var16, mode = "out") #%>% round(6)
var16_totalcloseness<- closeness(var16, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var16_incloseness)
sd(var16_incloseness)
##out
summary(var16_outcloseness)
sd(var16_outcloseness)
##all
summary(var16_totalcloseness)
sd(var16_totalcloseness)

#Betweenness
V(var16)$betweenness <- betweenness(var16) %>% round(1)
var16_betweenness <- betweenness(var16) %>% round(1)

##all
summary(var16_betweenness)
sd(var16_betweenness)

#Eigen_Centrality
V(var16)$eigenvector <- eigen_centrality(var16, directed = TRUE) %$% vector %>% round(3)
var16_eigenvector <- eigen_centrality(var16, directed = TRUE) %$% vector %>% round(3)

#all
summary(var16_eigenvector)
sd(var16_eigenvector)

#Shortest Paths
var16_sp_in <- shortest.paths(var16, mode='in')
var16_sp_out <- shortest.paths(var16, mode='out')

#in
mean(var16_sp_in[which(var16_sp_in != Inf)])
sd(var16_sp_in[which(var16_sp_in != Inf)])
#out
mean(var16_sp_out[which(var16_sp_out != Inf)])
sd(var16_sp_out[which(var16_sp_out != Inf)])

#Reachability
var16_reach_in <- reachability(var16, 'in')
var16_reach_out <- reachability(var16, 'out')

#in
mean(var16_reach_in[which(var16_reach_in != Inf)])
sd(var16_reach_in[which(var16_reach_in != Inf)])
#out
mean(var16_reach_out[which(var16_reach_out != Inf)])
sd(var16_reach_out[which(var16_reach_out != Inf)])

# Density 
graph.density(var16)

# Reciprocity
reciprocity(var16)

# Transitivity
transitivity(var16)

#Triad Census
tc_var16 <- triad.census(var16)
triad_df <- data.frame(tc_var16)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var16_sp_in_vec <- vector()
var16_sp_out_vec <- vector()
var16_reach_in_vec <- vector()
var16_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var16))
  var16_reach_in_vec[i] <- mean(var16_reach_in[i,])
  V(var16)$var16_reach_in_vec[i] <- mean(var16_reach_in[i,]) #adding to igraph object
  
  var16_reach_out_vec[i] <- mean(var16_reach_out[i,])
  V(var16)$var16_reach_out_vec[i] <- mean(var16_reach_out[i,]) #adding to igraph object
  
  var16_shortest.paths.in_vec[i] <- mean(var16_sp_in[i,])
  V(var16)$var16_shortest.paths.in_vec[i] <- mean(var16_sp_in[i,]) #adding to igraph object
  
  var16_shortest.paths.out_vec[i] <- mean(var16_sp_out[i,])
  V(var16)$var16_shortest.paths.out_vec[i] <- mean(var16_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var16_indegree,
var16_outdegree,
var16_totaldegree,
var16_incloseness,
var16_outcloseness,
var16_totalcloseness,
var16_betweenness,
var16_eigenvector,
var16_reach_in_vec, 
var16_reach_out_vec, 
var16_sp_in_vec, 
var16_sp_out_vec)

write.csv(var16_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var16_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var16 <- triad.census(var16)
triad_df_var16 <- data.frame(census_labels,tc_var16)
triad_df_var16
write.csv(triad_df_var16, 'var16_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var17
```{r}
#Centrality Degree  
V(var17)$indegree<-degree(var17, mode = "in")
V(var17)$outdegree <- degree(var17, mode = "out")
V(var17)$totaldegree <- degree(var17, mode = "total")

var17_indegree<-degree(var17, mode = "in")
var17_outdegree<-degree(var17, mode = "out")
var17_totaldegree<-degree(var17, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var17_indegree)
sd(var17_indegree)
##out
summary(var17_outdegree)
sd(var17_outdegree)
##all
summary(var17_totaldegree)
sd(var17_totaldegree)

#Closeness 
V(var17)$incloseness <- closeness(var17, mode = "in") #%>% round(6)
V(var17)$outcloseness <- closeness(var17, mode = "out") #%>% round(6)
V(var17)$totalcloseness <- closeness(var17, mode = "total") #%>% round(6)
var17_incloseness<- closeness(var17, mode = "in") #%>% round(6)
var17_outcloseness<- closeness(var17, mode = "out") #%>% round(6)
var17_totalcloseness<- closeness(var17, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var17_incloseness)
sd(var17_incloseness)
##out
summary(var17_outcloseness)
sd(var17_outcloseness)
##all
summary(var17_totalcloseness)
sd(var17_totalcloseness)

#Betweenness
V(var17)$betweenness <- betweenness(var17) %>% round(1)
var17_betweenness <- betweenness(var17) %>% round(1)

##all
summary(var17_betweenness)
sd(var17_betweenness)

#Eigen_Centrality
V(var17)$eigenvector <- eigen_centrality(var17, directed = TRUE) %$% vector %>% round(3)
var17_eigenvector <- eigen_centrality(var17, directed = TRUE) %$% vector %>% round(3)

#all
summary(var17_eigenvector)
sd(var17_eigenvector)

#Shortest Paths
var17_sp_in <- shortest.paths(var17, mode='in')
var17_sp_out <- shortest.paths(var17, mode='out')

#in
mean(var17_sp_in[which(var17_sp_in != Inf)])
sd(var17_sp_in[which(var17_sp_in != Inf)])
#out
mean(var17_sp_out[which(var17_sp_out != Inf)])
sd(var17_sp_out[which(var17_sp_out != Inf)])

#Reachability
var17_reach_in <- reachability(var17, 'in')
var17_reach_out <- reachability(var17, 'out')

#in
mean(var17_reach_in[which(var17_reach_in != Inf)])
sd(var17_reach_in[which(var17_reach_in != Inf)])
#out
mean(var17_reach_out[which(var17_reach_out != Inf)])
sd(var17_reach_out[which(var17_reach_out != Inf)])

# Density 
graph.density(var17)

# Reciprocity
reciprocity(var17)

# Transitivity
transitivity(var17)

#Triad Census
tc_var17 <- triad.census(var17)
triad_df <- data.frame(tc_var17)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var17_sp_in_vec <- vector()
var17_sp_out_vec <- vector()
var17_reach_in_vec <- vector()
var17_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var17))
  var17_reach_in_vec[i] <- mean(var17_reach_in[i,])
  V(var17)$var17_reach_in_vec[i] <- mean(var17_reach_in[i,]) #adding to igraph object
  
  var17_reach_out_vec[i] <- mean(var17_reach_out[i,])
  V(var17)$var17_reach_out_vec[i] <- mean(var17_reach_out[i,]) #adding to igraph object
  
  var17_shortest.paths.in_vec[i] <- mean(var17_sp_in[i,])
  V(var17)$var17_shortest.paths.in_vec[i] <- mean(var17_sp_in[i,]) #adding to igraph object
  
  var17_shortest.paths.out_vec[i] <- mean(var17_sp_out[i,])
  V(var17)$var17_shortest.paths.out_vec[i] <- mean(var17_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var17_indegree,
var17_outdegree,
var17_totaldegree,
var17_incloseness,
var17_outcloseness,
var17_totalcloseness,
var17_betweenness,
var17_eigenvector,
var17_reach_in_vec, 
var17_reach_out_vec, 
var17_sp_in_vec, 
var17_sp_out_vec)

write.csv(var17_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var17_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var17 <- triad.census(var17)
triad_df_var17 <- data.frame(census_labels,tc_var17)
triad_df_var17
write.csv(triad_df_var17, 'var17_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var18
```{r}
#Centrality Degree  
V(var18)$indegree<-degree(var18, mode = "in")
V(var18)$outdegree <- degree(var18, mode = "out")
V(var18)$totaldegree <- degree(var18, mode = "total")

var18_indegree<-degree(var18, mode = "in")
var18_outdegree<-degree(var18, mode = "out")
var18_totaldegree<-degree(var18, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var18_indegree)
sd(var18_indegree)
##out
summary(var18_outdegree)
sd(var18_outdegree)
##all
summary(var18_totaldegree)
sd(var18_totaldegree)

#Closeness 
V(var18)$incloseness <- closeness(var18, mode = "in") #%>% round(6)
V(var18)$outcloseness <- closeness(var18, mode = "out") #%>% round(6)
V(var18)$totalcloseness <- closeness(var18, mode = "total") #%>% round(6)
var18_incloseness<- closeness(var18, mode = "in") #%>% round(6)
var18_outcloseness<- closeness(var18, mode = "out") #%>% round(6)
var18_totalcloseness<- closeness(var18, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var18_incloseness)
sd(var18_incloseness)
##out
summary(var18_outcloseness)
sd(var18_outcloseness)
##all
summary(var18_totalcloseness)
sd(var18_totalcloseness)

#Betweenness
V(var18)$betweenness <- betweenness(var18) %>% round(1)
var18_betweenness <- betweenness(var18) %>% round(1)

##all
summary(var18_betweenness)
sd(var18_betweenness)

#Eigen_Centrality
V(var18)$eigenvector <- eigen_centrality(var18, directed = TRUE) %$% vector %>% round(3)
var18_eigenvector <- eigen_centrality(var18, directed = TRUE) %$% vector %>% round(3)

#all
summary(var18_eigenvector)
sd(var18_eigenvector)

#Shortest Paths
var18_sp_in <- shortest.paths(var18, mode='in')
var18_sp_out <- shortest.paths(var18, mode='out')

#in
mean(var18_sp_in[which(var18_sp_in != Inf)])
sd(var18_sp_in[which(var18_sp_in != Inf)])
#out
mean(var18_sp_out[which(var18_sp_out != Inf)])
sd(var18_sp_out[which(var18_sp_out != Inf)])

#Reachability
var18_reach_in <- reachability(var18, 'in')
var18_reach_out <- reachability(var18, 'out')

#in
mean(var18_reach_in[which(var18_reach_in != Inf)])
sd(var18_reach_in[which(var18_reach_in != Inf)])
#out
mean(var18_reach_out[which(var18_reach_out != Inf)])
sd(var18_reach_out[which(var18_reach_out != Inf)])

# Density 
graph.density(var18)

# Reciprocity
reciprocity(var18)

# Transitivity
transitivity(var18)

#Triad Census
tc_var18 <- triad.census(var18)
triad_df <- data.frame(tc_var18)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var18_sp_in_vec <- vector()
var18_sp_out_vec <- vector()
var18_reach_in_vec <- vector()
var18_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var18))
  var18_reach_in_vec[i] <- mean(var18_reach_in[i,])
  V(var18)$var18_reach_in_vec[i] <- mean(var18_reach_in[i,]) #adding to igraph object
  
  var18_reach_out_vec[i] <- mean(var18_reach_out[i,])
  V(var18)$var18_reach_out_vec[i] <- mean(var18_reach_out[i,]) #adding to igraph object
  
  var18_shortest.paths.in_vec[i] <- mean(var18_sp_in[i,])
  V(var18)$var18_shortest.paths.in_vec[i] <- mean(var18_sp_in[i,]) #adding to igraph object
  
  var18_shortest.paths.out_vec[i] <- mean(var18_sp_out[i,])
  V(var18)$var18_shortest.paths.out_vec[i] <- mean(var18_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var18_indegree,
var18_outdegree,
var18_totaldegree,
var18_incloseness,
var18_outcloseness,
var18_totalcloseness,
var18_betweenness,
var18_eigenvector,
var18_reach_in_vec, 
var18_reach_out_vec, 
var18_sp_in_vec, 
var18_sp_out_vec)

write.csv(var18_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var18_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var18 <- triad.census(var18)
triad_df_var18 <- data.frame(census_labels,tc_var18)
triad_df_var18
write.csv(triad_df_var18, 'var18_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var19
```{r}
#Centrality Degree  
V(var19)$indegree<-degree(var19, mode = "in")
V(var19)$outdegree <- degree(var19, mode = "out")
V(var19)$totaldegree <- degree(var19, mode = "total")

var19_indegree<-degree(var19, mode = "in")
var19_outdegree<-degree(var19, mode = "out")
var19_totaldegree<-degree(var19, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var19_indegree)
sd(var19_indegree)
##out
summary(var19_outdegree)
sd(var19_outdegree)
##all
summary(var19_totaldegree)
sd(var19_totaldegree)

#Closeness 
V(var19)$incloseness <- closeness(var19, mode = "in") #%>% round(6)
V(var19)$outcloseness <- closeness(var19, mode = "out") #%>% round(6)
V(var19)$totalcloseness <- closeness(var19, mode = "total") #%>% round(6)
var19_incloseness<- closeness(var19, mode = "in") #%>% round(6)
var19_outcloseness<- closeness(var19, mode = "out") #%>% round(6)
var19_totalcloseness<- closeness(var19, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var19_incloseness)
sd(var19_incloseness)
##out
summary(var19_outcloseness)
sd(var19_outcloseness)
##all
summary(var19_totalcloseness)
sd(var19_totalcloseness)

#Betweenness
V(var19)$betweenness <- betweenness(var19) %>% round(1)
var19_betweenness <- betweenness(var19) %>% round(1)

##all
summary(var19_betweenness)
sd(var19_betweenness)

#Eigen_Centrality
V(var19)$eigenvector <- eigen_centrality(var19, directed = TRUE) %$% vector %>% round(3)
var19_eigenvector <- eigen_centrality(var19, directed = TRUE) %$% vector %>% round(3)

#all
summary(var19_eigenvector)
sd(var19_eigenvector)

#Shortest Paths
var19_sp_in <- shortest.paths(var19, mode='in')
var19_sp_out <- shortest.paths(var19, mode='out')

#in
mean(var19_sp_in[which(var19_sp_in != Inf)])
sd(var19_sp_in[which(var19_sp_in != Inf)])
#out
mean(var19_sp_out[which(var19_sp_out != Inf)])
sd(var19_sp_out[which(var19_sp_out != Inf)])

#Reachability
var19_reach_in <- reachability(var19, 'in')
var19_reach_out <- reachability(var19, 'out')

#in
mean(var19_reach_in[which(var19_reach_in != Inf)])
sd(var19_reach_in[which(var19_reach_in != Inf)])
#out
mean(var19_reach_out[which(var19_reach_out != Inf)])
sd(var19_reach_out[which(var19_reach_out != Inf)])

# Density 
graph.density(var19)

# Reciprocity
reciprocity(var19)

# Transitivity
transitivity(var19)

#Triad Census
tc_var19 <- triad.census(var19)
triad_df <- data.frame(tc_var19)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var19_sp_in_vec <- vector()
var19_sp_out_vec <- vector()
var19_reach_in_vec <- vector()
var19_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var19))
  var19_reach_in_vec[i] <- mean(var19_reach_in[i,])
  V(var19)$var19_reach_in_vec[i] <- mean(var19_reach_in[i,]) #adding to igraph object
  
  var19_reach_out_vec[i] <- mean(var19_reach_out[i,])
  V(var19)$var19_reach_out_vec[i] <- mean(var19_reach_out[i,]) #adding to igraph object
  
  var19_shortest.paths.in_vec[i] <- mean(var19_sp_in[i,])
  V(var19)$var19_shortest.paths.in_vec[i] <- mean(var19_sp_in[i,]) #adding to igraph object
  
  var19_shortest.paths.out_vec[i] <- mean(var19_sp_out[i,])
  V(var19)$var19_shortest.paths.out_vec[i] <- mean(var19_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var19_indegree,
var19_outdegree,
var19_totaldegree,
var19_incloseness,
var19_outcloseness,
var19_totalcloseness,
var19_betweenness,
var19_eigenvector,
var19_reach_in_vec, 
var19_reach_out_vec, 
var19_sp_in_vec, 
var19_sp_out_vec)

write.csv(var19_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var19_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var19 <- triad.census(var19)
triad_df_var19 <- data.frame(census_labels,tc_var19)
triad_df_var19
write.csv(triad_df_var19, 'var19_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var20
```{r}
#Centrality Degree  
V(var20)$indegree<-degree(var20, mode = "in")
V(var20)$outdegree <- degree(var20, mode = "out")
V(var20)$totaldegree <- degree(var20, mode = "total")

var20_indegree<-degree(var20, mode = "in")
var20_outdegree<-degree(var20, mode = "out")
var20_totaldegree<-degree(var20, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var20_indegree)
sd(var20_indegree)
##out
summary(var20_outdegree)
sd(var20_outdegree)
##all
summary(var20_totaldegree)
sd(var20_totaldegree)

#Closeness 
V(var20)$incloseness <- closeness(var20, mode = "in") #%>% round(6)
V(var20)$outcloseness <- closeness(var20, mode = "out") #%>% round(6)
V(var20)$totalcloseness <- closeness(var20, mode = "total") #%>% round(6)
var20_incloseness<- closeness(var20, mode = "in") #%>% round(6)
var20_outcloseness<- closeness(var20, mode = "out") #%>% round(6)
var20_totalcloseness<- closeness(var20, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var20_incloseness)
sd(var20_incloseness)
##out
summary(var20_outcloseness)
sd(var20_outcloseness)
##all
summary(var20_totalcloseness)
sd(var20_totalcloseness)

#Betweenness
V(var20)$betweenness <- betweenness(var20) %>% round(1)
var20_betweenness <- betweenness(var20) %>% round(1)

##all
summary(var20_betweenness)
sd(var20_betweenness)

#Eigen_Centrality
V(var20)$eigenvector <- eigen_centrality(var20, directed = TRUE) %$% vector %>% round(3)
var20_eigenvector <- eigen_centrality(var20, directed = TRUE) %$% vector %>% round(3)

#all
summary(var20_eigenvector)
sd(var20_eigenvector)

#Shortest Paths
var20_sp_in <- shortest.paths(var20, mode='in')
var20_sp_out <- shortest.paths(var20, mode='out')

#in
mean(var20_sp_in[which(var20_sp_in != Inf)])
sd(var20_sp_in[which(var20_sp_in != Inf)])
#out
mean(var20_sp_out[which(var20_sp_out != Inf)])
sd(var20_sp_out[which(var20_sp_out != Inf)])

#Reachability
var20_reach_in <- reachability(var20, 'in')
var20_reach_out <- reachability(var20, 'out')

#in
mean(var20_reach_in[which(var20_reach_in != Inf)])
sd(var20_reach_in[which(var20_reach_in != Inf)])
#out
mean(var20_reach_out[which(var20_reach_out != Inf)])
sd(var20_reach_out[which(var20_reach_out != Inf)])

# Density 
graph.density(var20)

# Reciprocity
reciprocity(var20)

# Transitivity
transitivity(var20)

#Triad Census
tc_var20 <- triad.census(var20)
triad_df <- data.frame(tc_var20)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var20_sp_in_vec <- vector()
var20_sp_out_vec <- vector()
var20_reach_in_vec <- vector()
var20_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var20))
  var20_reach_in_vec[i] <- mean(var20_reach_in[i,])
  V(var20)$var20_reach_in_vec[i] <- mean(var20_reach_in[i,]) #adding to igraph object
  
  var20_reach_out_vec[i] <- mean(var20_reach_out[i,])
  V(var20)$var20_reach_out_vec[i] <- mean(var20_reach_out[i,]) #adding to igraph object
  
  var20_shortest.paths.in_vec[i] <- mean(var20_sp_in[i,])
  V(var20)$var20_shortest.paths.in_vec[i] <- mean(var20_sp_in[i,]) #adding to igraph object
  
  var20_shortest.paths.out_vec[i] <- mean(var20_sp_out[i,])
  V(var20)$var20_shortest.paths.out_vec[i] <- mean(var20_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var20_indegree,
var20_outdegree,
var20_totaldegree,
var20_incloseness,
var20_outcloseness,
var20_totalcloseness,
var20_betweenness,
var20_eigenvector,
var20_reach_in_vec, 
var20_reach_out_vec, 
var20_sp_in_vec, 
var20_sp_out_vec)

write.csv(var20_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var20_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var20 <- triad.census(var20)
triad_df_var20 <- data.frame(census_labels,tc_var20)
triad_df_var20
write.csv(triad_df_var20, 'var20_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var21
```{r}
#Centrality Degree  
V(var21)$indegree<-degree(var21, mode = "in")
V(var21)$outdegree <- degree(var21, mode = "out")
V(var21)$totaldegree <- degree(var21, mode = "total")

var21_indegree<-degree(var21, mode = "in")
var21_outdegree<-degree(var21, mode = "out")
var21_totaldegree<-degree(var21, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var21_indegree)
sd(var21_indegree)
##out
summary(var21_outdegree)
sd(var21_outdegree)
##all
summary(var21_totaldegree)
sd(var21_totaldegree)

#Closeness 
V(var21)$incloseness <- closeness(var21, mode = "in") #%>% round(6)
V(var21)$outcloseness <- closeness(var21, mode = "out") #%>% round(6)
V(var21)$totalcloseness <- closeness(var21, mode = "total") #%>% round(6)
var21_incloseness<- closeness(var21, mode = "in") #%>% round(6)
var21_outcloseness<- closeness(var21, mode = "out") #%>% round(6)
var21_totalcloseness<- closeness(var21, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var21_incloseness)
sd(var21_incloseness)
##out
summary(var21_outcloseness)
sd(var21_outcloseness)
##all
summary(var21_totalcloseness)
sd(var21_totalcloseness)

#Betweenness
V(var21)$betweenness <- betweenness(var21) %>% round(1)
var21_betweenness <- betweenness(var21) %>% round(1)

##all
summary(var21_betweenness)
sd(var21_betweenness)

#Eigen_Centrality
V(var21)$eigenvector <- eigen_centrality(var21, directed = TRUE) %$% vector %>% round(3)
var21_eigenvector <- eigen_centrality(var21, directed = TRUE) %$% vector %>% round(3)

#all
summary(var21_eigenvector)
sd(var21_eigenvector)

#Shortest Paths
var21_sp_in <- shortest.paths(var21, mode='in')
var21_sp_out <- shortest.paths(var21, mode='out')

#in
mean(var21_sp_in[which(var21_sp_in != Inf)])
sd(var21_sp_in[which(var21_sp_in != Inf)])
#out
mean(var21_sp_out[which(var21_sp_out != Inf)])
sd(var21_sp_out[which(var21_sp_out != Inf)])

#Reachability
var21_reach_in <- reachability(var21, 'in')
var21_reach_out <- reachability(var21, 'out')

#in
mean(var21_reach_in[which(var21_reach_in != Inf)])
sd(var21_reach_in[which(var21_reach_in != Inf)])
#out
mean(var21_reach_out[which(var21_reach_out != Inf)])
sd(var21_reach_out[which(var21_reach_out != Inf)])

# Density 
graph.density(var21)

# Reciprocity
reciprocity(var21)

# Transitivity
transitivity(var21)

#Triad Census
tc_var21 <- triad.census(var21)
triad_df <- data.frame(tc_var21)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var21_sp_in_vec <- vector()
var21_sp_out_vec <- vector()
var21_reach_in_vec <- vector()
var21_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var21))
  var21_reach_in_vec[i] <- mean(var21_reach_in[i,])
  V(var21)$var21_reach_in_vec[i] <- mean(var21_reach_in[i,]) #adding to igraph object
  
  var21_reach_out_vec[i] <- mean(var21_reach_out[i,])
  V(var21)$var21_reach_out_vec[i] <- mean(var21_reach_out[i,]) #adding to igraph object
  
  var21_shortest.paths.in_vec[i] <- mean(var21_sp_in[i,])
  V(var21)$var21_shortest.paths.in_vec[i] <- mean(var21_sp_in[i,]) #adding to igraph object
  
  var21_shortest.paths.out_vec[i] <- mean(var21_sp_out[i,])
  V(var21)$var21_shortest.paths.out_vec[i] <- mean(var21_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var21_indegree,
var21_outdegree,
var21_totaldegree,
var21_incloseness,
var21_outcloseness,
var21_totalcloseness,
var21_betweenness,
var21_eigenvector,
var21_reach_in_vec, 
var21_reach_out_vec, 
var21_sp_in_vec, 
var21_sp_out_vec)

write.csv(var21_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var21_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var21 <- triad.census(var21)
triad_df_var21 <- data.frame(census_labels,tc_var21)
triad_df_var21
write.csv(triad_df_var21, 'var21_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var22
```{r}
#Centrality Degree  
V(var22)$indegree<-degree(var22, mode = "in")
V(var22)$outdegree <- degree(var22, mode = "out")
V(var22)$totaldegree <- degree(var22, mode = "total")

var22_indegree<-degree(var22, mode = "in")
var22_outdegree<-degree(var22, mode = "out")
var22_totaldegree<-degree(var22, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var22_indegree)
sd(var22_indegree)
##out
summary(var22_outdegree)
sd(var22_outdegree)
##all
summary(var22_totaldegree)
sd(var22_totaldegree)

#Closeness 
V(var22)$incloseness <- closeness(var22, mode = "in") #%>% round(6)
V(var22)$outcloseness <- closeness(var22, mode = "out") #%>% round(6)
V(var22)$totalcloseness <- closeness(var22, mode = "total") #%>% round(6)
var22_incloseness<- closeness(var22, mode = "in") #%>% round(6)
var22_outcloseness<- closeness(var22, mode = "out") #%>% round(6)
var22_totalcloseness<- closeness(var22, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var22_incloseness)
sd(var22_incloseness)
##out
summary(var22_outcloseness)
sd(var22_outcloseness)
##all
summary(var22_totalcloseness)
sd(var22_totalcloseness)

#Betweenness
V(var22)$betweenness <- betweenness(var22) %>% round(1)
var22_betweenness <- betweenness(var22) %>% round(1)

##all
summary(var22_betweenness)
sd(var22_betweenness)

#Eigen_Centrality
V(var22)$eigenvector <- eigen_centrality(var22, directed = TRUE) %$% vector %>% round(3)
var22_eigenvector <- eigen_centrality(var22, directed = TRUE) %$% vector %>% round(3)

#all
summary(var22_eigenvector)
sd(var22_eigenvector)

#Shortest Paths
var22_sp_in <- shortest.paths(var22, mode='in')
var22_sp_out <- shortest.paths(var22, mode='out')

#in
mean(var22_sp_in[which(var22_sp_in != Inf)])
sd(var22_sp_in[which(var22_sp_in != Inf)])
#out
mean(var22_sp_out[which(var22_sp_out != Inf)])
sd(var22_sp_out[which(var22_sp_out != Inf)])

#Reachability
var22_reach_in <- reachability(var22, 'in')
var22_reach_out <- reachability(var22, 'out')

#in
mean(var22_reach_in[which(var22_reach_in != Inf)])
sd(var22_reach_in[which(var22_reach_in != Inf)])
#out
mean(var22_reach_out[which(var22_reach_out != Inf)])
sd(var22_reach_out[which(var22_reach_out != Inf)])

# Density 
graph.density(var22)

# Reciprocity
reciprocity(var22)

# Transitivity
transitivity(var22)

#Triad Census
tc_var22 <- triad.census(var22)
triad_df <- data.frame(tc_var22)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var22_sp_in_vec <- vector()
var22_sp_out_vec <- vector()
var22_reach_in_vec <- vector()
var22_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var22))
  var22_reach_in_vec[i] <- mean(var22_reach_in[i,])
  V(var22)$var22_reach_in_vec[i] <- mean(var22_reach_in[i,]) #adding to igraph object
  
  var22_reach_out_vec[i] <- mean(var22_reach_out[i,])
  V(var22)$var22_reach_out_vec[i] <- mean(var22_reach_out[i,]) #adding to igraph object
  
  var22_shortest.paths.in_vec[i] <- mean(var22_sp_in[i,])
  V(var22)$var22_shortest.paths.in_vec[i] <- mean(var22_sp_in[i,]) #adding to igraph object
  
  var22_shortest.paths.out_vec[i] <- mean(var22_sp_out[i,])
  V(var22)$var22_shortest.paths.out_vec[i] <- mean(var22_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var22_indegree,
var22_outdegree,
var22_totaldegree,
var22_incloseness,
var22_outcloseness,
var22_totalcloseness,
var22_betweenness,
var22_eigenvector,
var22_reach_in_vec, 
var22_reach_out_vec, 
var22_sp_in_vec, 
var22_sp_out_vec)

write.csv(var22_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var22_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var22 <- triad.census(var22)
triad_df_var22 <- data.frame(census_labels,tc_var22)
triad_df_var22
write.csv(triad_df_var22, 'var22_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var23
```{r}
#Centrality Degree  
V(var23)$indegree<-degree(var23, mode = "in")
V(var23)$outdegree <- degree(var23, mode = "out")
V(var23)$totaldegree <- degree(var23, mode = "total")

var23_indegree<-degree(var23, mode = "in")
var23_outdegree<-degree(var23, mode = "out")
var23_totaldegree<-degree(var23, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var23_indegree)
sd(var23_indegree)
##out
summary(var23_outdegree)
sd(var23_outdegree)
##all
summary(var23_totaldegree)
sd(var23_totaldegree)

#Closeness 
V(var23)$incloseness <- closeness(var23, mode = "in") #%>% round(6)
V(var23)$outcloseness <- closeness(var23, mode = "out") #%>% round(6)
V(var23)$totalcloseness <- closeness(var23, mode = "total") #%>% round(6)
var23_incloseness<- closeness(var23, mode = "in") #%>% round(6)
var23_outcloseness<- closeness(var23, mode = "out") #%>% round(6)
var23_totalcloseness<- closeness(var23, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var23_incloseness)
sd(var23_incloseness)
##out
summary(var23_outcloseness)
sd(var23_outcloseness)
##all
summary(var23_totalcloseness)
sd(var23_totalcloseness)

#Betweenness
V(var23)$betweenness <- betweenness(var23) %>% round(1)
var23_betweenness <- betweenness(var23) %>% round(1)

##all
summary(var23_betweenness)
sd(var23_betweenness)

#Eigen_Centrality
V(var23)$eigenvector <- eigen_centrality(var23, directed = TRUE) %$% vector %>% round(3)
var23_eigenvector <- eigen_centrality(var23, directed = TRUE) %$% vector %>% round(3)

#all
summary(var23_eigenvector)
sd(var23_eigenvector)

#Shortest Paths
var23_sp_in <- shortest.paths(var23, mode='in')
var23_sp_out <- shortest.paths(var23, mode='out')

#in
mean(var23_sp_in[which(var23_sp_in != Inf)])
sd(var23_sp_in[which(var23_sp_in != Inf)])
#out
mean(var23_sp_out[which(var23_sp_out != Inf)])
sd(var23_sp_out[which(var23_sp_out != Inf)])

#Reachability
var23_reach_in <- reachability(var23, 'in')
var23_reach_out <- reachability(var23, 'out')

#in
mean(var23_reach_in[which(var23_reach_in != Inf)])
sd(var23_reach_in[which(var23_reach_in != Inf)])
#out
mean(var23_reach_out[which(var23_reach_out != Inf)])
sd(var23_reach_out[which(var23_reach_out != Inf)])

# Density 
graph.density(var23)

# Reciprocity
reciprocity(var23)

# Transitivity
transitivity(var23)

#Triad Census
tc_var23 <- triad.census(var23)
triad_df <- data.frame(tc_var23)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var23_sp_in_vec <- vector()
var23_sp_out_vec <- vector()
var23_reach_in_vec <- vector()
var23_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var23))
  var23_reach_in_vec[i] <- mean(var23_reach_in[i,])
  V(var23)$var23_reach_in_vec[i] <- mean(var23_reach_in[i,]) #adding to igraph object
  
  var23_reach_out_vec[i] <- mean(var23_reach_out[i,])
  V(var23)$var23_reach_out_vec[i] <- mean(var23_reach_out[i,]) #adding to igraph object
  
  var23_shortest.paths.in_vec[i] <- mean(var23_sp_in[i,])
  V(var23)$var23_shortest.paths.in_vec[i] <- mean(var23_sp_in[i,]) #adding to igraph object
  
  var23_shortest.paths.out_vec[i] <- mean(var23_sp_out[i,])
  V(var23)$var23_shortest.paths.out_vec[i] <- mean(var23_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var23_indegree,
var23_outdegree,
var23_totaldegree,
var23_incloseness,
var23_outcloseness,
var23_totalcloseness,
var23_betweenness,
var23_eigenvector,
var23_reach_in_vec, 
var23_reach_out_vec, 
var23_sp_in_vec, 
var23_sp_out_vec)

write.csv(var23_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var23_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var23 <- triad.census(var23)
triad_df_var23 <- data.frame(census_labels,tc_var23)
triad_df_var23
write.csv(triad_df_var23, 'var23_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - var24
```{r}
#Centrality Degree  
V(var24)$indegree<-degree(var24, mode = "in")
V(var24)$outdegree <- degree(var24, mode = "out")
V(var24)$totaldegree <- degree(var24, mode = "total")

var24_indegree<-degree(var24, mode = "in")
var24_outdegree<-degree(var24, mode = "out")
var24_totaldegree<-degree(var24, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(var24_indegree)
sd(var24_indegree)
##out
summary(var24_outdegree)
sd(var24_outdegree)
##all
summary(var24_totaldegree)
sd(var24_totaldegree)

#Closeness 
V(var24)$incloseness <- closeness(var24, mode = "in") #%>% round(6)
V(var24)$outcloseness <- closeness(var24, mode = "out") #%>% round(6)
V(var24)$totalcloseness <- closeness(var24, mode = "total") #%>% round(6)
var24_incloseness<- closeness(var24, mode = "in") #%>% round(6)
var24_outcloseness<- closeness(var24, mode = "out") #%>% round(6)
var24_totalcloseness<- closeness(var24, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(var24_incloseness)
sd(var24_incloseness)
##out
summary(var24_outcloseness)
sd(var24_outcloseness)
##all
summary(var24_totalcloseness)
sd(var24_totalcloseness)

#Betweenness
V(var24)$betweenness <- betweenness(var24) %>% round(1)
var24_betweenness <- betweenness(var24) %>% round(1)

##all
summary(var24_betweenness)
sd(var24_betweenness)

#Eigen_Centrality
V(var24)$eigenvector <- eigen_centrality(var24, directed = TRUE) %$% vector %>% round(3)
var24_eigenvector <- eigen_centrality(var24, directed = TRUE) %$% vector %>% round(3)

#all
summary(var24_eigenvector)
sd(var24_eigenvector)

#Shortest Paths
var24_sp_in <- shortest.paths(var24, mode='in')
var24_sp_out <- shortest.paths(var24, mode='out')

#in
mean(var24_sp_in[which(var24_sp_in != Inf)])
sd(var24_sp_in[which(var24_sp_in != Inf)])
#out
mean(var24_sp_out[which(var24_sp_out != Inf)])
sd(var24_sp_out[which(var24_sp_out != Inf)])

#Reachability
var24_reach_in <- reachability(var24, 'in')
var24_reach_out <- reachability(var24, 'out')

#in
mean(var24_reach_in[which(var24_reach_in != Inf)])
sd(var24_reach_in[which(var24_reach_in != Inf)])
#out
mean(var24_reach_out[which(var24_reach_out != Inf)])
sd(var24_reach_out[which(var24_reach_out != Inf)])

# Density 
graph.density(var24)

# Reciprocity
reciprocity(var24)

# Transitivity
transitivity(var24)

#Triad Census
tc_var24 <- triad.census(var24)
triad_df <- data.frame(tc_var24)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

var24_sp_in_vec <- vector()
var24_sp_out_vec <- vector()
var24_reach_in_vec <- vector()
var24_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(var24))
  var24_reach_in_vec[i] <- mean(var24_reach_in[i,])
  V(var24)$var24_reach_in_vec[i] <- mean(var24_reach_in[i,]) #adding to igraph object
  
  var24_reach_out_vec[i] <- mean(var24_reach_out[i,])
  V(var24)$var24_reach_out_vec[i] <- mean(var24_reach_out[i,]) #adding to igraph object
  
  var24_shortest.paths.in_vec[i] <- mean(var24_sp_in[i,])
  V(var24)$var24_shortest.paths.in_vec[i] <- mean(var24_sp_in[i,]) #adding to igraph object
  
  var24_shortest.paths.out_vec[i] <- mean(var24_sp_out[i,])
  V(var24)$var24_shortest.paths.out_vec[i] <- mean(var24_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
var24_indegree,
var24_outdegree,
var24_totaldegree,
var24_incloseness,
var24_outcloseness,
var24_totalcloseness,
var24_betweenness,
var24_eigenvector,
var24_reach_in_vec, 
var24_reach_out_vec, 
var24_sp_in_vec, 
var24_sp_out_vec)

write.csv(var24_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/var24_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_var24 <- triad.census(var24)
triad_df_var24 <- data.frame(census_labels,tc_var24)
triad_df_var24
write.csv(triad_df_var24, 'var24_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - Atividades
```{r}
#Centrality Degree  
V(atividade)$indegree<-degree(atividade, mode = "in")
V(atividade)$outdegree <- degree(atividade, mode = "out")
V(atividade)$totaldegree <- degree(atividade, mode = "total")

atividade_indegree<-degree(atividade, mode = "in")
atividade_outdegree<-degree(atividade, mode = "out")
atividade_totaldegree<-degree(atividade, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(atividade_indegree)
sd(atividade_indegree)
##out
summary(atividade_outdegree)
sd(atividade_outdegree)
##all
summary(atividade_totaldegree)
sd(atividade_totaldegree)

#Closeness 
V(atividade)$incloseness <- closeness(atividade, mode = "in") #%>% round(6)
V(atividade)$outcloseness <- closeness(atividade, mode = "out") #%>% round(6)
V(atividade)$totalcloseness <- closeness(atividade, mode = "total") #%>% round(6)
atividade_incloseness<- closeness(atividade, mode = "in") #%>% round(6)
atividade_outcloseness<- closeness(atividade, mode = "out") #%>% round(6)
atividade_totalcloseness<- closeness(atividade, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(atividade_incloseness)
sd(atividade_incloseness)
##out
summary(atividade_outcloseness)
sd(atividade_outcloseness)
##all
summary(atividade_totalcloseness)
sd(atividade_totalcloseness)

#Betweenness
V(atividade)$betweenness <- betweenness(atividade) %>% round(1)
atividade_betweenness <- betweenness(atividade) %>% round(1)

##all
summary(atividade_betweenness)
sd(atividade_betweenness)

#Eigen_Centrality
V(atividade)$eigenvector <- eigen_centrality(atividade, directed = TRUE) %$% vector %>% round(3)
atividade_eigenvector <- eigen_centrality(atividade, directed = TRUE) %$% vector %>% round(3)

#all
summary(atividade_eigenvector)
sd(atividade_eigenvector)

#Shortest Paths
atividade_sp_in <- shortest.paths(atividade, mode='in')
atividade_sp_out <- shortest.paths(atividade, mode='out')

#in
mean(atividade_sp_in[which(atividade_sp_in != Inf)])
sd(atividade_sp_in[which(atividade_sp_in != Inf)])
#out
mean(atividade_sp_out[which(atividade_sp_out != Inf)])
sd(atividade_sp_out[which(atividade_sp_out != Inf)])

#Reachability
atividade_reach_in <- reachability(atividade, 'in')
atividade_reach_out <- reachability(atividade, 'out')

#in
mean(atividade_reach_in[which(atividade_reach_in != Inf)])
sd(atividade_reach_in[which(atividade_reach_in != Inf)])
#out
mean(atividade_reach_out[which(atividade_reach_out != Inf)])
sd(atividade_reach_out[which(atividade_reach_out != Inf)])

# Density 
graph.density(atividade)

# Reciprocity
reciprocity(atividade)

# Transitivity
transitivity(atividade)

#Triad Census
tc_atividade <- triad.census(atividade)
triad_df <- data.frame(tc_atividade)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

atividade_sp_in_vec <- vector()
atividade_sp_out_vec <- vector()
atividade_reach_in_vec <- vector()
atividade_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(atividade))
  atividade_reach_in_vec[i] <- mean(atividade_reach_in[i,])
  V(atividade)$atividade_reach_in_vec[i] <- mean(atividade_reach_in[i,]) #adding to igraph object
  
  atividade_reach_out_vec[i] <- mean(atividade_reach_out[i,])
  V(atividade)$atividade_reach_out_vec[i] <- mean(atividade_reach_out[i,]) #adding to igraph object
  
  atividade_shortest.paths.in_vec[i] <- mean(atividade_sp_in[i,])
  V(atividade)$atividade_shortest.paths.in_vec[i] <- mean(atividade_sp_in[i,]) #adding to igraph object
  
  atividade_shortest.paths.out_vec[i] <- mean(atividade_sp_out[i,])
  V(atividade)$atividade_shortest.paths.out_vec[i] <- mean(atividade_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
atividade_indegree,
atividade_outdegree,
atividade_totaldegree,
atividade_incloseness,
atividade_outcloseness,
atividade_totalcloseness,
atividade_betweenness,
atividade_eigenvector,
atividade_reach_in_vec, 
atividade_reach_out_vec, 
atividade_sp_in_vec, 
atividade_sp_out_vec)

write.csv(atividade_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/atividade_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_atividade <- triad.census(atividade)
triad_df_atividade <- data.frame(census_labels,tc_atividade)
triad_df_atividade
write.csv(triad_df_atividade, 'atividade_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```

#Descriptive SNA - Acesso
```{r}
#Centrality Degree  
V(acesso)$indegree<-degree(acesso, mode = "in")
V(acesso)$outdegree <- degree(acesso, mode = "out")
V(acesso)$totaldegree <- degree(acesso, mode = "total")

acesso_indegree<-degree(acesso, mode = "in")
acesso_outdegree<-degree(acesso, mode = "out")
acesso_totaldegree<-degree(acesso, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(acesso_indegree)
sd(acesso_indegree)
##out
summary(acesso_outdegree)
sd(acesso_outdegree)
##all
summary(acesso_totaldegree)
sd(acesso_totaldegree)

#Closeness 
V(acesso)$incloseness <- closeness(acesso, mode = "in") #%>% round(6)
V(acesso)$outcloseness <- closeness(acesso, mode = "out") #%>% round(6)
V(acesso)$totalcloseness <- closeness(acesso, mode = "total") #%>% round(6)
acesso_incloseness<- closeness(acesso, mode = "in") #%>% round(6)
acesso_outcloseness<- closeness(acesso, mode = "out") #%>% round(6)
acesso_totalcloseness<- closeness(acesso, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(acesso_incloseness)
sd(acesso_incloseness)
##out
summary(acesso_outcloseness)
sd(acesso_outcloseness)
##all
summary(acesso_totalcloseness)
sd(acesso_totalcloseness)

#Betweenness
V(acesso)$betweenness <- betweenness(acesso) %>% round(1)
acesso_betweenness <- betweenness(acesso) %>% round(1)

##all
summary(acesso_betweenness)
sd(acesso_betweenness)

#Eigen_Centrality
V(acesso)$eigenvector <- eigen_centrality(acesso, directed = TRUE) %$% vector %>% round(3)
acesso_eigenvector <- eigen_centrality(acesso, directed = TRUE) %$% vector %>% round(3)

#all
summary(acesso_eigenvector)
sd(acesso_eigenvector)

#Shortest Paths
acesso_sp_in <- shortest.paths(acesso, mode='in')
acesso_sp_out <- shortest.paths(acesso, mode='out')

#in
mean(acesso_sp_in[which(acesso_sp_in != Inf)])
sd(acesso_sp_in[which(acesso_sp_in != Inf)])
#out
mean(acesso_sp_out[which(acesso_sp_out != Inf)])
sd(acesso_sp_out[which(acesso_sp_out != Inf)])

#Reachability
acesso_reach_in <- reachability(acesso, 'in')
acesso_reach_out <- reachability(acesso, 'out')

#in
mean(acesso_reach_in[which(acesso_reach_in != Inf)])
sd(acesso_reach_in[which(acesso_reach_in != Inf)])
#out
mean(acesso_reach_out[which(acesso_reach_out != Inf)])
sd(acesso_reach_out[which(acesso_reach_out != Inf)])

# Density 
graph.density(acesso)

# Reciprocity
reciprocity(acesso)

# Transitivity
transitivity(acesso)

#Triad Census
tc_acesso <- triad.census(acesso)
triad_df <- data.frame(tc_acesso)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

acesso_sp_in_vec <- vector()
acesso_sp_out_vec <- vector()
acesso_reach_in_vec <- vector()
acesso_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(acesso))
  acesso_reach_in_vec[i] <- mean(acesso_reach_in[i,])
  V(acesso)$acesso_reach_in_vec[i] <- mean(acesso_reach_in[i,]) #adding to igraph object
  
  acesso_reach_out_vec[i] <- mean(acesso_reach_out[i,])
  V(acesso)$acesso_reach_out_vec[i] <- mean(acesso_reach_out[i,]) #adding to igraph object
  
  acesso_shortest.paths.in_vec[i] <- mean(acesso_sp_in[i,])
  V(acesso)$acesso_shortest.paths.in_vec[i] <- mean(acesso_sp_in[i,]) #adding to igraph object
  
  acesso_shortest.paths.out_vec[i] <- mean(acesso_sp_out[i,])
  V(acesso)$acesso_shortest.paths.out_vec[i] <- mean(acesso_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
acesso_indegree,
acesso_outdegree,
acesso_totaldegree,
acesso_incloseness,
acesso_outcloseness,
acesso_totalcloseness,
acesso_betweenness,
acesso_eigenvector,
acesso_reach_in_vec, 
acesso_reach_out_vec, 
acesso_sp_in_vec, 
acesso_sp_out_vec)

write.csv(acesso_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/acesso_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_acesso <- triad.census(acesso)
triad_df_acesso <- data.frame(census_labels,tc_acesso)
triad_df_acesso
write.csv(triad_df_acesso, 'acesso_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```

#Descriptive SNA - Confianca
```{r}
#Centrality Degree  
V(confianca)$indegree<-degree(confianca, mode = "in")
V(confianca)$outdegree <- degree(confianca, mode = "out")
V(confianca)$totaldegree <- degree(confianca, mode = "total")

confianca_indegree<-degree(confianca, mode = "in")
confianca_outdegree<-degree(confianca, mode = "out")
confianca_totaldegree<-degree(confianca, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(confianca_indegree)
sd(confianca_indegree)
##out
summary(confianca_outdegree)
sd(confianca_outdegree)
##all
summary(confianca_totaldegree)
sd(confianca_totaldegree)

#Closeness 
V(confianca)$incloseness <- closeness(confianca, mode = "in") #%>% round(6)
V(confianca)$outcloseness <- closeness(confianca, mode = "out") #%>% round(6)
V(confianca)$totalcloseness <- closeness(confianca, mode = "total") #%>% round(6)
confianca_incloseness<- closeness(confianca, mode = "in") #%>% round(6)
confianca_outcloseness<- closeness(confianca, mode = "out") #%>% round(6)
confianca_totalcloseness<- closeness(confianca, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(confianca_incloseness)
sd(confianca_incloseness)
##out
summary(confianca_outcloseness)
sd(confianca_outcloseness)
##all
summary(confianca_totalcloseness)
sd(confianca_totalcloseness)

#Betweenness
V(confianca)$betweenness <- betweenness(confianca) %>% round(1)
confianca_betweenness <- betweenness(confianca) %>% round(1)

##all
summary(confianca_betweenness)
sd(confianca_betweenness)

#Eigen_Centrality
V(confianca)$eigenvector <- eigen_centrality(confianca, directed = TRUE) %$% vector %>% round(3)
confianca_eigenvector <- eigen_centrality(confianca, directed = TRUE) %$% vector %>% round(3)

#all
summary(confianca_eigenvector)
sd(confianca_eigenvector)

#Shortest Paths
confianca_sp_in <- shortest.paths(confianca, mode='in')
confianca_sp_out <- shortest.paths(confianca, mode='out')

#in
mean(confianca_sp_in[which(confianca_sp_in != Inf)])
sd(confianca_sp_in[which(confianca_sp_in != Inf)])
#out
mean(confianca_sp_out[which(confianca_sp_out != Inf)])
sd(confianca_sp_out[which(confianca_sp_out != Inf)])

#Reachability
confianca_reach_in <- reachability(confianca, 'in')
confianca_reach_out <- reachability(confianca, 'out')

#in
mean(confianca_reach_in[which(confianca_reach_in != Inf)])
sd(confianca_reach_in[which(confianca_reach_in != Inf)])
#out
mean(confianca_reach_out[which(confianca_reach_out != Inf)])
sd(confianca_reach_out[which(confianca_reach_out != Inf)])

# Density 
graph.density(confianca)

# Reciprocity
reciprocity(confianca)

# Transitivity
transitivity(confianca)

#Triad Census
tc_confianca <- triad.census(confianca)
triad_df <- data.frame(tc_confianca)
triad_df
write.csv(triad_df, 'complet_triads.csv')


#Creating Vectors to pass means for each vertex

confianca_sp_in_vec <- vector()
confianca_sp_out_vec <- vector()
confianca_reach_in_vec <- vector()
confianca_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(confianca))
  confianca_reach_in_vec[i] <- mean(confianca_reach_in[i,])
  V(confianca)$confianca_reach_in_vec[i] <- mean(confianca_reach_in[i,]) #adding to igraph object
  
  confianca_reach_out_vec[i] <- mean(confianca_reach_out[i,])
  V(confianca)$confianca_reach_out_vec[i] <- mean(confianca_reach_out[i,]) #adding to igraph object
  
  confianca_shortest.paths.in_vec[i] <- mean(confianca_sp_in[i,])
  V(confianca)$confianca_shortest.paths.in_vec[i] <- mean(confianca_sp_in[i,]) #adding to igraph object
  
  confianca_shortest.paths.out_vec[i] <- mean(confianca_sp_out[i,])
  V(confianca)$confianca_shortest.paths.out_vec[i] <- mean(confianca_sp_out[i,]) #adding to igraph object


node_stats_df <- cbind(
confianca_indegree,
confianca_outdegree,
confianca_totaldegree,
confianca_incloseness,
confianca_outcloseness,
confianca_totalcloseness,
confianca_betweenness,
confianca_eigenvector,
confianca_reach_in_vec, 
confianca_reach_out_vec, 
confianca_sp_in_vec, 
confianca_sp_out_vec)

write.csv(confianca_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/confianca_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_confianca <- triad.census(confianca)
triad_df_confianca <- data.frame(census_labels,tc_confianca)
triad_df_confianca
write.csv(triad_df_confianca, 'confianca_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```


#Descriptive SNA - Total
```{r}
#Centrality Degree  
V(total)$indegree<-degree(total, mode = "in")
V(total)$outdegree <- degree(total, mode = "out")
V(total)$totaldegree <- degree(total, mode = "total")

total_indegree<-degree(total, mode = "in")
total_outdegree<-degree(total, mode = "out")
total_totaldegree<-degree(total, mode = "total")

# Centrality Degree Descriptive Statistics

##in
summary(total_indegree)
sd(total_indegree)
##out
summary(total_outdegree)
sd(total_outdegree)
##all
summary(total_totaldegree)
sd(total_totaldegree)

#Closeness 
V(total)$incloseness <- closeness(total, mode = "in") #%>% round(6)
V(total)$outcloseness <- closeness(total, mode = "out") #%>% round(6)
V(total)$totalcloseness <- closeness(total, mode = "total") #%>% round(6)
total_incloseness<- closeness(total, mode = "in") #%>% round(6)
total_outcloseness<- closeness(total, mode = "out") #%>% round(6)
total_totalcloseness<- closeness(total, mode = "total") #%>% round(6)


# Closeness Degree Descriptive Statistics

##in
summary(total_incloseness)
sd(total_incloseness)
##out
summary(total_outcloseness)
sd(total_outcloseness)
##all
summary(total_totalcloseness)
sd(total_totalcloseness)

#Betweenness
V(total)$betweenness <- betweenness(total) %>% round(1)
total_betweenness <- betweenness(total) %>% round(1)

##all
summary(total_betweenness)
sd(total_betweenness)

#Eigen_Centrality
V(total)$eigenvector <- eigen_centrality(total, directed = TRUE) %$% vector %>% round(3)
total_eigenvector <- eigen_centrality(total, directed = TRUE) %$% vector %>% round(3)

#all
summary(total_eigenvector)
sd(total_eigenvector)

#Shortest Paths
total_sp_in <- shortest.paths(total, mode='in')
total_sp_out <- shortest.paths(total, mode='out')

#in
mean(total_sp_in[which(total_sp_in != Inf)])
sd(total_sp_in[which(total_sp_in != Inf)])
#out
mean(total_sp_out[which(total_sp_out != Inf)])
sd(total_sp_out[which(total_sp_out != Inf)])

#Reachability
total_reach_in <- reachability(total, 'in')
total_reach_out <- reachability(total, 'out')

#in
mean(total_reach_in[which(total_reach_in != Inf)])
sd(total_reach_in[which(total_reach_in != Inf)])
#out
mean(total_reach_out[which(total_reach_out != Inf)])
sd(total_reach_out[which(total_reach_out != Inf)])

# Density 
graph.density(total)

# Reciprocity
reciprocity(total)

# Transitivity
transitivity(total)

#Triad Census
tc_total <- triad.census(total)
total_triad_df <- data.frame(tc_total)
total_triad_df
write.csv(total_triad_df, 'total_complet_triads.csv')


#Creating Vectors to pass means for each vertex

total_sp_in_vec <- vector()
total_sp_out_vec <- vector()
total_reach_in_vec <- vector()
total_reach_out_vec <- vector()


#  Looping to pass mean of reachability and shortest path to each vertex
for (i in 1:vcount(total))
  total_reach_in_vec[i] <- mean(total_reach_in[i,])
  V(total)$total_reach_in_vec[i] <- mean(total_reach_in[i,]) #adding to igraph object
  
  total_reach_out_vec[i] <- mean(total_reach_out[i,])
  V(total)$total_reach_out_vec[i] <- mean(total_reach_out[i,]) #adding to igraph object
  
  total_shortest.paths.in_vec[i] <- mean(total_sp_in[i,])
  V(total)$total_shortest.paths.in_vec[i] <- mean(total_sp_in[i,]) #adding to igraph object
  
  total_shortest.paths.out_vec[i] <- mean(total_sp_out[i,])
  V(total)$total_shortest.paths.out_vec[i] <- mean(total_sp_out[i,]) #adding to igraph object


total_node_stats_df <- cbind(
total_indegree,
total_outdegree,
total_totaldegree,
total_incloseness,
total_outcloseness,
total_totalcloseness,
total_betweenness,
total_eigenvector,
total_reach_in_vec, 
total_reach_out_vec, 
total_sp_in_vec, 
total_sp_out_vec)

write.csv(total_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/total_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_total <- triad.census(total)
_totaltriad_df <- data.frame(census_labels,tc_total)
total_triad_df
write.csv(total_triad_df, 'total_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads

```

Complete Data to Export 
```{r}
complete_node_stats_df <- cbind(
total_indegree,
total_outdegree,
total_totaldegree,
total_incloseness,
total_outcloseness,
total_totalcloseness,
total_betweenness,
total_eigenvector,
total_reach_in_vec, 
total_reach_out_vec, 
total_sp_in_vec, 
total_sp_out_vec

)

write.csv(total_node_stats_df, "~/SNArRDJF/Banco Redes R/Bancos CSV/total_node_stats_df.csv")


#Triad Census
census_labels = c('003',
                  '012',
                  '102',
                  '021D',
                  '021U',
                  '021C',
                  '111D',
                  '111U',
                  '030T',
                  '030C',
                  '201',
                  '120D',
                  '120U',
                  '120C',
                  '210',
                  '300')
tc_total <- triad.census(total)
triad_df_total <- data.frame(census_labels,tc_total)
triad_df_total
write.csv(triad_df_total, 'total_complet_triads.csv')

#http://www.stats.ox.ac.uk/~snijders/Trans_Triads_ha.pdf página 15 - configuração das triads


```





#Exporting to Photoshop...Ops Gephi
```{r}
print(igraph.to.gexf(full_no_zero), "~/SNArRDJF/Banco Redes R/Bancos GEXF/full_no_zero.gexf")
print(igraph.to.gexf(var0), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var0.gexf")
print(igraph.to.gexf(var1), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var1.gexf")
print(igraph.to.gexf(var2), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var2.gexf")
print(igraph.to.gexf(var3), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var3.gexf")
print(igraph.to.gexf(var4), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var4.gexf")
print(igraph.to.gexf(var5), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var5.gexf")
print(igraph.to.gexf(var6), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var6.gexf")
print(igraph.to.gexf(var7), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var7.gexf")
print(igraph.to.gexf(var8), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var8.gexf")
print(igraph.to.gexf(var9), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var9.gexf")
print(igraph.to.gexf(var10), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var10.gexf")
print(igraph.to.gexf(var11), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var11.gexf")
print(igraph.to.gexf(var12), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var12.gexf")
print(igraph.to.gexf(var13), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var13.gexf")
print(igraph.to.gexf(var14), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var14.gexf")
print(igraph.to.gexf(var15), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var15.gexf")
print(igraph.to.gexf(var16), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var16.gexf")
print(igraph.to.gexf(var17), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var17.gexf")
print(igraph.to.gexf(var18), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var18.gexf")
print(igraph.to.gexf(var19), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var19.gexf")
print(igraph.to.gexf(var20), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var20.gexf")
print(igraph.to.gexf(var21), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var21.gexf")
print(igraph.to.gexf(var22), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var22.gexf")
print(igraph.to.gexf(var23), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var23.gexf")
print(igraph.to.gexf(var24), "~/SNArRDJF/Banco Redes R/Bancos GEXF/var24.gexf")
print(igraph.to.gexf(atividade), "~/SNArRDJF/Banco Redes R/Bancos GEXF/atividade.gexf")
print(igraph.to.gexf(confianca), "~/SNArRDJF/Banco Redes R/Bancos GEXF/confianca.gexf")
print(igraph.to.gexf(acesso), "~/SNArRDJF/Banco Redes R/Bancos GEXF/acesso.gexf")
print(igraph.to.gexf(total), "~/SNArRDJF/Banco Redes R/Bancos GEXF/total.gexf")
```

```{r}
###
# 4. VISUALIZE THE NETWORKS
###
 
# We can use R's general-purpose plot() method to generate custom
# visualizations of the network.

# R only lets us look at one plot at a time.  To make our work easier
# we will save our plots as PDF files.  To jus create a plot execute 
# the code between the PDF function and "dev.off()".

# In order to save PDF files we must tell R where to put them.  We do
# this with the setwd() command.  You must put the full path to the
# folder where you will output the files here.

# In OS X you can get this information by selecting the folder, right
# clicking and selecting "Get Info."  The path is listed under "Where."

# In Windows you can get this information by selecting the folder, right
# clicking and selecting "Properties."  The path information is listed 
# "location".

# example: setwd("/Users/seanwestwood/Desktop/lab_1")
setwd("~/SNArRDJF/Banco Redes R/Grafos")
  
# First, let's plot the network with all possible ties.
pdf("full_no_zero.pdf")
plot(full_no_zero)
dev.off()
 
# This is a bit of a jumble, so let's look at the networks for
# single edge types.

# Total
full_total_only <- delete.edges(full_no_zero, 
    E(full_no_zero)[get.edge.attribute(full_no_zero,
    name = "total") == 0])
summary(full_total_only)
pdf("full_no_zero_total.pdf")
plot(full_total_only)
dev.off()

# Still kind of messy, so let's clean things up a bit. For 
# simplicity, we'll focus on reports_to ties for now.
 
# First, we can optimize the layout by applying the layout 
# algorithm to the specific set of ties we care about. Here 
# we'll use Fruchterman-Rheingold; other options are 
# described in the igraph help page for "layout," which 
# can be accessed by entering ?layout.

total_to_layout <- layout.fruchterman.reingold(full_total_only)
pdf("full_no_zero_total_layout.pdf")
plot(full_total_only, 
     layout=total_to_layout)
dev.off()
 
# Now let's color-code vertices by department and clean up the 
# plot by removing vertex labels and shrinking the arrow size. 
TIPO1_label = get.vertex.attribute(full_total_only,"V1_LABEL_TIPO")

TIPO1_vertex_colors = get.vertex.attribute(full_total_only,"V1_LABEL_TIPO")
sort(table(V(full_total_only)$V1_LABEL_TIPO))
colors = c('Black', 'Red', 'Blue', 'Yellow', 'Green')
TIPO1_vertex_colors[TIPO1_vertex_colors == "UAPS-URBANA"] = colors[1]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Ajuda Mútua"] = colors[2]
TIPO1_vertex_colors[TIPO1_vertex_colors == "UAPS-RURAL"] = colors[1]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Entidades Assistênciais e Dependencia Química e CT"] = colors[4] 
TIPO1_vertex_colors[TIPO1_vertex_colors == "Residência Terapeutica"] = colors[5]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Ambulatório de Saúde Mental"] = colors[5] 
TIPO1_vertex_colors[TIPO1_vertex_colors == "Centro de Convivência"] = colors[5] 
TIPO1_vertex_colors[TIPO1_vertex_colors == "Território Aliança pela Vida"] = colors[1] 
TIPO1_vertex_colors[TIPO1_vertex_colors == "Urgência/Emergência"] = colors[5]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Consultório na Rua"] = colors[5]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Acolhimento Institucional"] = colors[5] 
TIPO1_vertex_colors[TIPO1_vertex_colors == "CREAS"] = colors[5]
TIPO1_vertex_colors[TIPO1_vertex_colors == "CAPS"] = colors[5]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Assistência Hospitalar"] = colors[5] 
TIPO1_vertex_colors[TIPO1_vertex_colors == "CRAS"] = colors[5]
TIPO1_vertex_colors[TIPO1_vertex_colors == "Entidades Socioassistenciais"] = colors[5] 

pdf("full_no_zero_color.pdf") 
plot(full_total_only, 
    layout=total_to_layout, 
    vertex.color=TIPO1_vertex_colors, 
    vertex.label=NA, 
    edge.arrow.size=.5)
dev.off() 

# Now let's set the vertex size by total.
total_vertex_sizes = get.vertex.attribute(full_no_zero,"V85_PROFISSIONAIS_TOTAL_Profissionais")
total_vertex_sizes = as.character(total_vertex_sizes)
total_vertex_sizes = as.numeric(total_vertex_sizes)

pdf("full_no_zero_vertex_size.pdf") 
plot(full_total_only, 
     layout=total_to_layout, 
     vertex.color=TIPO1_vertex_colors, 
     vertex.label=NA, 
     edge.arrow.size=.5,
     vertex.size=(total_vertex_sizes)/5)
dev.off() 
 
# Now let's incorporate additional tie types. We'll use the 
# layout generated by the reports-to ties but overlay the 
# advice and friendship ties in red and blue.

tie_type_colors = c(rgb(1,0,0,.5), rgb(0,0,1,.5), rgb(0,0,0,.5))
E(full_no_zero)$color[ E(full_no_zero)$atividade==1 ] = tie_type_colors[1]
E(full_no_zero)$color[ E(full_no_zero)$acesso==1 ] = tie_type_colors[2]
E(full_no_zero)$color[ E(full_no_zero)$confianca==1 ] = tie_type_colors[3]
E(full_no_zero)$arrow.size=.5 
V(full_no_zero)$color = TIPO1_vertex_colors
V(full_no_zero)$frame = TIPO1_vertex_colors

pdf("full_no_zero_tie_overlay.pdf")
plot(full_no_zero, 
     layout=total_to_layout, 
     vertex.color=TIPO1_vertex_colors, 
     vertex.label=NA, 
     edge.arrow.size=.1,
     vertex.size=(total_vertex_sizes)/5)
 
# Add a legend. Note that the plot window must be open for this to 
# work.
legend(1, 
       1.25,
       legend = c('atividade', 
                  'acesso',
                  'confianca'), 
       col = tie_type_colors, 
       lty=1,
       cex = .3)
dev.off() 
 
# Another option for visualizing different network ties relative 
# to one another is to overlay the edges from one tie type on the 
# structure generated by another tie type. Here we can use the
# reports-to layout but show the friendship ties:

pdf("full_no_zero_overlayed_structure.pdf")
plot(full_total_only, 
     layout=total_to_layout, 
     vertex.color=TIPO1_vertex_colors, 
     vertex.label=NA, 
     edge.arrow.size=.5,
     vertex.size=(total_vertex_sizes)/5, 
     main='Testing Pre-Historical Gephi')
dev.off() 
 
###
# 5. EXPORT THE NETWORK
###
 
# The write.graph() function exports a graph object in various
# formats readable by other programs. There is no explicit
# option for a UCINET data type, but you can export the graph
# as a Pajek object by setting the 'format' parameter to 'pajek.'
# Note that the file will appear in whichever directory is set 
# as the default in R's preferences, unless you previously 
# changed this via setwd().
write.graph(full_no_zero, file='full_no_zero.dl', format="pajek")
 
# For a more general file type (e.g., importable to Excel),
# use the "edgelist" format. Note that neither of these will
# write the attributes; only the ties are maintained.
write.graph(full_no_zero, file='full_no_zero.txt', format="edgelist")
```

#B1.2 – TIPOS DE RELACIONAMENTO - FORMAL. No que se refere à ATENÇÃO aos USUÁRIOS DE DROGAS, você caracteriza como FORMAL o relacionamento que o seu serviço possui com os serviços a seguir ? Parceria Formal - Feita através de paceria/fluxo institucional devadmente reconheca, por meio de convênios, contratos, ou acordo entre gesotres/secretarias etc.

```{r}
# 4. VISUALIZE THE NETWORKS

setwd("~/SNArRDJF/Banco Redes R/Grafos")

#B1.2 – TIPOS DE RELACIONAMENTO - FORMAL

#Creating Grafo only with edges from var0
var0 = delete.edges(full_no_zero, E(full_no_zero)[get.edge.attribute(full_no_zero,name = "var0") == 0])

#Defining Layout 
layout = layout.fruchterman.reingold(var0)

#Definig label vertex
label = get.vertex.attribute(var0,"V1_LABEL_TIPO")

#Choosing colors
vertex_colors = get.vertex.attribute(var0,"V1_LABEL_TIPO")
colors = c('Black', 'Red', 'Blue', 'Yellow', 'Green', 'Orange', 'Purple', 'Gray', 'Brown','Wheat', 'Aquamarine', 'Hotpink', 'Skyblue1')

#Assing Colors to each vertex attribute
vertex_colors[vertex_colors == "UAPS-URBANA"] = colors[1]
vertex_colors[vertex_colors == "Ajuda Mútua"] = colors[2]
vertex_colors[vertex_colors == "UAPS-RURAL"] = colors[1]
vertex_colors[vertex_colors == "Entidades Assistênciais e Dependencia Química e CT"] = colors[3] 
vertex_colors[vertex_colors == "Residência Terapeutica"] = colors[4]
vertex_colors[vertex_colors == "Ambulatório de Saúde Mental"] = colors[5] 
vertex_colors[vertex_colors == "Centro de Convivência"] = colors[6] 
vertex_colors[vertex_colors == "Território Aliança pela Vida"] = colors[7] 
vertex_colors[vertex_colors == "Urgência/Emergência"] = colors[5]
vertex_colors[vertex_colors == "Consultório na Rua"] = colors[8]
vertex_colors[vertex_colors == "Acolhimento Institucional"] = colors[9] 
vertex_colors[vertex_colors == "CREAS"] = colors[10]
vertex_colors[vertex_colors == "CAPS"] = colors[5]
vertex_colors[vertex_colors == "Assistência Hospitalar"] = colors[11] 
vertex_colors[vertex_colors == "CRAS"] = colors[10]
vertex_colors[vertex_colors == "Entidades Socioassistenciais"] = colors[12] 

# Set the vertex size (eg. Profissionais).
vertex_sizes = get.vertex.attribute(full_no_zero,"V85_PROFISSIONAIS_TOTAL_Profissionais")
vertex_sizes = as.character(vertex_sizes) #
vertex_sizes = as.numeric(vertex_sizes) #

pdf("var0_vertex_size.pdf") 
plot(var0, 
     layout=layout, 
     vertex.color=TIPO1_vertex_colors, 
     vertex.label=label,
     vertex.label.cex=0.1,
     edge.arrow.size=.5,
     vertex.size=(total_vertex_sizes)/5,
     main='Testing Pre-Historical Gephi')
dev.off() 
```


```{r}
## make network
network <- graph.data.frame(edges, directed = T, vertices = nodes)

## save
write.graph(network, file = "data/enron.graphML", format = "graphml")
save(edges, nodes, network, file = "data/enron.RData")


set.seed(13)

netze <- c("var1", "var2", "var3", "var4")
main <- c("All emails", "TO email", "CC email", "BCC email")
count <- c(1)

for (i in netze) {
  temp <- get(i)

  edge_col <- colorpanel(length(table(E(temp)$count)), low = "#2C7BB6", high = "#FFFFBF")  
  E(temp)$color <- edge_col[factor(E(temp)$count)]
  
  #pdf(file = paste("plot_",i,".pdf", sep = ""), width = 5, height = 5)
  #png(file = paste("plot_",i,".png", sep = ""), width = 480, height = 480, type = "cairo")
  jpeg(file = paste("plot_",i,".jpg", sep = ""), width = 480, height = 480, type = "cairo", quality = 95)
  par(bg = "grey60", mar = c(0,0.25,1.5,0))
  layout(matrix(c(1,2), 2, 1, byrow = T), height = c(4, 1))
  plot(temp, main = main[count], layout = layout.fruchterman.reingold(temp, params= list(niter = 1000, area = vcount(temp)^4, weights = E(temp)$temp), repulserad= vcount(temp)^3),#(temp, weights = E(temp)$temp),#, area = vcount(temp)^4),
       vertex.label = NA, vertex.size = 3+3*log10(V(temp)$degree), 
       edge.arrow.size = E(temp)$temp/150, edge.width = 1.5*log10(E(temp)$temp), edge.curved = T, edge.color = E(temp)$color       )
  
  plot.new()
  legend("bottom", legend = unique(V(network)$status), col = vertex_col, pch = 19,cex = 1, pt.cex= 1.25, ncol = 4, box.lwd = 0, box.col = "grey60")
  
  dev.off()
  
  count <- count + 1
}



```


#B2.1 – TIPOS DE RELACIONAMENTO - REFERENCIA DE ENVIO  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE ENVIO OU ENCAMINHAMENTO DE USUÁRIO DE DROGAS COM OS SERVIÇOS A SEGUIR: REFERENCIA DE ENVIO - Usuários de Drogas encaminhados a outros serviços da rede

#B2.2 – TIPOS DE RELACIONAMENTO - REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA - O SEU SERVIÇO MANTÉM ALGUM TIPO DE REFERÊNCIA DE RECEBIMENTO OU CONTRAREFERENCIA DE USUÁRIO DE DROGAS COM: REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA  - USUÁRIOS DE DROGAS RECEBOS OU CONTRAREFERENCIADOS DE OUTROS SERVIÇOS DA REDE

#B2.3 – TIPOS DE RELACIONAMENTO  - COORDENAÇÃO CONJUNTA DE CASOS  - O SEU SERVIÇO MANTÉM ALGUM TIPO DE COORDENAÇÃO CONJUNTA DE CASOS REFERENTE AO USO DE DROGAS COM: COORDENAÇÃO CONJUNTA DE CASOS - COMPARTILHAMENTO DE DADOS E CONDUTAS A RESPEITO DE UM CASO ESPECÍFICO RELACIONADO AO USO DE DROGAS, RESPONSABILADE COMPARTILHADA DE CASOS, TRATAMENTO DE USUÁRIOS DE DROGAS EM CONJUNTO COM OUTROS SERVIÇOS

#B2.4 – TIPOS DE RELACIONAMENTO - PROGRAMAS EM CONJUNTO - O SEU SERVIÇO MANTÉM ALGUM TIPO DE PROGRAMA EM CONJUNTO REFERENTE AO USO DE DROGAS COM: PROGRAMAS EM CONJUNTO  - PROGRAMAS E PROJETOS REFERENTES AO USO DE DROGAS DESENVOLVOS EM CONJUNTO COM OUTROS SERVIÇOS

#B2.5 – TIPOS DE RELACIONAMENTO  - OFERTA DE TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ TREINOU OU CAPACITOU ALGUM DOS SERVIÇOS A SEGUIR:  OFERTA DE TREINAMENTOS/CAPACITAÇÕES  - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE RELACIONADOS AO USO DE DROGAS OFERECOS PARA OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO PROFISSIONAL

#B2.6 – TIPOS DE RELACIONAMENTO  - RECEBER TREINAMENTOS/CAPACITAÇÕES - COM RELAÇÃO AO USO DE DROGAS, O SEU SERVIÇO JÁ FOI TREINADO OU CAPACITADO POR ALGUM DOS SERVIÇOS A SEGUIR: RECEBER TREINAMENTOS/CAPACITAÇÕES - CURSOS CAPACITAÇÕES TREINAMENTOS OU OUTROS EVENTOS DE EDUCAÇÃO PERMANENTE REFERENTES AO USO DE DROGAS RECEBOS DE OUTROS SERVIÇOS PARA MELHORIA DA QUALIFICAÇÃO PROFISSIONAL 

```{r}
netze <- c(
"full_no_zero",
"var0",
"var1",
"var2",
"var3",
"var4",
"var5",
"var6",
"var7",
"var8",
"var9",
"var10",
"var11",
"var12",
"var13",
"var14",
"var15",
"var16",
"var17",
"var18",
"var19",
"var20",
"var21",
"var22",
"var23",
"var24",
"atividade",
"acesso",
"confianca",
"total")

main <- c("REDE COMPLETA - Sem Zeros",
"RELACIONAMENTO FORMAL",
"REFERENCIA DE ENVIO",
"REFERENCIA DE RECEBIMENTO CONTRAREFERENCIA",
"COORDENAÇÃO CONJUNTA DE CASOS",
"PROGRAMAS EM CONJUNTO",
"OFERTA DE TREINAMENTOS/CAPACITAÇÕES",
"RECEBER TREINAMENTOS/CAPACITAÇÕES",
"ACESSO A) Este serviço mostra-se disponível para realização de ativades em conjunto.",
"ACESSO B) O horário de funcionamento deste serviço possibilita a realização de ações em conjunto.",
"ACESSO C) Este serviço disponibiliza informações sobre suas ativades para o seu serviço.",
"ACESSO D) O seu serviço consegue acessar facilmente informações deste serviço.",
"ACESSO E) Os canais de comunicação com este serviço são suficientes para realização de ações em conjunto.",
"ACESSO F) Seu serviço tem facilade de entrar em contato com este serviço para realizar ativades em conjunto.",
"ACESSO G) O acesso geográfico a este serviço impede a realização de ativades em conjunto.  ",
"ACESSO H) O custo para acessar este serviço impede a realização de ativades em conjunto.",
"ACESSO I) O tempo gasto para acessar este serviço impede a realização ativades em conjunto.",
"CONFIANÇA A) Confia  na qualificação profissional da equipe deste serviço ",
"CONFIANÇA B) Confia  na capacade técnica da equipe deste serviço.",
"CONFIANÇA C) Confia  nas ações realizadas por este serviço.",
"CONFIANÇA D) Confia  em compartilhar informações internas com este serviço. ",
"CONFIANÇA E) Confia nas informações recebas deste serviço.",
"CONFIANÇA F) Confia  em realizar ações conjuntas com este serviço.",
"CONFIANÇA G) Está satisfeito  com as ações desempenhadas por este serviço.",
"CONFIANÇA H) Espera que o relacionamento com este serviço continue nos próximos anos.",
"CONFIANÇA I) Espera que o relacionamento com este serviço se fortaleça nos próximos anos.",
"ATIVIDADE",
"ACESSO",
"CONFIANÇA",
"TOTAL")



netz <- c(full_no_zero,var0)
```


